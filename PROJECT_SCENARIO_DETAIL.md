# ูุซููุฉ ุณููุงุฑูู ูุดุฑูุน ูุธุงู ุตุงููู ุฃุณูุงุก (Asmaa Salon V1) ุงูุดุงููุฉ ุจุงูุชูุตูู ุงูููู ๐โจ

ุชูุฏู ูุฐู ุงููุซููุฉ ุดุฑุญุงู ุชูุตูููุงู ููุนููุงู ูุฌููุน ููุฒุงุช ุงููุธุงูุ ูุณููุงุฑูููุงุช ุงูุนูู ุงููุงููุฉุ ูููููุฉ ุชุฑุงุจุท ุงูููุฏููุงุช ุงููุฎุชููุฉ ูุชูููุฑ ุชุฌุฑุจุฉ ูุชูุงููุฉ ูุฅุฏุงุฑุฉ ุงูุตุงููู.

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุธุงู](#1-ูุธุฑุฉ-ุนุงูุฉ-ุนูู-ุงููุธุงู)
2. [ุงูููุฏููุงุช ุงูุฃุณุงุณูุฉ ูุณููุงุฑูููุงุช ุงูุนูู](#2-ุงูููุฏููุงุช-ุงูุฃุณุงุณูุฉ-ูุณููุงุฑูููุงุช-ุงูุนูู)
3. [ูุธุงู ุงูุญุฌูุฒุงุช (Bookings)](#21-ูุธุงู-ุงูุญุฌูุฒุงุช-bookings)
4. [ููุทุฉ ุงูุจูุน (POS)](#22-ููุทุฉ-ุงูุจูุน-pos)
5. [ูุงุฆูุฉ ุงูุงูุชุธุงุฑ (Queue)](#23-ูุงุฆูุฉ-ุงูุงูุชุธุงุฑ-queue)
6. [ูุธุงู ุงูููุงุก ููุญูุธุฉ ุขุจู (Loyalty & Apple Wallet)](#24-ูุธุงู-ุงูููุงุก-ููุญูุธุฉ-ุขุจู-loyalty--apple-wallet)
7. [ูุธุงู ุงูุนุถููุงุช (Memberships)](#25-ูุธุงู-ุงูุนุถููุงุช-memberships)
8. [ูุธุงู ุงูุนูููุงุช (Commissions)](#26-ูุธุงู-ุงูุนูููุงุช-commissions)
9. [ุฅุฏุงุฑุฉ ุงููุฎุฒูู (Inventory)](#27-ุฅุฏุงุฑุฉ-ุงููุฎุฒูู-inventory)
10. [ูุธุงู ุงูุฅุดุนุงุฑุงุช (Notifications)](#28-ูุธุงู-ุงูุฅุดุนุงุฑุงุช-notifications)
11. [ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช (Reports)](#29-ุงูุชูุงุฑูุฑ-ูุงูุฅุญุตุงุฆูุงุช-reports)
12. [ุงูุชูุงููุงุช ุงูุชูููุฉ](#3-ุงูุชูุงููุงุช-ุงูุชูููุฉ)
13. [ุณููุงุฑูู ุงูุฑุญูุฉ ุงููุงููุฉ ููุนูููุฉ](#4-ุณููุงุฑูู-ุงูุฑุญูุฉ-ุงููุงููุฉ-ููุนูููุฉ)

---

## 1. ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุธุงู ๐๏ธ

ูุธุงู **Asmaa Salon** ูู ุญู ุจุฑูุฌูู ูุชูุงูู ูุจูู ูุฅุถุงูุฉ ูู WordPressุ ูุณุชููุฏ ูู ูุฏุฑุงุช WooCommerce ููุฏูุฌูุง ูุน ููุฒุงุช ูุชูุฏูุฉ ูุฎุตุตุฉ ููุทุงุน ุงูุตุงูููุงุช ูุงูุชุฌููู.

### 1.1 ุงูููููุงุช ุงูุฃุณุงุณูุฉ

- **Backend:** PHP 8.0+ ูุน WordPress REST API
- **Frontend:** Vue.js 3 + CoreUI + Pinia
- **Database:** MySQL/MariaDB ูุน 29 ุฌุฏูู ูุชุฎุตุต
- **Integration:** WooCommerce ูุงูู ุงูุชูุงูู
- **Security:** ูุธุงู RBAC ูุชูุฏู ูุน 7 ุฃุฏูุงุฑ ู 90+ ุตูุงุญูุฉ

### 1.2 ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

1. โ ุฅุฏุงุฑุฉ ุงูุนููุงุก ูุงูุฎุฏูุงุช ูุงูููุธููู
2. โ ูุธุงู ุงูุญุฌูุฒุงุช ุงููุชูุฏู ูุน ุชูููู
3. โ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุฐููุฉ (Queue Management)
4. โ ููุทุฉ ุงูุจูุน ุงููุชูุงููุฉ (POS System)
5. โ ูุธุงู ุงูุทูุจุงุช ูุงูููุงุชูุฑ ูุงููุฏููุนุงุช
6. โ ูุธุงู ุงูููุงุก ุงูุฑููู ูุน Apple Wallet
7. โ ูุธุงู ุงูุนุถููุงุช ูุงูุงุดุชุฑุงูุงุช
8. โ ูุธุงู ุงูุนูููุงุช ุงููุนูุฏ ููููุธููู
9. โ ุฅุฏุงุฑุฉ ุงููุฎุฒูู ูุงูููุชุฌุงุช
10. โ ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช ุงููุชูุฏูุฉ
11. โ ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงููุชุนุฏุฏ ุงููููุงุช
12. โ ูุธุงู ุงูุชููููุงุช ููููุธููู

---

## 2. ุงูููุฏููุงุช ุงูุฃุณุงุณูุฉ ูุณููุงุฑูููุงุช ุงูุนูู ๐๏ธ

---

## 2.1 ูุธุงู ุงูุญุฌูุฒุงุช (Bookings) ๐๐ถโโ๏ธ

### 2.1.1 ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูุญุฌูุฒุงุช ูู "ูุญุฑู" ุงูุตุงููู ุงูุฐู ููุธู ุฏุฎูู ุงูุนูููุงุช ููุฏูุฑ ุงูููุงุนูุฏ ุจุดูู ุฐูู.

### 2.1.2 ุงูููููุงุช ุงูุฃุณุงุณูุฉ

#### ุฃ. ุฌุฏูู ุงูุญุฌูุฒุงุช (asmaa_bookings)
```sql
- id: ูุนุฑู ูุฑูุฏ
- customer_id: ูุนุฑู ุงูุนูููุฉ
- staff_id: ูุนุฑู ุงูููุธูุฉ
- service_id: ูุนุฑู ุงูุฎุฏูุฉ
- booking_date: ุชุงุฑูุฎ ุงูุญุฌุฒ
- booking_time: ููุช ุงูุญุฌุฒ
- end_time: ููุช ุงูุงูุชูุงุก ุงููุชููุน
- status: ุงูุญุงูุฉ (pending/confirmed/completed/cancelled)
- price: ุงูุณุนุฑ ุงูุฃุณุงุณู
- discount: ุงูุฎุตู
- final_price: ุงูุณุนุฑ ุงูููุงุฆู
- queue_ticket_id: ูุนุฑู ุชุฐูุฑุฉ ุงูุงูุชุธุงุฑ (ุฅุฐุง ูุงูุช ูุฑุชุจุทุฉ)
```

#### ุจ. ุญุงูุงุช ุงูุญุฌุฒ (Status Flow)
```
pending โ confirmed โ completed
   โ
cancelled
```

### 2.1.3 ุณููุงุฑูู ุงูุญุฌุฒ ุงููุงูู (ุฎุทูุฉ ุจุฎุทูุฉ)

#### ุงููุฑุญูุฉ 1: ุฅูุดุงุก ุงูุญุฌุฒ

**ุงูุฎุทูุฉ 1.1:** ุงูุนูููุฉ ุชุทูุจ ุงูุญุฌุฒ
- ุนุจุฑ ุงููููุน ุงูุฅููุชุฑููู
- ุนุจุฑ ุงูุงุชุตุงู ุงููุงุชูู
- ุนุจุฑ ุฒูุงุฑุฉ ุงูุตุงููู ูุจุงุดุฑุฉ

**ุงูุฎุทูุฉ 1.2:** ุงูููุธู/ุงูููุธูุฉ ูุฏุฎู ุจูุงูุงุช ุงูุญุฌุฒ
```javascript
// ูุซุงู ุนูู ุงูุจูุงูุงุช ุงููุฏุฎูุฉ
{
  customer_id: 123,
  service_id: 45,
  staff_id: 5,  // ููุธูุฉ ูุนููุฉ ุฃู null ููุงุฎุชูุงุฑ ุงูุชููุงุฆู
  booking_date: "2025-12-20",
  booking_time: "14:00",
  notes: "ุตุจุบุฉ ุดุนุฑ + ูุต"
}
```

**ุงูุฎุทูุฉ 1.3:** ุงููุธุงู ูุชุญูู ูู ุงูุชููุฑ
```php
// ุงููุธุงู ูุชุญูู ูู:
1. ูู ุงูููุธูุฉ ูุชุงุญุฉ ูู ูุฐุง ุงูููุชุ
2. ูู ููุงู ุชุนุงุฑุถ ูุน ุญุฌูุฒุงุช ุฃุฎุฑูุ
3. ูู ุงูุฎุฏูุฉ ูุชุงุญุฉุ
4. ูู ุงูุนูููุฉ ูุฏููุง ุนุถููุฉ ูุดุทุฉ (ุฅุฐุง ูุงูุช ุงูุฎุฏูุฉ ุชุชุทูุจ ุนุถููุฉ)ุ
```

**ุงูุฎุทูุฉ 1.4:** ุฅูุดุงุก ุงูุญุฌุฒ
- ูุชู ุฅูุดุงุก ุณุฌู ูู `asmaa_bookings` ุจุญุงูุฉ `pending`
- ูุชู ุญุณุงุจ `end_time` ุจูุงุกู ุนูู ูุฏุฉ ุงูุฎุฏูุฉ
- ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฃููุฏ ููุนูููุฉ

#### ุงููุฑุญูุฉ 2: ุชุฃููุฏ ุงูุญุฌุฒ

**ุงูุฎุทูุฉ 2.1:** ุชุฃููุฏ ุงูุญุฌุฒ
- ูููู ุชุฃููุฏ ุงูุญุฌุฒ ุชููุงุฆูุงู ุฃู ูุฏููุงู
- ุนูุฏ ุงูุชุฃููุฏุ ูุชุบูุฑ `status` ุฅูู `confirmed`
- ูุชู ุชุณุฌูู `confirmed_at`

**ุงูุฎุทูุฉ 2.2:** ุฅุฑุณุงู ุชุฐููุฑ
- ูุชู ุฅุฑุณุงู ุชุฐููุฑ ูุจู 24 ุณุงุนุฉ ูู ุงูููุนุฏ
- ูุชู ุชุญุฏูุซ `reminder_sent` ุฅูู `1`

#### ุงููุฑุญูุฉ 3: ูุตูู ุงูุนูููุฉ

**ุงูุฎุทูุฉ 3.1:** ุชุญููู ุงูุญุฌุฒ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
- ุนูุฏ ูุตูู ุงูุนูููุฉุ ูุชู ุฅูุดุงุก ุชุฐูุฑุฉ ูู `asmaa_queue_tickets`
- ูุชู ุฑุจุท ุงูุญุฌุฒ ุจุงูุชุฐูุฑุฉ ุนุจุฑ `queue_ticket_id`
- ุชุธูุฑ ุงูุนูููุฉ ูู ุดุงุดุฉ Queue

**ุงูุฎุทูุฉ 3.2:** ุงุณุชุฏุนุงุก ุงูุนูููุฉ
- ุงูููุธูุฉ ุชุณุชุฏุนู ุงูุนูููุฉ ูู ุดุงุดุฉ Queue
- ูุชู ุชุญุฏูุซ ุญุงูุฉ ุงูุชุฐูุฑุฉ ุฅูู `called`
- ูุชู ุชุณุฌูู `called_at`

#### ุงููุฑุญูุฉ 4: ุฅุชูุงู ุงูุฎุฏูุฉ

**ุงูุฎุทูุฉ 4.1:** ุจุฏุก ุงูุฎุฏูุฉ
- ูุชู ุชุญุฏูุซ ุญุงูุฉ ุงูุชุฐูุฑุฉ ุฅูู `in_service`
- ูุชู ุชุณุฌูู `serving_started_at`

**ุงูุฎุทูุฉ 4.2:** ุฅุชูุงู ุงูุฎุฏูุฉ
- ูุชู ุชุญุฏูุซ ุญุงูุฉ ุงูุญุฌุฒ ุฅูู `completed`
- ูุชู ุชุณุฌูู `completed_at`
- ูุชู ุฅูุดุงุก ุทูุจ (Order) ุชููุงุฆูุงู

### 2.1.4 ุฅุนุฏุงุฏุงุช ุงูุญุฌูุฒุงุช ุงููุชูุฏูุฉ

#### ุฃ. ุณุงุนุงุช ุงูุนูู (Business Hours)
```javascript
{
  monday: { open: "09:00", close: "21:00", closed: false },
  tuesday: { open: "09:00", close: "21:00", closed: false },
  // ... ุฅูุฎ
}
```

#### ุจ. ุงูุฅุฌุงุฒุงุช (Holidays)
- ูููู ุชุญุฏูุฏ ุฃูุงู ุฅุฌุงุฒุฉ ุซุงุจุชุฉ
- ูููู ุชุญุฏูุฏ ุฅุฌุงุฒุงุช ูุชูุฑุฑุฉ (ูุซู ูู ุฌูุนุฉ)

#### ุฌ. ูุฏุฉ ุงูุฎุฏูุงุช
- ูู ุฎุฏูุฉ ููุง `duration` ูุญุฏุฏ ุจุงูุฏูุงุฆู
- ุงููุธุงู ูุญุณุจ ุชููุงุฆูุงู `end_time`

#### ุฏ. ูุชุฑุงุช ุงูุฑุงุญุฉ
- ูููู ุชุญุฏูุฏ ูุชุฑุงุช ุฑุงุญุฉ ููููุธูุงุช
- ุงููุธุงู ูุชุฌูุจ ุงูุญุฌูุฒุงุช ูู ูุชุฑุงุช ุงูุฑุงุญุฉ

### 2.1.5 ุงูุชูููู (Calendar View)

#### ุงูููุฒุงุช:
- ุนุฑุถ ุฌููุน ุงูุญุฌูุฒุงุช ูู ุชูููู ุดูุฑู/ุฃุณุจูุนู/ูููู
- ุฃููุงู ูุฎุชููุฉ ุญุณุจ ุงูุญุงูุฉ
- ุฅููุงููุฉ ุงูุณุญุจ ูุงูุฅููุงุช ูุชุบููุฑ ุงูููุงุนูุฏ
- ุนุฑุถ ุชูุงุตูู ุงูุญุฌุฒ ุนูุฏ ุงูููุฑ

---

## 2.2 ููุทุฉ ุงูุจูุน (POS) ๐๐ณ

### 2.2.1 ูุธุฑุฉ ุนุงูุฉ

ููุทุฉ ุงูุจูุน ูู ูุงุฌูุฉ ุณุฑูุนุฉ ูุจุฏูููุฉ ููููุธูุงุช ูุฅุชูุงู ุงููุนุงููุงุช ุงููุงููุฉ ุจุณุฑุนุฉ ูููุงุกุฉ.

### 2.2.2 ุงูููููุงุช ุงูุฃุณุงุณูุฉ

#### ุฃ. ุฌูุณุงุช ุงููุงุดูุฑ (POS Sessions)
```sql
asmaa_pos_sessions:
- id: ูุนุฑู ุงูุฌูุณุฉ
- user_id: ูุนุฑู ุงููุณุชุฎุฏู (ุงููุงุดูุฑ)
- opening_balance: ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู
- closing_balance: ุงูุฑุตูุฏ ุงูุฎุชุงูู
- expected_cash: ุงูููุฏ ุงููุชููุน
- actual_cash: ุงูููุฏ ุงููุนูู
- difference: ุงููุฑู
- status: ุงูุญุงูุฉ (open/closed)
- opened_at: ููุช ุงููุชุญ
- closed_at: ููุช ุงูุฅุบูุงู
```

#### ุจ. Unified Order Service
ุฎุฏูุฉ ููุญุฏุฉ ููุนุงูุฌุฉ ุฌููุน ุงูุทูุจุงุช ูู ุฃู ูุตุฏุฑ (POSุ Bookingุ Queue).

### 2.2.3 ุณููุงุฑูู ุงูุจูุน ุงููุงูู (ุฎุทูุฉ ุจุฎุทูุฉ)

#### ุงููุฑุญูุฉ 1: ูุชุญ ุฌูุณุฉ ุงููุงุดูุฑ

**ุงูุฎุทูุฉ 1.1:** ุชุณุฌูู ุงูุฏุฎูู
- ุงููุงุดูุฑ ูุณุฌู ุฏุฎููู ูููุธุงู
- ุงููุธุงู ูุชุญูู ูู ูุฌูุฏ ุฌูุณุฉ ููุชูุญุฉ

**ุงูุฎุทูุฉ 1.2:** ูุชุญ ุฌูุณุฉ ุฌุฏูุฏุฉ
```javascript
// ุงูุจูุงูุงุช ุงููุทููุจุฉ
{
  opening_balance: 500.000,  // ุฑุตูุฏ ุงูุชุชุงุญู
  notes: "ุจุฏุงูุฉ ููู ุงูุนูู"
}
```

**ุงูุฎุทูุฉ 1.3:** ุชุฃููุฏ ุงูุฌูุณุฉ
- ูุชู ุฅูุดุงุก ุณุฌู ูู `asmaa_pos_sessions`
- ุงูุญุงูุฉ: `open`
- ูุชู ุชุณุฌูู `opened_at`

#### ุงููุฑุญูุฉ 2: ุงุฎุชูุงุฑ ุงูุนูููุฉ

**ุงูุฎุทูุฉ 2.1:** ุงูุจุญุซ ุนู ุงูุนูููุฉ
- ูููู ุงูุจุญุซ ุจุงูุงุณู ุฃู ุฑูู ุงููุงุชู
- ูููู ุฅูุดุงุก ุนูููุฉ ุฌุฏูุฏุฉ ุจุณุฑุนุฉ

**ุงูุฎุทูุฉ 2.2:** ุนุฑุถ ุจูุงูุงุช ุงูุนูููุฉ
```javascript
{
  customer_id: 123,
  name: "ุณุงุฑุฉ ุฃุญูุฏ",
  phone: "+96512345678",
  loyalty_points: 150,
  active_membership: "ุจุงูุฉ VIP",
  prepaid_orders: []  // ุทูุจุงุช ูุฏููุนุฉ ูุณุจูุงู
}
```

#### ุงููุฑุญูุฉ 3: ุฅุถุงูุฉ ุงูุนูุงุตุฑ ููุทูุจ

**ุงูุฎุทูุฉ 3.1:** ุฅุถุงูุฉ ุฎุฏูุฉ
```javascript
{
  item_type: "service",
  service_id: 45,
  name: "ุตุจุบุฉ ุดุนุฑ",
  quantity: 1,
  unit_price: 50.000,
  staff_id: 5  // ุงูููุธูุฉ ุงูุชู ูุฏูุช ุงูุฎุฏูุฉ
}
```

**ุงูุฎุทูุฉ 3.2:** ุฅุถุงูุฉ ููุชุฌ
```javascript
{
  item_type: "product",
  product_id: 12,
  name: "ุดุงูุจู ูุงุฎุฑ",
  quantity: 2,
  unit_price: 15.000
}
```

**ุงูุฎุทูุฉ 3.3:** ุญุณุงุจ ุงููุฌููุน
```javascript
subtotal = sum(all items * quantity)
discount = 0  // ุณูุชู ุชุทุจููู ูุงุญูุงู
total = subtotal - discount
```

#### ุงููุฑุญูุฉ 4: ุชุทุจูู ุงูุฎุตููุงุช

**ุงูุฎุทูุฉ 4.1:** ุฎุตููุงุช ุงูุนุถููุฉ
- ุฅุฐุง ูุงูุช ุงูุนูููุฉ ูุฏููุง ุนุถููุฉ ูุดุทุฉ
- ูุชู ุชุทุจูู ุฎุตู ุงูุนุถููุฉ ุชููุงุฆูุงู

**ุงูุฎุทูุฉ 4.2:** ุงุณุชุจุฏุงู ููุงุท ุงูููุงุก
```javascript
// ุงูุนูููุฉ ุชุฑูุฏ ุงุณุชุจุฏุงู 50 ููุทุฉ
{
  points_to_redeem: 50,
  points_per_kwd: 10,  // ูู ุงูุฅุนุฏุงุฏุงุช
  discount_amount: 5.000  // 50 / 10 = 5 ุฏ.ู
}
```

**ุงูุฎุทูุฉ 4.3:** ุฎุตููุงุช ูุฏููุฉ
- ูููู ููููุธู ุฅุถุงูุฉ ุฎุตู ูุฏูู
- ูุชุทูุจ ุตูุงุญูุฉ ุฎุงุตุฉ

#### ุงููุฑุญูุฉ 5: ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฏูุน

**ุงูุฎุทูุฉ 5.1:** ุทุฑู ุงูุฏูุน ุงููุชุงุญุฉ
```javascript
payment_methods: [
  "cash",           // ููุฏู
  "card",           // ุจุทุงูุฉ
  "bank_transfer",  // ุชุญููู ุจููู
  "online",         // ุฃูููุงูู
  "mixed"           // ูุฎุชูุท (ููุฏู + ุจุทุงูุฉ)
]
```

**ุงูุฎุทูุฉ 5.2:** ุงูุฏูุน ุงููุฎุชูุท
```javascript
{
  payment_method: "mixed",
  cash_amount: 30.000,
  card_amount: 20.000,
  total: 50.000
}
```

#### ุงููุฑุญูุฉ 6: ูุนุงูุฌุฉ ุงูุทูุจ

**ุงูุฎุทูุฉ 6.1:** ุงุณุชุฏุนุงุก Unified Order Service
```php
Unified_Order_Service::process_order([
  'customer_id' => 123,
  'items' => [...],
  'payment_method' => 'cash',
  'discount' => 5.000,
  'source' => 'pos'
]);
```

**ุงูุฎุทูุฉ 6.2:** ูุง ูุญุฏุซ ุชููุงุฆูุงู:
1. โ ุฅูุดุงุก WooCommerce Order
2. โ ุฅุถุงูุฉ ุงูุนูุงุตุฑ ููุทูุจ
3. โ ุฎุตู ุงููุฎุฒูู (ููููุชุฌุงุช)
4. โ ุฅูุดุงุก Invoice
5. โ ุชุณุฌูู Payment
6. โ ุงุญุชุณุงุจ ููุงุท ุงูููุงุก
7. โ ุงุญุชุณุงุจ ุนูููุงุช ุงูููุธูุงุช
8. โ ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงูุนูููุฉ
9. โ ุชุญุฏูุซ Apple Wallet (ุฅุฐุง ูุงู ููุฌูุฏุงู)

**ุงูุฎุทูุฉ 6.3:** ุชุญุฏูุซ ุฌูุณุฉ ุงููุงุดูุฑ
```php
// ูุชู ุชุญุฏูุซ ุงูุฌูุณุฉ
expected_cash += cash_amount
// ุณูุชู ููุงุฑูุชูุง ุนูุฏ ุฅุบูุงู ุงูุฌูุณุฉ
```

#### ุงููุฑุญูุฉ 7: ุฅุตุฏุงุฑ ุงููุงุชูุฑุฉ

**ุงูุฎุทูุฉ 7.1:** ุฅูุดุงุก ุงููุงุชูุฑุฉ
- ูุชู ุฅูุดุงุก ูุงุชูุฑุฉ ุฑุณููุฉ ูุน QR Code
- ูุชูุงููุฉ ูุน ูุชุทูุจุงุช ุงูุถุฑุงุฆุจ ุงููููุชูุฉ

**ุงูุฎุทูุฉ 7.2:** ุทุจุงุนุฉ ุงููุงุชูุฑุฉ
- ูููู ุทุจุงุนุฉ ุงููุงุชูุฑุฉ ูุจุงุดุฑุฉ
- ุฃู ุฅุฑุณุงููุง ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู

### 2.2.4 ุงููุฏููุนุงุช ุงููุณุจูุฉ (Prepaid Orders)

#### ุงูุณููุงุฑูู:
1. ุงูุนูููุฉ ุชุฏูุน ูุจูุบ ูุณุจูุงู
2. ูุชู ุฅูุดุงุก ุทูุจ ุจุญุงูุฉ `processing` ุฃู `on-hold`
3. ุนูุฏ ุงูุดุฑุงุก ุงูุชุงููุ ูุชู ุฎุตู ุงููุจูุบ ุงููุณุจู ุชููุงุฆูุงู

```php
// ุงููุธุงู ูุชุญูู ูู ุงููุฏููุนุงุช ุงููุณุจูุฉ
$prepaid_orders = wc_get_orders([
  'customer_id' => $customer_id,
  'status' => ['processing', 'on-hold']
]);

// ูุชู ุฎุตููุง ูู ุงููุฌููุน
$total = $subtotal - $discount - $prepaid_amount;
```

### 2.2.5 ุฅุบูุงู ุฌูุณุฉ ุงููุงุดูุฑ

**ุงูุฎุทูุฉ 1:** ุญุณุงุจ ุงูุฑุตูุฏ ุงููุชููุน
```javascript
expected_cash = opening_balance + sum(all_cash_payments)
```

**ุงูุฎุทูุฉ 2:** ุฅุฏุฎุงู ุงูุฑุตูุฏ ุงููุนูู
```javascript
{
  actual_cash: 1500.000,
  notes: "ุฌููุน ุงููุฏููุนุงุช ุชูุช"
}
```

**ุงูุฎุทูุฉ 3:** ุญุณุงุจ ุงููุฑู
```javascript
difference = actual_cash - expected_cash
// ุฅุฐุง ูุงู ููุฌุจ = ูุงุฆุถ
// ุฅุฐุง ูุงู ุณุงูุจ = ููุต
```

**ุงูุฎุทูุฉ 4:** ุฅุบูุงู ุงูุฌูุณุฉ
- ูุชู ุชุญุฏูุซ `status` ุฅูู `closed`
- ูุชู ุชุณุฌูู `closed_at`
- ูุชู ุญูุธ `closing_balance` ู `difference`

---

## 2.3 ูุงุฆูุฉ ุงูุงูุชุธุงุฑ (Queue) ๐ถโโ๏ธ๐

### 2.3.1 ูุธุฑุฉ ุนุงูุฉ

ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูู ูุธุงู ุฐูู ูุฅุฏุงุฑุฉ ุงูุนูููุงุช ุงููุงุชู ููุชุธุฑู ุงูุฎุฏูุฉุ ุณูุงุก ูุงู ูุฏููู ุญุฌุฒ ูุณุจู ุฃู ูุตูู ูุจุงุดุฑุฉ.

### 2.3.2 ุงูููููุงุช ุงูุฃุณุงุณูุฉ

#### ุฃ. ุชุฐุงูุฑ ุงูุงูุชุธุงุฑ (Queue Tickets)
```sql
asmaa_queue_tickets:
- id: ูุนุฑู ุงูุชุฐูุฑุฉ
- ticket_number: ุฑูู ุงูุชุฐูุฑุฉ (ูุซู Q-001)
- wc_customer_id: ูุนุฑู ุงูุนูููุฉ
- booking_id: ูุนุฑู ุงูุญุฌุฒ (ุฅุฐุง ูุงู ูุฑุชุจุทุงู)
- service_id: ูุนุฑู ุงูุฎุฏูุฉ
- status: ุงูุญุงูุฉ (waiting/called/in_service/completed/cancelled)
- check_in_at: ููุช ุงููุตูู
- called_at: ููุช ุงูุงุณุชุฏุนุงุก
- serving_started_at: ููุช ุจุฏุก ุงูุฎุฏูุฉ
- completed_at: ููุช ุงูุฅุชูุงู
```

#### ุจ. ุงุณุชุฏุนุงุกุงุช ุงูููุธูุงุช (Worker Calls)
```sql
asmaa_worker_calls:
- id: ูุนุฑู ุงูุงุณุชุฏุนุงุก
- wp_user_id: ูุนุฑู ุงูููุธูุฉ
- ticket_id: ูุนุฑู ุงูุชุฐูุฑุฉ
- customer_name: ุงุณู ุงูุนูููุฉ
- status: ุงูุญุงูุฉ (pending/accepted/completed/postponed)
- called_at: ููุช ุงูุงุณุชุฏุนุงุก
- accepted_at: ููุช ุงููุจูู
- completed_at: ููุช ุงูุฅุชูุงู
```

### 2.3.3 ุณููุงุฑูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงููุงูู

#### ุงููุฑุญูุฉ 1: ุฅูุดุงุก ุชุฐูุฑุฉ ุงูุงูุชุธุงุฑ

**ุงูุณููุงุฑูู ุฃ: ุนูููุฉ ูุฏููุง ุญุฌุฒ ูุณุจู**

**ุงูุฎุทูุฉ 1.1:** ูุตูู ุงูุนูููุฉ
- ุงูุนูููุฉ ุชุตู ููุตุงููู
- ุงูููุธู ูุจุญุซ ุนู ุญุฌุฒูุง

**ุงูุฎุทูุฉ 1.2:** ุชุญููู ุงูุญุฌุฒ ุฅูู Queue
```php
// ูุชู ุฅูุดุงุก ุชุฐูุฑุฉ ูุฑุชุจุทุฉ ุจุงูุญุฌุฒ
{
  booking_id: 456,
  customer_id: 123,
  service_id: 45,
  status: "waiting",
  check_in_at: "2025-12-20 14:05:00"
}
```

**ุงูุณููุงุฑูู ุจ: ุนูููุฉ ุจุฏูู ุญุฌุฒ (Walk-in)**

**ุงูุฎุทูุฉ 1.1:** ุฅูุดุงุก ุชุฐูุฑุฉ ุฌุฏูุฏุฉ
```php
{
  customer_id: 123,
  service_id: 45,
  staff_id: null,  // ุณูุชู ุชุนููููุง ูุงุญูุงู
  status: "waiting",
  check_in_at: "2025-12-20 14:05:00"
}
```

**ุงูุฎุทูุฉ 1.2:** ุชูููุฏ ุฑูู ุงูุชุฐูุฑุฉ
```php
// ุงููุธุงู ูููุฏ ุฑูู ุชููุงุฆูุงู
ticket_number = "Q-" + str_pad(next_number, 3, "0", STR_PAD_LEFT)
// ูุซุงู: Q-001, Q-002, ...
```

#### ุงููุฑุญูุฉ 2: ุนุฑุถ ุงูุชุฐุงูุฑ

**ุงูุฎุทูุฉ 2.1:** ุดุงุดุฉ Queue ููููุธูุงุช
- ุชุนุฑุถ ุฌููุน ุงูุชุฐุงูุฑ ุจุญุงูุฉ `waiting`
- ูุฑุชุจุฉ ุญุณุจ ููุช ุงููุตูู (FIFO)
- ุชุนุฑุถ ุงุณู ุงูุนูููุฉ ูุงูุฎุฏูุฉ ุงููุทููุจุฉ

**ุงูุฎุทูุฉ 2.2:** ุดุงุดุฉ ุงูุนุฑุถ ุงูุนุงูุฉ (Display Screen)
- ุดุงุดุฉ ูุจูุฑุฉ ูู ุงูุตุงููู
- ุชุนุฑุถ ุงูุชุฐุงูุฑ ุงููุณุชุฏุนุงุฉ
- ุชุญุฏูุซ ุชููุงุฆู ูู 5 ุซูุงู

#### ุงููุฑุญูุฉ 3: ุงุณุชุฏุนุงุก ุงูุนูููุฉ

**ุงูุฎุทูุฉ 3.1:** ุงูููุธูุฉ ุชุณุชุฏุนู ุนูููุฉ
```php
// ุงูููุธูุฉ ุชุถุบุท ุนูู ุฒุฑ "ุงุณุชุฏุนุงุก"
{
  ticket_id: 789,
  staff_id: 5
}
```

**ุงูุฎุทูุฉ 3.2:** ุชุญุฏูุซ ุญุงูุฉ ุงูุชุฐูุฑุฉ
```php
// ูุชู ุชุญุฏูุซ:
status = "called"
called_at = current_time()
```

**ุงูุฎุทูุฉ 3.3:** ุฅูุดุงุก Worker Call
```php
// ูุชู ุฅูุดุงุก ุณุฌู ูู asmaa_worker_calls
{
  wp_user_id: 5,
  ticket_id: 789,
  customer_name: "ุณุงุฑุฉ ุฃุญูุฏ",
  status: "pending"
}
```

**ุงูุฎุทูุฉ 3.4:** ุงูุฅุดุนุงุฑุงุช
- ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ููุนูููุฉ (SMS ุฃู Push)
- ูุชู ุนุฑุถ ุฑูู ุงูุชุฐูุฑุฉ ุนูู ุดุงุดุฉ ุงูุนุฑุถ
- ูุชู ุชุดุบูู ุตูุช ุชูุจูู (ุงุฎุชูุงุฑู)

#### ุงููุฑุญูุฉ 4: ูุจูู ุงูุงุณุชุฏุนุงุก

**ุงูุฎุทูุฉ 4.1:** ุงูุนูููุฉ ุชุตู ููููุธูุฉ
- ุงูููุธูุฉ ุชูุจู ุงูุงุณุชุฏุนุงุก
- ูุชู ุชุญุฏูุซ `accepted_at`

**ุงูุฎุทูุฉ 4.2:** ุจุฏุก ุงูุฎุฏูุฉ
```php
// ูุชู ุชุญุฏูุซ:
status = "in_service"
serving_started_at = current_time()
```

#### ุงููุฑุญูุฉ 5: ุฅุชูุงู ุงูุฎุฏูุฉ

**ุงูุฎุทูุฉ 5.1:** ุฅุชูุงู ุงูุฎุฏูุฉ
```php
// ูุชู ุชุญุฏูุซ:
status = "completed"
completed_at = current_time()
```

**ุงูุฎุทูุฉ 5.2:** ุฅูุดุงุก ุงูุทูุจ ุชููุงุฆูุงู
- ูุชู ุฅูุดุงุก Order ูู ุงูุชุฐูุฑุฉ
- ูุชู ุฑุจุท ุงูุชุฐูุฑุฉ ุจุงูุทูุจ
- ูุชู ุชุญููู ุงูุนูููุฉ ุฅูู POS ููุฏูุน

### 2.3.4 ุงูููุฒุงุช ุงููุชูุฏูุฉ

#### ุฃ. Auto-refresh
- ุดุงุดุฉ Queue ุชุชุญุฏุซ ุชููุงุฆูุงู ูู 5 ุซูุงู
- ูุง ุญุงุฌุฉ ูุชุญุฏูุซ ุงูุตูุญุฉ ูุฏููุงู

#### ุจ. Filtering
- ูููู ุชุตููุฉ ุงูุชุฐุงูุฑ ุญุณุจ:
  - ุงูุญุงูุฉ
  - ุงูููุธูุฉ
  - ุงูุฎุฏูุฉ
  - ุงูููุช

#### ุฌ. Statistics
- ุนุฏุฏ ุงูุชุฐุงูุฑ ูู ุงูุงูุชุธุงุฑ
- ูุชูุณุท ููุช ุงูุงูุชุธุงุฑ
- ุนุฏุฏ ุงูุชุฐุงูุฑ ุงูููุชููุฉ ุงูููู

---

## 2.4 ูุธุงู ุงูููุงุก ููุญูุธุฉ ุขุจู (Loyalty & Apple Wallet) โญ๐ฑ

### 2.4.1 ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูููุงุก ูู ุฃููู ููุฒุฉ ุชูุงูุณูุฉ ูููุธุงูุ ุญูุซ ูุญูู ุงูุนููู ุฅูู "ุนุถู ุฏุงุฆู" ูู ุฎูุงู ููุงุท ุงูููุงุก ุงูุฑูููุฉ ุงููุฎุฒูุฉ ูู Apple Wallet.

### 2.4.2 ุงูููููุงุช ุงูุฃุณุงุณูุฉ

#### ุฃ. ุฌุฏูู ูุนุงููุงุช ุงูููุงุก
```sql
asmaa_loyalty_transactions:
- id: ูุนุฑู ุงููุนุงููุฉ
- customer_id: ูุนุฑู ุงูุนูููุฉ
- type: ุงูููุน (earned/redeemed/adjustment)
- points: ุนุฏุฏ ุงูููุงุท (+ ูููุณุจุ - ููุงุณุชุจุฏุงู)
- balance_before: ุงูุฑุตูุฏ ูุจู ุงููุนุงููุฉ
- balance_after: ุงูุฑุตูุฏ ุจุนุฏ ุงููุนุงููุฉ
- reference_type: ููุน ุงููุฑุฌุน (order/booking/manual)
- reference_id: ูุนุฑู ุงููุฑุฌุน
- description: ูุตู ุงููุนุงููุฉ
- expires_at: ุชุงุฑูุฎ ุงูุชูุงุก ุงูุตูุงุญูุฉ (ูุณุชูุจูู)
- performed_by: ูู ูุงู ุจุงูุนูููุฉ
```

#### ุจ. ุจูุงูุงุช ุงูุนูููุฉ ุงูููุชุฏุฉ
```sql
asmaa_customer_extended_data:
- wc_customer_id: ูุนุฑู ุงูุนูููุฉ
- loyalty_points: ุฑุตูุฏ ุงูููุงุท ุงูุญุงูู
- total_visits: ุฅุฌูุงูู ุงูุฒูุงุฑุงุช
- total_spent: ุฅุฌูุงูู ุงูุฅููุงู
```

### 2.4.3 ุณููุงุฑูู ูุธุงู ุงูููุงุก ุงููุงูู

#### ุงููุฑุญูุฉ 1: ุงูุชุณุฌูู ูุงูุญุตูู ุนูู ุงูุจุทุงูุฉ

**ุงูุฎุทูุฉ 1.1:** ุชุณุฌูู ุงูุนูููุฉ
- ุนูุฏ ุงูุชุณุฌูู ุงูุฃููุ ูุชู ุฅูุดุงุก ุญุณุงุจ WooCommerce Customer
- ูุชู ุฅูุดุงุก ุณุฌู ูู `asmaa_customer_extended_data`

**ุงูุฎุทูุฉ 1.2:** ุฅูุดุงุก ุจุทุงูุฉ Apple Wallet
```php
Apple_Wallet_Service::create_loyalty_pass($customer_id);
```

**ุงูุฎุทูุฉ 1.3:** ูุง ูุชู ุฅูุดุงุคู:
1. โ Pass Data (JSON)
2. โ QR Code (ูุดูุฑ)
3. โ Signed .pkpass file
4. โ Serial Number ูุฑูุฏ
5. โ Authentication Token

**ุงูุฎุทูุฉ 1.4:** ุฅุฑุณุงู ุฑุงุจุท ุงูุชุญููู
- ูุชู ุฅุฑุณุงู ุฑุงุจุท ููุนูููุฉ ุนุจุฑ SMS ุฃู Email
- ุงูุฑุงุจุท: `/wp-json/asmaa-salon/v1/apple-wallet/pass/{serial_number}`
- ุงูุนูููุฉ ุชูุชุญ ุงูุฑุงุจุท ุนูู iPhone
- ูุชู ุชุญููู ุงูุจุทุงูุฉ ุชููุงุฆูุงู ูู Apple Wallet

**ุงูุฎุทูุฉ 1.5:** ูุญุชูู ุงูุจุทุงูุฉ
```json
{
  "headerFields": [
    { "key": "points", "value": "0", "label": "ุงูููุงุท" }
  ],
  "primaryFields": [
    { "key": "customer_name", "value": "ุณุงุฑุฉ ุฃุญูุฏ", "label": "ุงูุงุณู" }
  ],
  "secondaryFields": [
    { "key": "membership", "value": "ูุง ููุฌุฏ", "label": "ุงูุนุถููุฉ" }
  ],
  "barcode": {
    "message": "{\"customer_id\":123,\"timestamp\":...}",
    "format": "PKBarcodeFormatQR"
  }
}
```

#### ุงููุฑุญูุฉ 2: ูุณุจ ุงูููุงุท

**ุงูุณููุงุฑูู ุฃ: ูุณุจ ุงูููุงุท ูู ุงูุทูุจ**

**ุงูุฎุทูุฉ 2.1:** ุฅุชูุงู ุงูุทูุจ
- ุงูุนูููุฉ ุชุฏูุน ููุงุจู ุฎุฏูุฉ ุฃู ููุชุฌ
- ูุชู ุงุณุชุฏุนุงุก `Loyalty_Service::process_order_points()`

**ุงูุฎุทูุฉ 2.2:** ุญุณุงุจ ุงูููุงุท
```php
// ูู ุงูุฅุนุฏุงุฏุงุช
$points_per_item = 1;  // ููุทุฉ ูุงุญุฏุฉ ููู ุฎุฏูุฉ

// ููู ุนูุตุฑ ูู ุงูุทูุจ
foreach ($order_items as $item) {
  $points = $points_per_item * $quantity;
  // ูุชู ุฅุถุงูุฉ ุงูููุงุท
}
```

**ุงูุฎุทูุฉ 2.3:** ุชุณุฌูู ุงููุนุงููุฉ
```php
// ูุชู ุฅูุดุงุก ุณุฌู ูู asmaa_loyalty_transactions
{
  type: "earned",
  points: 5,
  balance_before: 0,
  balance_after: 5,
  reference_type: "order",
  reference_id: 789,
  description: "Order #789: ุตุจุบุฉ ุดุนุฑ x1"
}
```

**ุงูุฎุทูุฉ 2.4:** ุชุญุฏูุซ ุงูุฑุตูุฏ
```php
// ูุชู ุชุญุฏูุซ asmaa_customer_extended_data
loyalty_points = 5
```

**ุงูุฎุทูุฉ 2.5:** ุชุญุฏูุซ Apple Wallet
```php
// ูุชู ุชุญุฏูุซ ุงูุจุทุงูุฉ ุชููุงุฆูุงู
Apple_Wallet_Service::update_loyalty_pass($customer_id);

// ูุง ูุญุฏุซ:
1. ูุชู ุชุญุฏูุซ pass_data
2. ูุชู ุฅุนุงุฏุฉ ุชูููุน .pkpass file
3. ูุชู ุฅุฑุณุงู Push Notification ููุงุชู ุงูุนูููุฉ
4. ุงูุจุทุงูุฉ ุชุชุญุฏุซ ุชููุงุฆูุงู ูู Apple Wallet
```

**ุงูุณููุงุฑูู ุจ: ูุณุจ ุงูููุงุท ูุฏููุงู**

**ุงูุฎุทูุฉ 2.1:** ุฅุถุงูุฉ ููุงุท ูุฏููุงู
```php
// ูู ูุงุฌูุฉ ุงูุฅุฏุงุฑุฉ
POST /wp-json/asmaa-salon/v1/loyalty/earn
{
  customer_id: 123,
  points: 10,
  description: "ููุงูุฃุฉ ุฎุงุตุฉ"
}
```

#### ุงููุฑุญูุฉ 3: ุงุณุชุจุฏุงู ุงูููุงุท

**ุงูุฎุทูุฉ 3.1:** ุงูุนูููุฉ ุชุฑูุฏ ุงุณุชุฎุฏุงู ุงูููุงุท
- ูู ููุทุฉ ุงูุจูุนุ ุงูููุธู ููุณุญ QR Code ูู ุจุทุงูุฉ Apple Wallet
- ุฃู ูุฏุฎู ุฑูู ุงูุนูููุฉ ูุฏููุงู

**ุงูุฎุทูุฉ 3.2:** ุนุฑุถ ุงูุฑุตูุฏ
```php
// ุงููุธุงู ูุนุฑุถ:
{
  customer_id: 123,
  name: "ุณุงุฑุฉ ุฃุญูุฏ",
  loyalty_points: 150,
  points_per_kwd: 10,  // ูู ุงูุฅุนุฏุงุฏุงุช
  max_discount: 15.000  // 150 / 10 = 15 ุฏ.ู
}
```

**ุงูุฎุทูุฉ 3.3:** ุงุฎุชูุงุฑ ุนุฏุฏ ุงูููุงุท
```php
// ุงูุนูููุฉ ุชุฑูุฏ ุงุณุชุจุฏุงู 50 ููุทุฉ
{
  points_to_redeem: 50
}
```

**ุงูุฎุทูุฉ 3.4:** ุญุณุงุจ ุงูุฎุตู
```php
$points_per_kwd = 10;  // ูู ุงูุฅุนุฏุงุฏุงุช
$discount_amount = $points / $points_per_kwd;
// 50 / 10 = 5.000 ุฏ.ู
```

**ุงูุฎุทูุฉ 3.5:** ุงูุชุญูู ูู ุงูุฑุตูุฏ
```php
if ($balance_before < $points_to_redeem) {
  throw new Exception("ุฑุตูุฏ ุงูููุงุท ุบูุฑ ูุงูู");
}
```

**ุงูุฎุทูุฉ 3.6:** ุชุณุฌูู ุงูุงุณุชุจุฏุงู
```php
// ูุชู ุฅูุดุงุก ูุนุงููุฉ
{
  type: "redeemed",
  points: -50,  // ุณุงูุจ ููุงุณุชุจุฏุงู
  balance_before: 150,
  balance_after: 100,
  reference_type: "order",
  reference_id: 790,
  description: "Redeemed 50 points for 5.000 KWD discount"
}
```

**ุงูุฎุทูุฉ 3.7:** ุชุทุจูู ุงูุฎุตู
- ูุชู ุชุทุจูู ุงูุฎุตู ุนูู ุงูุทูุจ
- ูุชู ุชุญุฏูุซ ุงูุจุทุงูุฉ ุชููุงุฆูุงู

#### ุงููุฑุญูุฉ 4: ุชุนุฏูู ุงูููุงุท ูุฏููุงู

**ุงูุณููุงุฑูู:** ุฅุถุงูุฉ ุฃู ุฎุตู ููุงุท ูุณุจุจ ุฎุงุต

**ุงูุฎุทูุฉ 4.1:** ูู ูุงุฌูุฉ ุงูุฅุฏุงุฑุฉ
```php
POST /wp-json/asmaa-salon/v1/loyalty/adjust
{
  customer_id: 123,
  points: 20,  // ููุฌุจ ููุฅุถุงูุฉุ ุณุงูุจ ููุฎุตู
  description: "ุชุตุญูุญ ุฎุทุฃ"
}
```

**ุงูุฎุทูุฉ 4.2:** ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
```php
// ูุชุทูุจ ุตูุงุญูุฉ: asmaa_loyalty_adjust
// ููุท ุงููุฏูุฑ ููููู ุงูุชุนุฏูู ุงููุฏูู
```

### 2.4.4 Apple Wallet Integration ุจุงูุชูุตูู

#### ุฃ. Pass Types
ุงููุธุงู ูุฏุนู 4 ุฃููุงุน ูู ุงูุจุทุงูุงุช:

1. **Loyalty Pass** - ุจุทุงูุฉ ุงูููุงุก ุงูุฃุณุงุณูุฉ
2. **Membership Pass** - ุจุทุงูุฉ ุงูุนุถููุฉ
3. **Programs Pass** - ุจุทุงูุฉ ุงูุจุฑุงูุฌ (ุชุฌูุน ุงูููุงุก + ุงูุนูููุงุช)
4. **Commissions Pass** - ุจุทุงูุฉ ุงูุนูููุงุช (ููููุธูุงุช)

#### ุจ. Pass Structure
```json
{
  "formatVersion": 1,
  "passTypeIdentifier": "pass.com.asmaasalon.loyalty",
  "serialNumber": "LOYALTY-123-1234567890",
  "teamIdentifier": "TEAM123",
  "organizationName": "ุตุงููู ุฃุณูุงุก",
  "description": "ุจุทุงูุฉ ุงูููุงุก",
  "logoText": "ุฃุณูุงุก",
  "foregroundColor": "rgb(255, 255, 255)",
  "backgroundColor": "rgb(187, 160, 122)",
  "labelColor": "rgb(255, 255, 255)",
  "storeCard": {
    "headerFields": [...],
    "primaryFields": [...],
    "secondaryFields": [...],
    "backFields": [...],
    "barcode": {
      "message": "...",
      "format": "PKBarcodeFormatQR"
    }
  },
  "webServiceURL": "https://.../wp-json/asmaa-salon/v1/apple-wallet/",
  "authenticationToken": "..."
}
```

#### ุฌ. Push Notifications
```php
// ุนูุฏ ุชุญุฏูุซ ุงูุจุทุงูุฉ
Apple_Push_Notification_Service::push_update($device_id, $pass_type_id, $serial_number);

// Apple ูุฑุณู ุทูุจ ุชุญุฏูุซ
GET /wp-json/asmaa-salon/v1/apple-wallet/pass/{serial_number}

// ุงููุธุงู ูุนูุฏ .pkpass file ูุญุฏุซ
```

#### ุฏ. QR Code Scanning
```php
// ุนูุฏ ูุณุญ QR Code
GET /wp-json/asmaa-salon/v1/apple-wallet/loyalty/scan/{encoded_data}

// ุงููุธุงู ููู ุงูุชุดููุฑ ููุนูุฏ:
{
  customer_id: 123,
  name: "ุณุงุฑุฉ ุฃุญูุฏ",
  loyalty_points: 150,
  total_visits: 5,
  valid: true
}
```

### 2.4.5 ุฅุนุฏุงุฏุงุช ูุธุงู ุงูููุงุก

```javascript
{
  enabled: true,
  default_service_points: 1,  // ููุงุท ููู ุฎุฏูุฉ
  points_per_kwd: 10,  // ูู 10 ููุงุท = 1 ุฏ.ู
  points_expiry_days: null  // null = ูุง ุชูุชูู
}
```

---

## 2.5 ูุธุงู ุงูุนุถููุงุช (Memberships) ๐๏ธ๐

### 2.5.1 ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูุนุถููุงุช ูุณูุญ ุจุจูุน ุจุงูุงุช ูุณุจูุฉ ุงูุฏูุน ุฃู ุงุดุชุฑุงูุงุช ุดูุฑูุฉ ููุนูููุงุชุ ูุน ุชุชุจุน ุชููุงุฆู ููุฎุฏูุงุช ุงููุณุชุฎุฏูุฉ.

### 2.5.2 ุงูููููุงุช ุงูุฃุณุงุณูุฉ

#### ุฃ. ุฎุทุท ุงูุนุถููุฉ
```sql
asmaa_membership_plans:
- id: ูุนุฑู ุงูุฎุทุฉ
- name: ุงุณู ุงูุฎุทุฉ (ุนุฑุจู)
- name_ar: ุงุณู ุงูุฎุทุฉ (ุฅูุฌููุฒู)
- description: ุงููุตู
- price: ุงูุณุนุฑ
- duration_months: ุงููุฏุฉ ุจุงูุฃุดูุฑ
- discount_percentage: ูุณุจุฉ ุงูุฎุตู
- free_services_count: ุนุฏุฏ ุงูุฎุฏูุงุช ุงููุฌุงููุฉ
- priority_booking: ุฃููููุฉ ุงูุญุฌุฒ
- points_multiplier: ูุถุงุนู ุงูููุงุท
- is_active: ูุดุท/ุบูุฑ ูุดุท
```

#### ุจ. ุนุถููุงุช ุงูุนููุงุก
```sql
asmaa_customer_memberships:
- id: ูุนุฑู ุงูุนุถููุฉ
- customer_id: ูุนุฑู ุงูุนูููุฉ
- membership_plan_id: ูุนุฑู ุงูุฎุทุฉ
- start_date: ุชุงุฑูุฎ ุงูุจุฏุก
- end_date: ุชุงุฑูุฎ ุงูุงูุชูุงุก
- status: ุงูุญุงูุฉ (active/expired/cancelled)
- auto_renew: ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู
- services_used: ุนุฏุฏ ุงูุฎุฏูุงุช ุงููุณุชุฎุฏูุฉ
```

#### ุฌ. ุงุณุชุฎุฏุงู ุฎุฏูุงุช ุงูุนุถููุฉ
```sql
asmaa_membership_service_usage:
- id: ูุนุฑู ุงูุงุณุชุฎุฏุงู
- customer_membership_id: ูุนุฑู ุงูุนุถููุฉ
- service_id: ูุนุฑู ุงูุฎุฏูุฉ
- booking_id: ูุนุฑู ุงูุญุฌุฒ
- used_at: ุชุงุฑูุฎ ุงูุงุณุชุฎุฏุงู
```

### 2.5.3 ุณููุงุฑูู ุงูุนุถููุฉ ุงููุงูู

#### ุงููุฑุญูุฉ 1: ุจูุน ุงูุนุถููุฉ

**ุงูุฎุทูุฉ 1.1:** ุงุฎุชูุงุฑ ุงูุฎุทุฉ
```javascript
// ูุซุงู: ุจุงูุฉ "ุนุฑูุณ"
{
  name_ar: "ุจุงูุฉ ุงูุนุฑูุณ",
  price: 500.000,
  duration_months: 6,
  free_services_count: 10,
  discount_percentage: 15
}
```

**ุงูุฎุทูุฉ 1.2:** ุฅูุดุงุก ุงูุนุถููุฉ
```php
// ูุชู ุฅูุดุงุก ุณุฌู ูู asmaa_customer_memberships
{
  customer_id: 123,
  membership_plan_id: 5,
  start_date: "2025-12-20",
  end_date: "2026-06-20",  // ุจุนุฏ 6 ุฃุดูุฑ
  status: "active",
  auto_renew: false,
  services_used: 0
}
```

**ุงูุฎุทูุฉ 1.3:** ุงูุฏูุน
- ูุชู ุฅูุดุงุก Order ููุนุถููุฉ
- ูุชู ุชุณุฌูู Payment
- ูุชู ุชูุนูู ุงูุนุถููุฉ ุชููุงุฆูุงู

#### ุงููุฑุญูุฉ 2: ุงุณุชุฎุฏุงู ุงูุนุถููุฉ

**ุงูุฎุทูุฉ 2.1:** ุงูุนูููุฉ ุชุทูุจ ุฎุฏูุฉ
- ุนูุฏ ุฅูุดุงุก Booking ุฃู Order
- ุงููุธุงู ูุชุญูู ูู ูุฌูุฏ ุนุถููุฉ ูุดุทุฉ

**ุงูุฎุทูุฉ 2.2:** ุชุทุจูู ุงูุฎุตู
```php
if ($customer_has_active_membership) {
  $discount = $total * ($membership->discount_percentage / 100);
  $final_price = $total - $discount;
}
```

**ุงูุฎุทูุฉ 2.3:** ุงุณุชุฎุฏุงู ุฎุฏูุฉ ูุฌุงููุฉ
```php
if ($membership->free_services_count > $membership->services_used) {
  // ุงูุฎุฏูุฉ ูุฌุงููุฉ
  $final_price = 0;
  
  // ูุชู ุชุณุฌูู ุงูุงุณุชุฎุฏุงู
  $membership->services_used++;
}
```

**ุงูุฎุทูุฉ 2.4:** ุชุณุฌูู ุงูุงุณุชุฎุฏุงู
```php
// ูุชู ุฅูุดุงุก ุณุฌู ูู asmaa_membership_service_usage
{
  customer_membership_id: 10,
  service_id: 45,
  booking_id: 456,
  used_at: "2025-12-20 14:30:00"
}
```

#### ุงููุฑุญูุฉ 3: ุงูุชูุงุก ุงูุนุถููุฉ

**ุงูุฎุทูุฉ 3.1:** ูุญุต ูููู ุชููุงุฆู
```php
// ูุชู ุชุดุบูู MembershipExpiryChecker ููููุงู
MembershipExpiryChecker::check_and_notify();
```

**ุงูุฎุทูุฉ 3.2:** ุชูุจูู ูุจู 5 ุฃูุงู
```php
// ุฅุฐุง ูุงูุช ุงูุนุถููุฉ ุณุชูุชูู ุจุนุฏ 5 ุฃูุงู
if ($days_until_expiry == 5) {
  NotificationDispatcher::membership_expiry_alert(
    $membership_id,
    $data,
    5  // ุฃูุงู ูุชุจููุฉ
  );
}
```

**ุงูุฎุทูุฉ 3.3:** ุชูุจูู ููู ุงูุงูุชูุงุก
```php
// ุฅุฐุง ุงูุชูุช ุงูุนุถููุฉ ุงูููู
if ($days_until_expiry == 0) {
  // ุฅุฑุณุงู ุฅุดุนุงุฑ
  NotificationDispatcher::membership_expiry_alert(...);
  
  // ุชุญุฏูุซ ุงูุญุงูุฉ
  $membership->status = "expired";
}
```

#### ุงููุฑุญูุฉ 4: ุชูุฏูุฏ ุงูุนุถููุฉ

**ุงูุฎุทูุฉ 4.1:** ุทูุจ ุงูุชูุฏูุฏ
```php
POST /wp-json/asmaa-salon/v1/memberships/{id}/extend
{
  months: 3,  // ุชูุฏูุฏ 3 ุฃุดูุฑ
  amount_paid: 250.000
}
```

**ุงูุฎุทูุฉ 4.2:** ุชุญุฏูุซ ุงูุชูุงุฑูุฎ
```php
$new_end_date = date('Y-m-d', strtotime($membership->end_date . " +{$months} months"));
$membership->end_date = $new_end_date;
```

**ุงูุฎุทูุฉ 4.3:** ุชุณุฌูู ุงูุชูุฏูุฏ
```php
// ูุชู ุฅูุดุงุก ุณุฌู ูู asmaa_membership_extensions
{
  customer_membership_id: 10,
  extended_by_months: 3,
  amount_paid: 250.000,
  extended_at: current_time()
}
```

### 2.5.4 ููุฒุงุช ุงูุนุถููุฉ ุงููุชูุฏูุฉ

#### ุฃ. ุฃููููุฉ ุงูุญุฌุฒ
- ุงูุนูููุงุช ุฐูุงุช ุงูุนุถููุฉ ุงููุดุทุฉ ูุญุตูู ุนูู ุฃููููุฉ ูู ุงูุญุฌุฒ
- ูููู ุญุฌุฒ ููุงุนูุฏ ูุณุจูุงู ุฃูุซุฑ ูู ุงูุนูููุงุช ุงูุนุงุฏูุงุช

#### ุจ. ูุถุงุนู ุงูููุงุท
```php
// ุฅุฐุง ูุงูุช ุงูุนุถููุฉ ููุง points_multiplier = 1.5
$points_earned = $base_points * $membership->points_multiplier;
// ูุซุงู: 10 ููุงุท ร 1.5 = 15 ููุทุฉ
```

#### ุฌ. ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู
```php
if ($membership->auto_renew && $membership->status == "expired") {
  // ูุชู ุชุฌุฏูุฏ ุงูุนุถููุฉ ุชููุงุฆูุงู
  // ูุชู ุฎุตู ุงููุจูุบ ูู ุทุฑููุฉ ุงูุฏูุน ุงููุญููุธุฉ
}
```

---

## 2.6 ูุธุงู ุงูุนูููุงุช (Commissions) ๐ฉโ๐ผ๐ฐ

### 2.6.1 ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูุนูููุงุช ูุถูู ุงูุดูุงููุฉ ูุงูุชุญููุฒ ููุฑูู ุงูุนูู ูู ุฎูุงู ุญุณุงุจ ุชููุงุฆู ููุนูููุงุช ุจูุงุกู ุนูู ุงูุฎุฏูุงุช ุงูููุฏูุฉ ูุงูุชููููุงุช.

### 2.6.2 ุงูููููุงุช ุงูุฃุณุงุณูุฉ

#### ุฃ. ุฌุฏูู ุงูุนูููุงุช
```sql
asmaa_staff_commissions:
- id: ูุนุฑู ุงูุนูููุฉ
- wp_user_id: ูุนุฑู ุงูููุธูุฉ
- order_id: ูุนุฑู ุงูุทูุจ
- order_item_id: ูุนุฑู ุนูุตุฑ ุงูุทูุจ
- booking_id: ูุนุฑู ุงูุญุฌุฒ
- base_amount: ุงููุจูุบ ุงูุฃุณุงุณู
- commission_rate: ูุณุจุฉ ุงูุนูููุฉ
- commission_amount: ูุจูุบ ุงูุนูููุฉ
- rating_bonus: ููุงูุฃุฉ ุงูุชูููู
- final_amount: ุงููุจูุบ ุงูููุงุฆู
- status: ุงูุญุงูุฉ (pending/approved/paid)
- approved_by: ูู ูุงูู
- approved_at: ููุช ุงูููุงููุฉ
- paid_at: ููุช ุงูุฏูุน
```

#### ุจ. ุฅุนุฏุงุฏุงุช ุงูุนูููุงุช
```sql
asmaa_commission_settings:
- service_commission_rate: ูุณุจุฉ ุนูููุฉ ุงูุฎุฏูุงุช (ุงูุชุฑุงุถู)
- product_commission_rate: ูุณุจุฉ ุนูููุฉ ุงูููุชุฌุงุช (ุงูุชุฑุงุถู)
- reception_share_percentage: ูุณุจุฉ ุงูุงุณุชูุจุงู
- rating_bonus_enabled: ุชูุนูู ููุงูุฃุฉ ุงูุชูููู
- rating_bonus_5_star: ููุงูุฃุฉ 5 ูุฌูู
- rating_bonus_4_star: ููุงูุฃุฉ 4 ูุฌูู
```

### 2.6.3 ุณููุงุฑูู ุงูุนูููุงุช ุงููุงูู

#### ุงููุฑุญูุฉ 1: ุงุญุชุณุงุจ ุงูุนูููุงุช ุชููุงุฆูุงู

**ุงูุฎุทูุฉ 1.1:** ุฅุชูุงู ุงูุทูุจ
- ุนูุฏ ุฅุชูุงู Orderุ ูุชู ุงุณุชุฏุนุงุก `Commission_Service::process_order_commissions()`

**ุงูุฎุทูุฉ 1.2:** ููู ุนูุตุฑ ูู ุงูุทูุจ
```php
foreach ($order_items as $item) {
  $staff_id = $item['staff_id'];
  $item_type = $item['item_type'];  // service ุฃู product
  $base_amount = $item['total'];
  
  // ุงูุญุตูู ุนูู ูุณุจุฉ ุงูุนูููุฉ
  $rate = $item_type === 'service' 
    ? $default_service_rate 
    : $default_product_rate;
  
  // ุญุณุงุจ ุงูุนูููุฉ
  $commission_amount = $base_amount * ($rate / 100);
}
```

**ุงูุฎุทูุฉ 1.3:** ุงูุชุญูู ูู Overrides
```php
// ุฅุฐุง ูุงูุช ุงูููุธูุฉ ููุง ูุณุจุฉ ุฎุงุตุฉ
if (isset($staff_overrides[$staff_id])) {
  $rate = $staff_overrides[$staff_id]['service_rate'];
}
```

**ุงูุฎุทูุฉ 1.4:** ุญุณุงุจ ููุงูุฃุฉ ุงูุชูููู
```php
if ($booking_id) {
  // ุงูุญุตูู ุนูู ุชูููู ุงูุญุฌุฒ
  $rating = get_booking_rating($booking_id);
  
  if ($rating == 5 && $bonus_5_star > 0) {
    $rating_bonus = $bonus_5_star;
  } elseif ($rating == 4 && $bonus_4_star > 0) {
    $rating_bonus = $bonus_4_star;
  }
}

$final_amount = $commission_amount + $rating_bonus;
```

**ุงูุฎุทูุฉ 1.5:** ุชุณุฌูู ุงูุนูููุฉ
```php
// ูุชู ุฅูุดุงุก ุณุฌู ูู asmaa_staff_commissions
{
  wp_user_id: 5,
  order_id: 789,
  order_item_id: 123,
  booking_id: 456,
  base_amount: 50.000,
  commission_rate: 10.00,
  commission_amount: 5.000,
  rating_bonus: 2.000,  // ุชูููู 5 ูุฌูู
  final_amount: 7.000,
  status: "pending"
}
```

#### ุงููุฑุญูุฉ 2: ุงูููุงููุฉ ุนูู ุงูุนูููุงุช

**ุงูุฎุทูุฉ 2.1:** ุนุฑุถ ุงูุนูููุงุช ุงููุนููุฉ
- ุงููุฏูุฑ ูุนุฑุถ ุฌููุน ุงูุนูููุงุช ุจุญุงูุฉ `pending`
- ูููู ุงูุชุตููุฉ ุญุณุจ ุงูููุธูุฉ ุฃู ุงูุชุงุฑูุฎ

**ุงูุฎุทูุฉ 2.2:** ูุฑุงุฌุนุฉ ุงูุนูููุฉ
```php
// ุงููุฏูุฑ ูุฑุงุฌุน:
{
  staff_name: "ูุงุทูุฉ ุนูู",
  service: "ุตุจุบุฉ ุดุนุฑ",
  base_amount: 50.000,
  commission_rate: 10%,
  commission_amount: 5.000,
  rating_bonus: 2.000,
  final_amount: 7.000,
  order_number: "#789",
  booking_date: "2025-12-20"
}
```

**ุงูุฎุทูุฉ 2.3:** ุงูููุงููุฉ
```php
POST /wp-json/asmaa-salon/v1/commissions/{id}/approve
{
  approved_by: current_user_id()
}

// ูุชู ุชุญุฏูุซ:
status = "approved"
approved_at = current_time()
approved_by = current_user_id()
```

**ุงูุฎุทูุฉ 2.4:** ุงูููุงููุฉ ุงูุฌูุงุนูุฉ
```php
POST /wp-json/asmaa-salon/v1/commissions/bulk-approve
{
  commission_ids: [1, 2, 3, 4, 5],
  approved_by: current_user_id()
}
```

#### ุงููุฑุญูุฉ 3: ุฏูุน ุงูุนูููุงุช

**ุงูุฎุทูุฉ 3.1:** ุชุณุฌูู ุงูุฏูุน
```php
POST /wp-json/asmaa-salon/v1/commissions/{id}/pay
{
  paid_at: "2025-12-25",
  notes: "ุชู ุงูุฏูุน ุนุจุฑ ุงูุชุญููู ุงูุจููู"
}

// ูุชู ุชุญุฏูุซ:
status = "paid"
paid_at = "2025-12-25"
```

**ุงูุฎุทูุฉ 3.2:** ุฅุดุนุงุฑ ุงูููุธูุฉ
```php
// ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ููููุธูุฉ
NotificationDispatcher::commission_summary(
  $staff_id,
  [
    'total_amount' => 7.000,
    'period' => 'December 2025',
    'commission_count' => 1
  ]
);
```

### 2.6.4 ุชูุงุฑูุฑ ุงูุนูููุงุช

#### ุฃ. ุชูุฑูุฑ ุงูููุธูุฉ
```php
GET /wp-json/asmaa-salon/v1/commissions?staff_id=5&status=approved

// ูุนูุฏ:
{
  total_amount: 150.000,
  commission_count: 20,
  pending_amount: 30.000,
  paid_amount: 120.000,
  commissions: [...]
}
```

#### ุจ. ุชูุฑูุฑ ุดุงูู
```php
GET /wp-json/asmaa-salon/v1/reports/commissions

// ูุนูุฏ ุฅุญุตุงุฆูุงุช ูุฌููุน ุงูููุธูุงุช
```

---

## 2.7 ุฅุฏุงุฑุฉ ุงููุฎุฒูู (Inventory) ๐ฆ๐

### 2.7.1 ูุธุฑุฉ ุนุงูุฉ

ุฅุฏุงุฑุฉ ุดุงููุฉ ููููุชุฌุงุช ุงููุณุชุฎุฏูุฉ ุฏุงุฎู ุงูุตุงููู ูุงููุจุงุนุฉุ ูุน ุชูุจููุงุช ุชููุงุฆูุฉ ุนูุฏ ุงูุฎูุงุถ ุงููุฎุฒูู.

### 2.7.2 ุงูููููุงุช ุงูุฃุณุงุณูุฉ

#### ุฃ. ุฌุฏูู ุงูููุชุฌุงุช
```sql
asmaa_products:
- id: ูุนุฑู ุงูููุชุฌ
- name: ุงูุงุณู
- name_ar: ุงูุงุณู ุงูุนุฑุจู
- sku: ุฑูุฒ ุงูููุชุฌ
- barcode: ุงูุจุงุฑููุฏ
- purchase_price: ุณุนุฑ ุงูุดุฑุงุก
- selling_price: ุณุนุฑ ุงูุจูุน
- stock_quantity: ุงููููุฉ ุงููุชููุฑุฉ
- min_stock_level: ุงูุญุฏ ุงูุฃุฏูู ูููุฎุฒูู
- category: ุงููุฆุฉ
- brand: ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ
- is_active: ูุดุท/ุบูุฑ ูุดุท
- wc_product_id: ูุนุฑู ุงูููุชุฌ ูู WooCommerce
```

#### ุจ. ุญุฑูุงุช ุงููุฎุฒูู
```sql
asmaa_inventory_movements:
- id: ูุนุฑู ุงูุญุฑูุฉ
- product_id: ูุนุฑู ุงูููุชุฌ
- type: ููุน ุงูุญุฑูุฉ (in/out/adjustment)
- quantity: ุงููููุฉ
- before_quantity: ุงููููุฉ ูุจู ุงูุญุฑูุฉ
- after_quantity: ุงููููุฉ ุจุนุฏ ุงูุญุฑูุฉ
- unit_cost: ุชูููุฉ ุงููุญุฏุฉ
- total_cost: ุงูุชูููุฉ ุงูุฅุฌูุงููุฉ
- reference_type: ููุน ุงููุฑุฌุน (order/return/adjustment)
- reference_id: ูุนุฑู ุงููุฑุฌุน
- performed_by: ูู ูุงู ุจุงูุนูููุฉ
- movement_date: ุชุงุฑูุฎ ุงูุญุฑูุฉ
```

### 2.7.3 ุณููุงุฑูู ุฅุฏุงุฑุฉ ุงููุฎุฒูู ุงููุงูู

#### ุงููุฑุญูุฉ 1: ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ

**ุงูุฎุทูุฉ 1.1:** ุฅุฏุฎุงู ุจูุงูุงุช ุงูููุชุฌ
```javascript
{
  name: "ุดุงูุจู ูุงุฎุฑ",
  name_ar: "ุดุงูุจู ูุงุฎุฑ",
  sku: "SH-001",
  barcode: "1234567890123",
  purchase_price: 10.000,
  selling_price: 15.000,
  stock_quantity: 100,
  min_stock_level: 20,
  category: "ููุชุฌุงุช ุงูุนูุงูุฉ",
  brand: "L'Oreal"
}
```

**ุงูุฎุทูุฉ 1.2:** ุงููุฒุงููุฉ ูุน WooCommerce
```php
// ุฅุฐุง ูุงู WooCommerce ููุนูู
// ูุชู ุฅูุดุงุก ููุชุฌ ูู WooCommerce ุชููุงุฆูุงู
$wc_product = wc_create_product([
  'name' => $product->name,
  'sku' => $product->sku,
  'price' => $product->selling_price,
  'stock_quantity' => $product->stock_quantity,
  'manage_stock' => true
]);

// ูุชู ุญูุธ wc_product_id
```

#### ุงููุฑุญูุฉ 2: ุญุฑูุงุช ุงููุฎุฒูู

**ุงูุณููุงุฑูู ุฃ: ุจูุน ููุชุฌ**

**ุงูุฎุทูุฉ 2.1:** ุนูุฏ ุฅุชูุงู Order ูุญุชูู ุนูู ููุชุฌ
```php
// ูุชู ุงุณุชุฏุนุงุก ุชููุงุฆู
if ($item_type === 'product') {
  // ุฎุตู ุงููุฎุฒูู
  $product->stock_quantity -= $quantity;
  
  // ุชุณุฌูู ุงูุญุฑูุฉ
  create_inventory_movement([
    'type' => 'out',
    'quantity' => -$quantity,
    'reference_type' => 'order',
    'reference_id' => $order_id
  ]);
}
```

**ุงูุณููุงุฑูู ุจ: ุดุฑุงุก ููุชุฌ (ุฅุถุงูุฉ ูููุฎุฒูู)**

**ุงูุฎุทูุฉ 2.1:** ุฅุฏุฎุงู ุญุฑูุฉ ุดุฑุงุก
```php
POST /wp-json/asmaa-salon/v1/inventory/movements
{
  product_id: 12,
  type: "in",
  quantity: 50,
  unit_cost: 10.000,
  reference_type: "purchase",
  notes: "ุดุฑุงุก ูู ุงูููุฑุฏ"
}
```

**ุงูุฎุทูุฉ 2.2:** ุชุญุฏูุซ ุงููุฎุฒูู
```php
$product->stock_quantity += 50;
$product->save();

// ุชุณุฌูู ุงูุญุฑูุฉ
create_inventory_movement([...]);
```

**ุงูุณููุงุฑูู ุฌ: ุชุนุฏูู ุงููุฎุฒูู**

**ุงูุฎุทูุฉ 2.1:** ุชุนุฏูู ูุฏูู
```php
POST /wp-json/asmaa-salon/v1/inventory/adjust
{
  product_id: 12,
  new_quantity: 80,
  reason: "ุฌุฑุฏ ุณููู"
}
```

#### ุงููุฑุญูุฉ 3: ุชูุจููุงุช ุงููุฎุฒูู ุงูููุฎูุถ

**ุงูุฎุทูุฉ 3.1:** ูุญุต ุชููุงุฆู
```php
// ุนูุฏ ูู ุญุฑูุฉ ูุฎุฒูู
if ($product->stock_quantity <= $product->min_stock_level) {
  // ุฅุฑุณุงู ุชูุจูู
  NotificationDispatcher::low_stock_alert(
    $product_id,
    [
      'product_name' => $product->name,
      'current_stock' => $product->stock_quantity,
      'min_stock_level' => $product->min_stock_level,
      'sku' => $product->sku
    ]
  );
}
```

**ุงูุฎุทูุฉ 3.2:** ุงูุฅุดุนุงุฑ
```javascript
{
  type: "low_stock",
  title_ar: "โ๏ธ ุชูุจูู: ูุฎุฒูู ููุฎูุถ",
  message_ar: "ุงูููุชุฌ 'ุดุงูุจู ูุงุฎุฑ' ุฃุตุจุญ ุงููุฎุฒูู ููุฎูุถ! ุงููููุฉ ุงูุญุงููุฉ: 15 (ุงูุญุฏ ุงูุฃุฏูู: 20)",
  action: {
    route: "/products",
    query: { low_stock: "1", product_id: 12 }
  }
}
```

### 2.7.4 ุงููุฒุงููุฉ ูุน WooCommerce

#### ุฃ. ูุฒุงููุฉ ุชููุงุฆูุฉ
- ุนูุฏ ุชุญุฏูุซ ุงููุฎุฒูู ูู ุงููุธุงูุ ูุชู ุชุญุฏูุซ WooCommerce ุชููุงุฆูุงู
- ุนูุฏ ุชุญุฏูุซ ุงููุฎุฒูู ูู WooCommerceุ ูุชู ุชุญุฏูุซ ุงููุธุงู ุชููุงุฆูุงู

#### ุจ. ุญู ุงูุชุนุงุฑุถุงุช
```php
// ุฅุฐุง ุญุฏุซ ุชุนุงุฑุถ
Sync_Conflict_Resolver::resolve($product_id, $local_stock, $wc_stock);
// ุงููุธุงู ูุฎุชุงุฑ ุงููููุฉ ุงูุฃุญุฏุซ ุฃู ุงูุฃูุจุฑ
```

---

## 2.8 ูุธุงู ุงูุฅุดุนุงุฑุงุช (Notifications) ๐๐ง

### 2.8.1 ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุฅุดุนุงุฑุงุช ูุชุนุฏุฏ ุงููููุงุช ูุถูู ูุตูู ุงููุนูููุงุช ุงููููุฉ ููุฌููุน ูู ุงูููุช ุงูููุงุณุจ.

### 2.8.2 ุงูููููุงุช ุงูุฃุณุงุณูุฉ

#### ุฃ. ุฌุฏูู ุงูุฅุดุนุงุฑุงุช
```sql
asmaa_notifications:
- id: ูุนุฑู ุงูุฅุดุนุงุฑ
- type: ููุน ุงูุฅุดุนุงุฑ
- notifiable_type: ููุน ุงููุณุชูู (WP_User/Customer)
- notifiable_id: ูุนุฑู ุงููุณุชูู
- data: ุจูุงูุงุช ุงูุฅุดุนุงุฑ (JSON)
- status: ุงูุญุงูุฉ (pending/sent/failed)
- channel: ุงูููุงุฉ (sms/email/dashboard/push)
- sent_at: ููุช ุงูุฅุฑุณุงู
- read_at: ููุช ุงููุฑุงุกุฉ
```

### 2.8.3 ุฃููุงุน ุงูุฅุดุนุงุฑุงุช

#### ุฃ. ุฅุดุนุงุฑุงุช ุงูุญุฌูุฒุงุช
```php
// ุชุฃููุฏ ุงูุญุฌุฒ
NotificationDispatcher::booking_confirmation($customer_id, [
  'booking_date' => '2025-12-20',
  'booking_time' => '14:00',
  'service_name' => 'ุตุจุบุฉ ุดุนุฑ'
]);

// ุชุฐููุฑ ูุจู 24 ุณุงุนุฉ
// ูุชู ุฅุฑุณุงูู ุชููุงุฆูุงู ุนุจุฑ WP-Cron
```

#### ุจ. ุฅุดุนุงุฑุงุช ุงูุนุถููุงุช
```php
// ุงูุชูุงุก ุงูุนุถููุฉ ูุจู 5 ุฃูุงู
NotificationDispatcher::membership_expiry_alert($membership_id, $data, 5);

// ุงูุชูุงุก ุงูุนุถููุฉ ุงูููู
NotificationDispatcher::membership_expiry_alert($membership_id, $data, 0);
```

#### ุฌ. ุฅุดุนุงุฑุงุช ุงููุฎุฒูู
```php
// ูุฎุฒูู ููุฎูุถ
NotificationDispatcher::low_stock_alert($product_id, [
  'product_name' => 'ุดุงูุจู ูุงุฎุฑ',
  'current_stock' => 15,
  'min_stock_level' => 20
]);
```

#### ุฏ. ุฅุดุนุงุฑุงุช ุงูุนูููุงุช
```php
// ููุฎุต ุงูุนูููุงุช
NotificationDispatcher::commission_summary($staff_id, [
  'total_amount' => 150.000,
  'period' => 'December 2025'
]);
```

#### ูู. ุฅุดุนุงุฑุงุช Dashboard
```php
// ุฅุดุนุงุฑุงุช ุฏุงุฎู ุงููุธุงู
NotificationDispatcher::dashboard_user($user_id, 'new_booking', [
  'booking_id' => 456,
  'customer_name' => 'ุณุงุฑุฉ ุฃุญูุฏ'
]);
```

### 2.8.4 ุงููููุงุช ุงููุชุงุญุฉ

#### ุฃ. SMS
- ูุชู ุฅุฑุณุงู SMS ุนุจุฑ ูุฒูุฏ ุฎุฏูุฉ SMS
- ูุชู ุชูุนููู ุนุจุฑ WordPress hooks

#### ุจ. Email
- ูุชู ุฅุฑุณุงู Email ุนุจุฑ WordPress mail functions
- ูููู ุชุฎุตูุต ุงูููุงูุจ

#### ุฌ. Dashboard
- ุฅุดุนุงุฑุงุช ุฏุงุฎู ุงููุธุงู
- ุชุธูุฑ ูู ุฌุฑุณ ุงูุฅุดุนุงุฑุงุช ูู Topbar

#### ุฏ. Push Notifications
- ูุฅุดุนุงุฑุงุช Apple Wallet
- ูุชู ุฅุฑุณุงููุง ุชููุงุฆูุงู ุนูุฏ ุชุญุฏูุซ ุงูุจุทุงูุฉ

---

## 2.9 ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช (Reports) ๐๐

### 2.9.1 ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุชูุงุฑูุฑ ุดุงูู ูููุฑ ุฑุคู ุนูููุฉ ุนู ุฃุฏุงุก ุงูุตุงููู ูู ุฌููุน ุงูุฌูุงูุจ.

### 2.9.2 ุฃููุงุน ุงูุชูุงุฑูุฑ

#### ุฃ. ุชูุฑูุฑ ุงููุจูุนุงุช (Sales Report)
```php
GET /wp-json/asmaa-salon/v1/reports/sales?start_date=2025-12-01&end_date=2025-12-31

// ูุนูุฏ:
{
  total_revenue: 50000.000,
  total_orders: 200,
  average_order_value: 250.000,
  sales_by_period: [
    { date: "2025-12-01", revenue: 1500.000, orders: 6 },
    { date: "2025-12-02", revenue: 2000.000, orders: 8 },
    // ...
  ],
  top_services: [
    { service_id: 45, name: "ุตุจุบุฉ ุดุนุฑ", revenue: 10000.000, count: 50 },
    // ...
  ],
  payment_methods: {
    cash: 30000.000,
    card: 15000.000,
    // ...
  }
}
```

#### ุจ. ุชูุฑูุฑ ุงูุญุฌูุฒุงุช (Bookings Report)
```php
GET /wp-json/asmaa-salon/v1/reports/bookings?start_date=2025-12-01&end_date=2025-12-31

// ูุนูุฏ:
{
  total_bookings: 300,
  confirmed: 250,
  completed: 200,
  cancelled: 30,
  no_show: 20,
  booking_status_distribution: {...},
  bookings_by_staff: [
    { staff_id: 5, name: "ูุงุทูุฉ", bookings: 80, revenue: 4000.000 },
    // ...
  ],
  peak_hours: [
    { hour: "14:00", bookings: 25 },
    { hour: "16:00", bookings: 30 },
    // ...
  ]
}
```

#### ุฌ. ุชูุฑูุฑ ุงูุนููุงุก (Customers Report)
```php
GET /wp-json/asmaa-salon/v1/reports/customers?start_date=2025-12-01&end_date=2025-12-31

// ูุนูุฏ:
{
  total_customers: 500,
  new_customers: 50,
  returning_customers: 450,
  average_visits_per_customer: 3.5,
  average_spending_per_customer: 100.000,
  top_customers: [
    { customer_id: 123, name: "ุณุงุฑุฉ", visits: 10, spent: 500.000 },
    // ...
  ],
  customer_retention_rate: 85.5
}
```

#### ุฏ. ุชูุฑูุฑ ุงูููุธูุงุช (Staff Report)
```php
GET /wp-json/asmaa-salon/v1/reports/staff?start_date=2025-12-01&end_date=2025-12-31

// ูุนูุฏ:
{
  total_staff: 10,
  active_staff: 8,
  staff_performance: [
    {
      staff_id: 5,
      name: "ูุงุทูุฉ",
      services_completed: 80,
      revenue_generated: 4000.000,
      average_rating: 4.8,
      total_commissions: 400.000,
      customer_satisfaction: 95
    },
    // ...
  ],
  top_performers: [...],
  staff_efficiency: [...]
}
```

#### ูู. Dashboard Statistics
```php
GET /wp-json/asmaa-salon/v1/reports/dashboard

// ูุนูุฏ ุฅุญุตุงุฆูุงุช ุงูููู:
{
  today_revenue: 2000.000,
  today_orders: 15,
  today_bookings: 20,
  today_customers: 25,
  pending_bookings: 5,
  low_stock_products: 3,
  pending_commissions: 1500.000
}
```

### 2.9.3 ุงูุฑุณูู ุงูุจูุงููุฉ

#### ุฃ. Sales Trend
- ุฑุณู ุจูุงูู ููุถุญ ุงุชุฌุงู ุงููุจูุนุงุช
- ูููู ุงูุชุฌููุน ุญุณุจ ุงูููู ุฃู ุงูุดูุฑ

#### ุจ. Booking Efficiency
- ูุณุจุฉ ุงูุญุฌูุฒุงุช ุงูููุชููุฉ ุฅูู ุงููุคูุฏุฉ
- ูุณุจุฉ No-show

#### ุฌ. Staff Performance
- ููุงุฑูุฉ ุฃุฏุงุก ุงูููุธูุงุช
- ุฑุณูู ุจูุงููุฉ ููุชููููุงุช

---

## 3. ุงูุชูุงููุงุช ุงูุชูููุฉ โ๏ธ

### 3.1 WooCommerce Integration

#### ุฃ. ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ
- **Products:** ูุฒุงููุฉ ุชููุงุฆูุฉ ููููุชุฌุงุช
- **Orders:** ูุฒุงููุฉ ุชููุงุฆูุฉ ููุทูุจุงุช
- **Customers:** ูุฒุงููุฉ ุชููุงุฆูุฉ ููุนููุงุก
- **Payments:** ูุฒุงููุฉ ุชููุงุฆูุฉ ูููุฏููุนุงุช

#### ุจ. Sync Log
```sql
asmaa_wc_sync_log:
- entity_type: ููุน ุงูููุงู (product/order/customer)
- entity_id: ูุนุฑู ุงูููุงู
- wc_entity_id: ูุนุฑู ุงูููุงู ูู WooCommerce
- sync_direction: ุงุชุฌุงู ุงููุฒุงููุฉ (wc_to_asmaa/asmaa_to_wc)
- status: ุงูุญุงูุฉ (success/failed)
- error_message: ุฑุณุงูุฉ ุงูุฎุทุฃ
- synced_at: ููุช ุงููุฒุงููุฉ
```

### 3.2 WordPress Integration

#### ุฃ. User System
- ุงุณุชุฎุฏุงู ูุธุงู ุงููุณุชุฎุฏููู ุงููุฏูุฌ ูู WordPress
- ุฑุจุท ุงูููุธูุงุช ุจูุณุชุฎุฏููู WordPress

#### ุจ. Roles & Capabilities
- ูุธุงู ุตูุงุญูุงุช ูุชูุฏู ูุน 7 ุฃุฏูุงุฑ ู 90+ ุตูุงุญูุฉ
- ุฑุจุท ูุน WordPress capabilities

#### ุฌ. REST API
- ุงุณุชุฎุฏุงู WordPress REST API
- Namespace: `/wp-json/asmaa-salon/v1/`

### 3.3 Apple Wallet Integration

#### ุฃ. Pass Generation
- ุฅูุดุงุก .pkpass files ูููุนุฉ
- ุงุณุชุฎุฏุงู Apple certificates

#### ุจ. Push Notifications
- ุฅุฑุณุงู Push Notifications ูุชุญุฏูุซ ุงูุจุทุงูุงุช
- ุงุณุชุฎุฏุงู Apple Push Notification Service

#### ุฌ. Web Service
- ุชูููุฑ Web Service endpoints ููู Pass updates
- Device registration management

---

## 4. ุณููุงุฑูู ุงูุฑุญูุฉ ุงููุงููุฉ ููุนูููุฉ ๐

### 4.1 ุงูุณููุงุฑูู ุงููุงูู (End-to-End)

#### ุงููุฑุญูุฉ 1: ุงูุชุณุฌูู ูุงูุญุตูู ุนูู ุงูุจุทุงูุฉ

1. **ุงูุนูููุฉ ุชุณุฌู** ูู ุงููููุน ุฃู ุงูุตุงููู
2. **ุงููุธุงู ููุดุฆ** ุญุณุงุจ WooCommerce Customer
3. **ุงููุธุงู ูุฑุณู** ุฑุงุจุท ูุชุญููู ุจุทุงูุฉ Apple Wallet
4. **ุงูุนูููุฉ ุชูุชุญ** ุงูุฑุงุจุท ุนูู iPhone
5. **ุงูุจุทุงูุฉ ุชูุญููู** ุชููุงุฆูุงู ูู Apple Wallet
6. **ุงูุจุทุงูุฉ ุชุนุฑุถ:**
   - ุงูุงุณู
   - ุฑุตูุฏ ุงูููุงุท (0)
   - QR Code

#### ุงููุฑุญูุฉ 2: ุงูุญุฌุฒ

1. **ุงูุนูููุฉ ุชุญุฌุฒ** ููุนุฏ ุนุจุฑ ุงููููุน
2. **ุงููุธุงู ูุชุญูู** ูู ุงูุชููุฑ
3. **ุงููุธุงู ููุดุฆ** ุญุฌุฒ ุจุญุงูุฉ `pending`
4. **ุงููุธุงู ูุฑุณู** ุฅุดุนุงุฑ ุชุฃููุฏ
5. **ุงููุธุงู ูุคูุฏ** ุงูุญุฌุฒ ุชููุงุฆูุงู ุฃู ูุฏููุงู
6. **ุงููุธุงู ูุฑุณู** ุชุฐููุฑ ูุจู 24 ุณุงุนุฉ

#### ุงููุฑุญูุฉ 3: ุงููุตูู ูุงูุงูุชุธุงุฑ

1. **ุงูุนูููุฉ ุชุตู** ููุตุงููู
2. **ุงูููุธู ููุณุญ** QR Code ูู ุจุทุงูุฉ Apple Wallet
3. **ุงููุธุงู ููุดุฆ** ุชุฐูุฑุฉ Queue
4. **ุงูุนูููุฉ ุชุธูุฑ** ูู ุดุงุดุฉ Queue
5. **ุงูููุธูุฉ ุชุณุชุฏุนู** ุงูุนูููุฉ
6. **ุงููุธุงู ูุฑุณู** ุฅุดุนุงุฑ ููุนูููุฉ
7. **ุงูุนูููุฉ ุชุฐูุจ** ููููุธูุฉ

#### ุงููุฑุญูุฉ 4: ุงูุฎุฏูุฉ

1. **ุงูููุธูุฉ ุชุจุฏุฃ** ุงูุฎุฏูุฉ
2. **ุงููุธุงู ูุญุฏุซ** ุญุงูุฉ ุงูุชุฐูุฑุฉ ุฅูู `in_service`
3. **ุงูููุธูุฉ ุชููู** ุงูุฎุฏูุฉ
4. **ุงููุธุงู ูุญุฏุซ** ุญุงูุฉ ุงูุชุฐูุฑุฉ ุฅูู `completed`
5. **ุงููุธุงู ููุดุฆ** Order ุชููุงุฆูุงู

#### ุงููุฑุญูุฉ 5: ุงูุฏูุน

1. **ุงูุนูููุฉ ุชุฐูุจ** ูููุงุดูุฑ
2. **ุงููุงุดูุฑ ููุชุญ** POS
3. **ุงููุงุดูุฑ ูุฎุชุงุฑ** ุงูุนูููุฉ
4. **ุงููุธุงู ูุนุฑุถ** ุงูุทูุจ
5. **ุงูุนูููุฉ ุชุฑูุฏ** ุงุณุชุจุฏุงู 50 ููุทุฉ
6. **ุงููุงุดูุฑ ููุณุญ** QR Code
7. **ุงููุธุงู ูุนุฑุถ** ุฑุตูุฏ ุงูููุงุท (150 ููุทุฉ)
8. **ุงููุธุงู ูุญุณุจ** ุงูุฎุตู (5.000 ุฏ.ู)
9. **ุงููุงุดูุฑ ูุทุจู** ุงูุฎุตู
10. **ุงูุนูููุฉ ุชุฏูุน** ุงูุจุงูู ููุฏุงู
11. **ุงููุธุงู ูุนุงูุฌ** ุงูุทูุจ:
    - โ ุฅูุดุงุก WooCommerce Order
    - โ ุฅูุดุงุก Invoice
    - โ ุชุณุฌูู Payment
    - โ ุฎุตู ููุงุท ุงูููุงุก (50 ููุทุฉ)
    - โ ุฅุถุงูุฉ ููุงุท ุฌุฏูุฏุฉ (5 ููุงุท)
    - โ ุงุญุชุณุงุจ ุนูููุฉ ุงูููุธูุฉ
    - โ ุฎุตู ุงููุฎุฒูู
    - โ ุชุญุฏูุซ Apple Wallet
12. **ุงููุธุงู ูุฑุณู** Push Notification
13. **ุจุทุงูุฉ Apple Wallet** ุชุชุญุฏุซ ุชููุงุฆูุงู
14. **ุงูุนูููุฉ ุชุฑู** ุฑุตูุฏูุง ุงูุฌุฏูุฏ (105 ููุงุท)

#### ุงููุฑุญูุฉ 6: ุงูุชูููู

1. **ุงููุธุงู ูุฑุณู** ุฑุงุจุท ุงูุชูููู
2. **ุงูุนูููุฉ ุชููู** ุงูููุธูุฉ (5 ูุฌูู)
3. **ุงููุธุงู ูุญุฏุซ** ุชูููู ุงูููุธูุฉ
4. **ุงููุธุงู ูุถูู** ููุงูุฃุฉ ุงูุชูููู ููุนูููุฉ

#### ุงููุฑุญูุฉ 7: ุงูุชูุงุฑูุฑ

1. **ุงููุฏูุฑ ูุนุฑุถ** ุงูุชูุงุฑูุฑ
2. **ุงููุธุงู ูุนุฑุถ:**
   - ุฅุฌูุงูู ุงููุจูุนุงุช ุงูููู
   - ุนุฏุฏ ุงูุญุฌูุฒุงุช
   - ุฃุฏุงุก ุงูููุธูุงุช
   - ุฑุถุง ุงูุนููุงุก

---

## 5. ุงูุฎูุงุตุฉ ๐ฏ

ูุธุงู **Asmaa Salon** ูู ูุธุงู ูุชูุงูู ูุดุงูู ูููุฑ:

โ **ุฅุฏุงุฑุฉ ูุงููุฉ** ูุฌููุน ุนูููุงุช ุงูุตุงููู  
โ **ูุงุฌูุฉ ุญุฏูุซุฉ** ุจุงุณุชุฎุฏุงู Vue.js + CoreUI  
โ **ุฃูุงู ุนุงูู** ูุน ูุธุงู ุตูุงุญูุงุช ูุชูุฏู  
โ **ุฃุฏุงุก ููุชุงุฒ** ูุน ุชุญุณููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช  
โ **ุชุตููู ุฌููู** ุจููู ุฐูุจู ูุงุฎุฑ  
โ **ุชูุงูู ุณูุณ** ูุน WooCommerce ู Apple Wallet  
โ **ูุงุจููุฉ ุงูุชูุณุน** ูููุณุชูุจู  

---

**ุงูุฅุตุฏุงุฑ:** 0.2.0  
**ุขุฎุฑ ุชุญุฏูุซ:** ุฏูุณูุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงููุงูู

---

*ุชู ุฅุนุฏุงุฏ ูุฐู ุงููุซููุฉ ุจูุงุณุทุฉ ูุฑูู ุชุทููุฑ ูุธุงู ุฅุฏุงุฑุฉ ุตุงููู ุฃุณูุงุก ุงูุฌุงุฑุงููู*
