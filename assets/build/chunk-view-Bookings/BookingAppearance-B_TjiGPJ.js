import{e as V,f as U,j as B,c as b,o as y,b as e,d as x,u as c,C as L,t as d,P as F,a as w,n as C,R as u,S as h,T as v,U as P,l as T}from"../chunk-vendor-vue-VAxhpvd9.js";import{d as A}from"../chunk-vendor-pinia-CjQxP09R.js";import{a as m,p as k,u as E}from"../chunk-component-NotificationsBell-CTLJWkW4.js";import{a as M}from"../chunk-component-Sidebar-BCwzm5hp.js";import{u as j}from"../chunk-view-AppleWallet/Simulator-BwS6bEkK.js";import{B as $}from"./BookingFormPreview-NP-gasei.js";import{_ as N}from"../chunk-component-Card-DPM96EeB.js";const I=A("bookings",{state:()=>({services:{items:[],loading:!1,error:null,prefetched:!1,pagination:{current_page:1,per_page:20,total:0,total_pages:0}},staff:{items:[],loading:!1,error:null,prefetched:!1,pagination:{current_page:1,per_page:20,total:0,total_pages:0}},appointments:{items:[],loading:!1,error:null,prefetched:!1,pagination:{current_page:1,per_page:20,total:0,total_pages:0},filters:{date_from:"",date_to:"",status:""}},settings:{general:{},url:{},calendar:{},company:{},customers:{},appointments:{},payments:{},appearance:{},business_hours:[],holidays:[],loading:!1,saving:!1,error:null}}),actions:{async fetchServices(p={},a=!1){var o,l,s;if(!a&&this.services.prefetched&&this.services.items.length>0)return{items:this.services.items,total:this.services.items.length};this.services.loading=!0,this.services.error=null;try{const t=await m.get("/services",{params:{page:this.services.pagination.current_page,per_page:this.services.pagination.per_page,...p}}),g=((o=t.data)==null?void 0:o.data)??t.data??{};this.services.items=(g.items||[]).map(f=>({...f,title:f.title??f.name_ar??f.name??"",duration:Number(f.duration??0),price:Number(f.price??0)})),this.services.pagination=g.pagination||this.services.pagination}catch(t){this.services.error=((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message||"Failed to fetch services",console.error("Error fetching services:",t)}finally{this.services.loading=!1}},async prefetchServices(p={}){try{const a=await k("services",{...p,per_page:50});return a.data&&a.data.data&&a.data.data.items&&(this.services.items=(a.data.data.items||[]).map(o=>({...o,title:o.title??o.name_ar??o.name??"",duration:Number(o.duration??0),price:Number(o.price??0)})),this.services.prefetched=!0),a.data}catch(a){console.error("Error prefetching services:",a)}},async createService(p){var a,o,l;this.services.loading=!0,this.services.error=null;try{const s={...p||{}};s.title&&!s.name&&(s.name=s.title),s.title&&!s.name_ar&&(s.name_ar=s.title);const t=await m.post("/services",s);return((a=t.data)==null?void 0:a.data)??t.data}catch(s){throw this.services.error=((l=(o=s.response)==null?void 0:o.data)==null?void 0:l.message)||s.message||"Failed to create service",s}finally{this.services.loading=!1}},async updateService(p,a){var o,l,s;this.services.loading=!0,this.services.error=null;try{const t={...a||{}};t.title&&!t.name&&(t.name=t.title),t.title&&!t.name_ar&&(t.name_ar=t.title);const g=await m.put(`/services/${p}`,t);return((o=g.data)==null?void 0:o.data)??g.data}catch(t){throw this.services.error=((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message||"Failed to update service",t}finally{this.services.loading=!1}},async deleteService(p){var a,o;this.services.loading=!0,this.services.error=null;try{return await m.delete(`/services/${p}`),!0}catch(l){throw this.services.error=((o=(a=l.response)==null?void 0:a.data)==null?void 0:o.message)||l.message||"Failed to delete service",l}finally{this.services.loading=!1}},async fetchStaff(p={},a=!1){var o,l,s;if(!a&&this.staff.prefetched&&this.staff.items.length>0)return{items:this.staff.items,total:this.staff.items.length};this.staff.loading=!0,this.staff.error=null;try{const t=await m.get("/staff",{params:{page:this.staff.pagination.current_page,per_page:this.staff.pagination.per_page,...p}}),g=((o=t.data)==null?void 0:o.data)??t.data??{};this.staff.items=(g.items||[]).map(f=>({...f,full_name:f.full_name??f.name??""})),this.staff.pagination=g.pagination||this.staff.pagination}catch(t){this.staff.error=((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message||"Failed to fetch staff",console.error("Error fetching staff:",t)}finally{this.staff.loading=!1}},async prefetchStaff(p={}){try{const a=await k("staff",{...p,per_page:50});return a.data&&a.data.data&&a.data.data.items&&(this.staff.items=(a.data.data.items||[]).map(o=>({...o,full_name:o.full_name??o.name??""})),this.staff.prefetched=!0),a.data}catch(a){console.error("Error prefetching staff:",a)}},async createStaff(p){var a,o,l;this.staff.loading=!0,this.staff.error=null;try{const s={...p||{}};s.full_name&&!s.name&&(s.name=s.full_name);const t=await m.post("/staff",s);return((a=t.data)==null?void 0:a.data)??t.data}catch(s){throw this.staff.error=((l=(o=s.response)==null?void 0:o.data)==null?void 0:l.message)||s.message||"Failed to create staff",s}finally{this.staff.loading=!1}},async updateStaff(p,a){var o,l,s;this.staff.loading=!0,this.staff.error=null;try{const t={...a||{}};t.full_name&&!t.name&&(t.name=t.full_name);const g=await m.put(`/staff/${p}`,t);return((o=g.data)==null?void 0:o.data)??g.data}catch(t){throw this.staff.error=((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message||"Failed to update staff",t}finally{this.staff.loading=!1}},async deleteStaff(p){var a,o;this.staff.loading=!0,this.staff.error=null;try{return await m.delete(`/staff/${p}`),!0}catch(l){throw this.staff.error=((o=(a=l.response)==null?void 0:a.data)==null?void 0:o.message)||l.message||"Failed to delete staff",l}finally{this.staff.loading=!1}},async fetchAppointments(p={},a=!1){var o,l,s;if(!a&&this.appointments.prefetched&&this.appointments.items.length>0)return{items:this.appointments.items,total:this.appointments.items.length};this.appointments.loading=!0,this.appointments.error=null;try{const t=await m.get("/bookings",{params:{page:this.appointments.pagination.current_page,per_page:this.appointments.pagination.per_page,...this.appointments.filters,...p}}),g=((o=t.data)==null?void 0:o.data)??t.data??{};this.appointments.items=g.items||[],this.appointments.pagination=g.pagination||this.appointments.pagination}catch(t){this.appointments.error=((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message||"Failed to fetch appointments",console.error("Error fetching appointments:",t)}finally{this.appointments.loading=!1}},async prefetchAppointments(p={}){try{const a=await k("bookings",{...p,per_page:50});return a.data&&a.data.data&&a.data.data.items&&(this.appointments.items=a.data.data.items||[],this.appointments.prefetched=!0),a.data}catch(a){console.error("Error prefetching appointments:",a)}},async createAppointment(p){var a,o,l;this.appointments.loading=!0,this.appointments.error=null;try{const s=await m.post("/bookings",p);return((a=s.data)==null?void 0:a.data)??s.data}catch(s){throw this.appointments.error=((l=(o=s.response)==null?void 0:o.data)==null?void 0:l.message)||s.message||"Failed to create appointment",s}finally{this.appointments.loading=!1}},async updateAppointment(p,a){var o,l,s;this.appointments.loading=!0,this.appointments.error=null;try{const t=await m.put(`/bookings/${p}`,a);return((o=t.data)==null?void 0:o.data)??t.data}catch(t){throw this.appointments.error=((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message||"Failed to update appointment",t}finally{this.appointments.loading=!1}},async deleteAppointment(p){var a,o;this.appointments.loading=!0,this.appointments.error=null;try{return await m.delete(`/bookings/${p}`),!0}catch(l){throw this.appointments.error=((o=(a=l.response)==null?void 0:a.data)==null?void 0:o.message)||l.message||"Failed to delete appointment",l}finally{this.appointments.loading=!1}},async fetchSettings(p){var a,o,l;this.settings.loading=!0,this.settings.error=null;try{const s=await m.get(`/booking/settings/${p}`),t=p==="business-hours"?"business_hours":p,g=((a=s.data)==null?void 0:a.data)??s.data;return this.settings[t]=g,g}catch(s){throw this.settings.error=((l=(o=s.response)==null?void 0:o.data)==null?void 0:l.message)||s.message||"Failed to fetch settings",s}finally{this.settings.loading=!1}},async saveSettings(p,a){var o,l,s;this.settings.saving=!0,this.settings.error=null;try{const t=await m.post(`/booking/settings/${p}`,a),g=p==="business-hours"?"business_hours":p,f=((o=t.data)==null?void 0:o.data)??t.data;return this.settings[g]=f,f}catch(t){throw this.settings.error=((s=(l=t.response)==null?void 0:l.data)==null?void 0:s.message)||t.message||"Failed to save settings",t}finally{this.settings.saving=!1}},async fetchAllSettings(){var p,a,o;this.settings.loading=!0,this.settings.error=null;try{const l=await m.get("/booking/settings/all"),s=((p=l.data)==null?void 0:p.data)??l.data;return this.settings.general=s.general||{},this.settings.url=s.url||{},this.settings.calendar=s.calendar||{},this.settings.company=s.company||{},this.settings.customers=s.customers||{},this.settings.appointments=s.appointments||{},this.settings.payments=s.payments||{},this.settings.appearance=s.appearance||{},this.settings.business_hours=s.business_hours||[],this.settings.holidays=s.holidays||[],s}catch(l){throw this.settings.error=((o=(a=l.response)==null?void 0:a.data)==null?void 0:o.message)||l.message||"Failed to fetch settings",l}finally{this.settings.loading=!1}},async prefetch(){await Promise.all([this.prefetchServices(),this.prefetchStaff(),this.prefetchAppointments()])}}}),D={class:"booking-appearance-page"},q={class:"appearance-header"},O={class:"header-content-wrapper"},z={class:"header-text-content"},R={class:"header-subtitle"},J={class:"appearance-container"},K={class:"editor-panel"},G={class:"panel-header"},H={class:"editor-content"},Q={key:0,class:"loading-overlay"},W={class:"settings-section"},X={class:"section-title"},Y={class:"form-group"},Z={class:"color-input-group"},ee={class:"form-group"},te={class:"color-input-group"},se={class:"form-group"},oe={class:"color-input-group"},ae={class:"form-group"},re={class:"color-input-group"},ne={class:"form-group"},le={class:"color-input-group"},ie={class:"settings-section"},ce={class:"section-title"},pe={class:"form-group"},de={class:"checkbox-label"},ue={key:0,class:"form-group"},ge={value:"top"},he={value:"bottom"},fe={class:"form-group"},me={class:"checkbox-label"},_e={class:"form-group"},ve={class:"checkbox-label"},be={class:"settings-section"},ye={class:"section-title"},ke={class:"form-group"},xe={class:"checkbox-label"},we={class:"form-group"},Se={class:"checkbox-label"},Ve={class:"form-group"},Ue={class:"checkbox-label"},Be={class:"form-group"},Le={class:"checkbox-label"},Fe={class:"form-group"},Ce={class:"checkbox-label"},Pe={class:"form-group"},Te={class:"settings-section"},Ae={class:"section-title"},Ee={class:"form-group"},Me=["placeholder"],je={class:"form-group"},$e=["placeholder"],Ne={class:"form-group"},Ie=["placeholder"],De={class:"settings-section"},qe={class:"section-title"},Oe={class:"form-group"},ze=["placeholder"],Re={class:"form-group"},Je=["placeholder"],Ke={class:"form-actions"},Ge=["disabled"],He={class:"preview-panel"},Qe={class:"panel-header"},We={class:"preview-content"},Xe={__name:"BookingAppearance",setup(p){const a=T(),o=I(),l=M(),s=j(),{t}=E(),g=()=>{a.push("/bookings")},f=V(()=>n.value),n=U({primary_color:"#8E7E78",secondary_color:"var(--asmaa-primary-dark)",text_color:"#1e293b",background_color:"#ffffff",button_color:"#8E7E78",show_progress_tracker:!0,progress_tracker_position:"top",align_buttons_left:!1,invert_datepicker_colors:!1,required_employee:!1,show_service_duration:!0,show_service_price:!0,show_category_info:!0,show_service_info:!0,show_staff_info:!0,service_info_text:"",staff_info_text:"",labels:{next:"",previous:"",save:""},custom_css:"",custom_js:""});B(async()=>{n.value.labels={next:t("booking.nextButtonPlaceholder"),previous:t("booking.previousButtonPlaceholder"),save:t("booking.saveButtonPlaceholder")};try{if(await o.fetchSettings("appearance"),o.settings.appearance&&Object.keys(o.settings.appearance).length>0){const _=o.settings.appearance;n.value={...n.value,..._,labels:_.labels||n.value.labels}}}catch(_){console.error("Failed to load appearance settings:",_)}});const S=async()=>{try{await o.saveSettings("appearance",n.value);const _=l.locale==="ar"?"تم حفظ إعدادات المظهر بنجاح":"Appearance settings saved successfully";s.success(_)}catch(_){console.error("Failed to save appearance settings:",_);const r=l.locale==="ar"?"فشل حفظ الإعدادات: "+(_.message||"خطأ غير معروف"):"Failed to save settings: "+(_.message||"Unknown error");s.error(r)}};return(_,r)=>(y(),b("div",D,[e("div",q,[r[26]||(r[26]=e("div",{class:"header-logo-bg"},[e("img",{src:"https://asmaaljarallah.com/wp-content/uploads/2021/09/logo_light.png",alt:"Asmaa Logo",class:"header-logo-image"})],-1)),e("div",O,[e("button",{class:"back-button",onClick:g},[x(c(L),{icon:"cil-arrow-left"}),e("span",null,d(c(t)("common.back")||"Back"),1)]),e("div",z,[e("h1",null,[r[25]||(r[25]=e("svg",{class:"header-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})],-1)),F(" "+d(c(t)("booking.appearanceTitle")),1)]),e("p",R,d(c(t)("booking.appearanceSubtitle")),1)])])]),e("div",J,[e("div",K,[e("div",G,[e("h2",null,d(c(t)("booking.appearanceSettings")),1)]),e("div",H,[c(o).settings.loading?(y(),b("div",Q,[r[27]||(r[27]=e("div",{class:"spinner"},null,-1)),e("p",null,d(c(t)("booking.loadingSettings")),1)])):w("",!0),e("div",{class:C(["settings-sections",{loading:c(o).settings.loading}])},[e("div",W,[e("h3",X,d(c(t)("booking.colorScheme")),1),e("div",Y,[e("label",null,d(c(t)("booking.primaryColor")),1),e("div",Z,[u(e("input",{type:"color","onUpdate:modelValue":r[0]||(r[0]=i=>n.value.primary_color=i),class:"color-picker"},null,512),[[h,n.value.primary_color]]),u(e("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=i=>n.value.primary_color=i),class:"form-control color-text"},null,512),[[h,n.value.primary_color]])])]),e("div",ee,[e("label",null,d(c(t)("booking.secondaryColor")),1),e("div",te,[u(e("input",{type:"color","onUpdate:modelValue":r[2]||(r[2]=i=>n.value.secondary_color=i),class:"color-picker"},null,512),[[h,n.value.secondary_color]]),u(e("input",{type:"text","onUpdate:modelValue":r[3]||(r[3]=i=>n.value.secondary_color=i),class:"form-control color-text"},null,512),[[h,n.value.secondary_color]])])]),e("div",se,[e("label",null,d(c(t)("booking.textColor")),1),e("div",oe,[u(e("input",{type:"color","onUpdate:modelValue":r[4]||(r[4]=i=>n.value.text_color=i),class:"color-picker"},null,512),[[h,n.value.text_color]]),u(e("input",{type:"text","onUpdate:modelValue":r[5]||(r[5]=i=>n.value.text_color=i),class:"form-control color-text"},null,512),[[h,n.value.text_color]])])]),e("div",ae,[e("label",null,d(c(t)("booking.backgroundColor")),1),e("div",re,[u(e("input",{type:"color","onUpdate:modelValue":r[6]||(r[6]=i=>n.value.background_color=i),class:"color-picker"},null,512),[[h,n.value.background_color]]),u(e("input",{type:"text","onUpdate:modelValue":r[7]||(r[7]=i=>n.value.background_color=i),class:"form-control color-text"},null,512),[[h,n.value.background_color]])])]),e("div",ne,[e("label",null,d(c(t)("booking.buttonColor")),1),e("div",le,[u(e("input",{type:"color","onUpdate:modelValue":r[8]||(r[8]=i=>n.value.button_color=i),class:"color-picker"},null,512),[[h,n.value.button_color]]),u(e("input",{type:"text","onUpdate:modelValue":r[9]||(r[9]=i=>n.value.button_color=i),class:"form-control color-text"},null,512),[[h,n.value.button_color]])])])]),e("div",ie,[e("h3",ce,d(c(t)("booking.formOptions")),1),e("div",pe,[e("label",de,[u(e("input",{type:"checkbox","onUpdate:modelValue":r[10]||(r[10]=i=>n.value.show_progress_tracker=i),class:"form-checkbox"},null,512),[[v,n.value.show_progress_tracker]]),e("span",null,d(c(t)("booking.showProgressTrackerLabel")),1)])]),n.value.show_progress_tracker?(y(),b("div",ue,[e("label",null,d(c(t)("booking.progressTrackerPositionLabel")),1),u(e("select",{"onUpdate:modelValue":r[11]||(r[11]=i=>n.value.progress_tracker_position=i),class:"form-control"},[e("option",ge,d(c(t)("booking.positionTop")),1),e("option",he,d(c(t)("booking.positionBottom")),1)],512),[[P,n.value.progress_tracker_position]])])):w("",!0),e("div",fe,[e("label",me,[u(e("input",{type:"checkbox","onUpdate:modelValue":r[12]||(r[12]=i=>n.value.align_buttons_left=i),class:"form-checkbox"},null,512),[[v,n.value.align_buttons_left]]),e("span",null,d(c(t)("booking.alignButtonsLeftLabel")),1)])]),e("div",_e,[e("label",ve,[u(e("input",{type:"checkbox","onUpdate:modelValue":r[13]||(r[13]=i=>n.value.invert_datepicker_colors=i),class:"form-checkbox"},null,512),[[v,n.value.invert_datepicker_colors]]),e("span",null,d(c(t)("booking.invertDatepickerColorsLabel")),1)])])]),e("div",be,[e("h3",ye,d(c(t)("booking.serviceStepLabel")),1),e("div",ke,[e("label",xe,[u(e("input",{type:"checkbox","onUpdate:modelValue":r[14]||(r[14]=i=>n.value.show_category_info=i),class:"form-checkbox"},null,512),[[v,n.value.show_category_info]]),e("span",null,d(c(t)("booking.showCategoryInfoLabel")),1)])]),e("div",we,[e("label",Se,[u(e("input",{type:"checkbox","onUpdate:modelValue":r[15]||(r[15]=i=>n.value.show_service_info=i),class:"form-checkbox"},null,512),[[v,n.value.show_service_info]]),e("span",null,d(c(t)("booking.showServiceInfoLabel")),1)])]),e("div",Ve,[e("label",Ue,[u(e("input",{type:"checkbox","onUpdate:modelValue":r[16]||(r[16]=i=>n.value.show_service_duration=i),class:"form-checkbox"},null,512),[[v,n.value.show_service_duration]]),e("span",null,d(c(t)("booking.showServiceDurationLabel")),1)])]),e("div",Be,[e("label",Le,[u(e("input",{type:"checkbox","onUpdate:modelValue":r[17]||(r[17]=i=>n.value.show_service_price=i),class:"form-checkbox"},null,512),[[v,n.value.show_service_price]]),e("span",null,d(c(t)("booking.showServicePriceLabel")),1)])]),e("div",Fe,[e("label",Ce,[u(e("input",{type:"checkbox","onUpdate:modelValue":r[18]||(r[18]=i=>n.value.required_employee=i),class:"form-checkbox"},null,512),[[v,n.value.required_employee]]),e("span",null,d(c(t)("booking.makeEmployeeRequiredLabel")),1)])]),e("div",Pe,[e("label",null,d(c(t)("booking.customServiceInfoTextLabel")),1),u(e("textarea",{"onUpdate:modelValue":r[19]||(r[19]=i=>n.value.service_info_text=i),class:"form-control",rows:"3",placeholder:"{service_info}"},null,512),[[h,n.value.service_info_text]])])]),e("div",Te,[e("h3",Ae,d(c(t)("booking.labelsTextLabel")),1),e("div",Ee,[e("label",null,d(c(t)("booking.nextButtonTextLabel")),1),u(e("input",{type:"text","onUpdate:modelValue":r[20]||(r[20]=i=>n.value.labels.next=i),class:"form-control",placeholder:c(t)("booking.nextButtonPlaceholder")},null,8,Me),[[h,n.value.labels.next]])]),e("div",je,[e("label",null,d(c(t)("booking.previousButtonTextLabel")),1),u(e("input",{type:"text","onUpdate:modelValue":r[21]||(r[21]=i=>n.value.labels.previous=i),class:"form-control",placeholder:c(t)("booking.previousButtonPlaceholder")},null,8,$e),[[h,n.value.labels.previous]])]),e("div",Ne,[e("label",null,d(c(t)("booking.saveButtonTextLabel")),1),u(e("input",{type:"text","onUpdate:modelValue":r[22]||(r[22]=i=>n.value.labels.save=i),class:"form-control",placeholder:c(t)("booking.saveButtonPlaceholder")},null,8,Ie),[[h,n.value.labels.save]])])]),e("div",De,[e("h3",qe,d(c(t)("booking.advancedLabel")),1),e("div",Oe,[e("label",null,d(c(t)("booking.customCSSLabel")),1),u(e("textarea",{"onUpdate:modelValue":r[23]||(r[23]=i=>n.value.custom_css=i),class:"form-control code-textarea",rows:"6",placeholder:c(t)("booking.customCSSPlaceholder")},null,8,ze),[[h,n.value.custom_css]])]),e("div",Re,[e("label",null,d(c(t)("booking.customJSLabel")),1),u(e("textarea",{"onUpdate:modelValue":r[24]||(r[24]=i=>n.value.custom_js=i),class:"form-control code-textarea",rows:"6",placeholder:c(t)("booking.customJSPlaceholder")},null,8,Je),[[h,n.value.custom_js]])])]),e("div",Ke,[e("button",{onClick:S,class:"btn btn-primary",disabled:c(o).settings.saving},d(c(o).settings.saving?c(t)("booking.savingSettings"):c(t)("booking.saveSettings")),9,Ge)])],2)])]),e("div",He,[e("div",Qe,[e("h2",null,d(c(t)("booking.livePreview")),1)]),e("div",We,[x($,{settings:f.value},null,8,["settings"])])])])]))}},Ye=N(Xe,[["__scopeId","data-v-cf65c654"]]),nt=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));export{nt as B,I as u};
