import{f as B,g as U,i as L,c as y,o as x,b as e,d as S,u as p,C as F,t as d,P as T,a as V,n as C,Q as h,R as f,S as v,T as A,h as P}from"../chunk-vendor-vue-CVODRAc9.js";import{d as M}from"../chunk-vendor-pinia-DSPKUyr1.js";import{a as m,p as w,u as $}from"../chunk-component-NotificationsBell-DXvfEbaA.js";import{a as j}from"../chunk-component-Sidebar-BCBXCjN-.js";import{B as E}from"./BookingFormPreview-CRxQyI9V.js";import{_ as I}from"../chunk-component-Card-DAbGoLxt.js";const k=B([]);let N=0;function D(){const c=(u,g="success",n=3e3)=>{const b=N++,_={id:b,message:u,type:g,visible:!0};return k.value.push(_),setTimeout(()=>{o(b)},n),b},o=u=>{const g=k.value.findIndex(n=>n.id===u);g!==-1&&k.value.splice(g,1)};return{toasts:k,showToast:c,removeToast:o,success:(u,g)=>c(u,"success",g),error:(u,g)=>c(u,"error",g),warning:(u,g)=>c(u,"warning",g),info:(u,g)=>c(u,"info",g)}}const q=M("bookings",{state:()=>({services:{items:[],loading:!1,error:null,prefetched:!1,pagination:{current_page:1,per_page:20,total:0,total_pages:0}},staff:{items:[],loading:!1,error:null,prefetched:!1,pagination:{current_page:1,per_page:20,total:0,total_pages:0}},appointments:{items:[],loading:!1,error:null,prefetched:!1,pagination:{current_page:1,per_page:20,total:0,total_pages:0},filters:{date_from:"",date_to:"",status:""}},settings:{general:{},url:{},calendar:{},company:{},customers:{},appointments:{},payments:{},appearance:{},business_hours:[],holidays:[],loading:!1,saving:!1,error:null}}),actions:{async fetchServices(c={},o=!1){var a,i,s;if(!o&&this.services.prefetched&&this.services.items.length>0)return{items:this.services.items,total:this.services.items.length};this.services.loading=!0,this.services.error=null;try{const t=await m.get("/services",{params:{page:this.services.pagination.current_page,per_page:this.services.pagination.per_page,...c}}),u=((a=t.data)==null?void 0:a.data)??t.data??{};this.services.items=(u.items||[]).map(g=>({...g,title:g.title??g.name_ar??g.name??"",duration:Number(g.duration??0),price:Number(g.price??0)})),this.services.pagination=u.pagination||this.services.pagination}catch(t){this.services.error=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||t.message||"Failed to fetch services",console.error("Error fetching services:",t)}finally{this.services.loading=!1}},async prefetchServices(c={}){try{const o=await w("services",{...c,per_page:50});return o.data&&o.data.data&&o.data.data.items&&(this.services.items=(o.data.data.items||[]).map(a=>({...a,title:a.title??a.name_ar??a.name??"",duration:Number(a.duration??0),price:Number(a.price??0)})),this.services.prefetched=!0),o.data}catch(o){console.error("Error prefetching services:",o)}},async createService(c){var o,a,i;this.services.loading=!0,this.services.error=null;try{const s={...c||{}};s.title&&!s.name&&(s.name=s.title),s.title&&!s.name_ar&&(s.name_ar=s.title);const t=await m.post("/services",s);return((o=t.data)==null?void 0:o.data)??t.data}catch(s){throw this.services.error=((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.message)||s.message||"Failed to create service",s}finally{this.services.loading=!1}},async updateService(c,o){var a,i,s;this.services.loading=!0,this.services.error=null;try{const t={...o||{}};t.title&&!t.name&&(t.name=t.title),t.title&&!t.name_ar&&(t.name_ar=t.title);const u=await m.put(`/services/${c}`,t);return((a=u.data)==null?void 0:a.data)??u.data}catch(t){throw this.services.error=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||t.message||"Failed to update service",t}finally{this.services.loading=!1}},async deleteService(c){var o,a;this.services.loading=!0,this.services.error=null;try{return await m.delete(`/services/${c}`),!0}catch(i){throw this.services.error=((a=(o=i.response)==null?void 0:o.data)==null?void 0:a.message)||i.message||"Failed to delete service",i}finally{this.services.loading=!1}},async fetchStaff(c={},o=!1){var a,i,s;if(!o&&this.staff.prefetched&&this.staff.items.length>0)return{items:this.staff.items,total:this.staff.items.length};this.staff.loading=!0,this.staff.error=null;try{const t=await m.get("/staff",{params:{page:this.staff.pagination.current_page,per_page:this.staff.pagination.per_page,...c}}),u=((a=t.data)==null?void 0:a.data)??t.data??{};this.staff.items=(u.items||[]).map(g=>({...g,full_name:g.full_name??g.name??""})),this.staff.pagination=u.pagination||this.staff.pagination}catch(t){this.staff.error=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||t.message||"Failed to fetch staff",console.error("Error fetching staff:",t)}finally{this.staff.loading=!1}},async prefetchStaff(c={}){try{const o=await w("staff",{...c,per_page:50});return o.data&&o.data.data&&o.data.data.items&&(this.staff.items=(o.data.data.items||[]).map(a=>({...a,full_name:a.full_name??a.name??""})),this.staff.prefetched=!0),o.data}catch(o){console.error("Error prefetching staff:",o)}},async createStaff(c){var o,a,i;this.staff.loading=!0,this.staff.error=null;try{const s={...c||{}};s.full_name&&!s.name&&(s.name=s.full_name);const t=await m.post("/staff",s);return((o=t.data)==null?void 0:o.data)??t.data}catch(s){throw this.staff.error=((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.message)||s.message||"Failed to create staff",s}finally{this.staff.loading=!1}},async updateStaff(c,o){var a,i,s;this.staff.loading=!0,this.staff.error=null;try{const t={...o||{}};t.full_name&&!t.name&&(t.name=t.full_name);const u=await m.put(`/staff/${c}`,t);return((a=u.data)==null?void 0:a.data)??u.data}catch(t){throw this.staff.error=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||t.message||"Failed to update staff",t}finally{this.staff.loading=!1}},async deleteStaff(c){var o,a;this.staff.loading=!0,this.staff.error=null;try{return await m.delete(`/staff/${c}`),!0}catch(i){throw this.staff.error=((a=(o=i.response)==null?void 0:o.data)==null?void 0:a.message)||i.message||"Failed to delete staff",i}finally{this.staff.loading=!1}},async fetchAppointments(c={},o=!1){var a,i,s;if(!o&&this.appointments.prefetched&&this.appointments.items.length>0)return{items:this.appointments.items,total:this.appointments.items.length};this.appointments.loading=!0,this.appointments.error=null;try{const t=await m.get("/bookings",{params:{page:this.appointments.pagination.current_page,per_page:this.appointments.pagination.per_page,...this.appointments.filters,...c}}),u=((a=t.data)==null?void 0:a.data)??t.data??{};this.appointments.items=u.items||[],this.appointments.pagination=u.pagination||this.appointments.pagination}catch(t){this.appointments.error=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||t.message||"Failed to fetch appointments",console.error("Error fetching appointments:",t)}finally{this.appointments.loading=!1}},async prefetchAppointments(c={}){try{const o=await w("bookings",{...c,per_page:50});return o.data&&o.data.data&&o.data.data.items&&(this.appointments.items=o.data.data.items||[],this.appointments.prefetched=!0),o.data}catch(o){console.error("Error prefetching appointments:",o)}},async createAppointment(c){var o,a,i;this.appointments.loading=!0,this.appointments.error=null;try{const s=await m.post("/bookings",c);return((o=s.data)==null?void 0:o.data)??s.data}catch(s){throw this.appointments.error=((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.message)||s.message||"Failed to create appointment",s}finally{this.appointments.loading=!1}},async updateAppointment(c,o){var a,i,s;this.appointments.loading=!0,this.appointments.error=null;try{const t=await m.put(`/bookings/${c}`,o);return((a=t.data)==null?void 0:a.data)??t.data}catch(t){throw this.appointments.error=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||t.message||"Failed to update appointment",t}finally{this.appointments.loading=!1}},async deleteAppointment(c){var o,a;this.appointments.loading=!0,this.appointments.error=null;try{return await m.delete(`/bookings/${c}`),!0}catch(i){throw this.appointments.error=((a=(o=i.response)==null?void 0:o.data)==null?void 0:a.message)||i.message||"Failed to delete appointment",i}finally{this.appointments.loading=!1}},async fetchSettings(c){var o,a,i;this.settings.loading=!0,this.settings.error=null;try{const s=await m.get(`/booking/settings/${c}`),t=c==="business-hours"?"business_hours":c,u=((o=s.data)==null?void 0:o.data)??s.data;return this.settings[t]=u,u}catch(s){throw this.settings.error=((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.message)||s.message||"Failed to fetch settings",s}finally{this.settings.loading=!1}},async saveSettings(c,o){var a,i,s;this.settings.saving=!0,this.settings.error=null;try{const t=await m.post(`/booking/settings/${c}`,o),u=c==="business-hours"?"business_hours":c,g=((a=t.data)==null?void 0:a.data)??t.data;return this.settings[u]=g,g}catch(t){throw this.settings.error=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||t.message||"Failed to save settings",t}finally{this.settings.saving=!1}},async fetchAllSettings(){var c,o,a;this.settings.loading=!0,this.settings.error=null;try{const i=await m.get("/booking/settings/all"),s=((c=i.data)==null?void 0:c.data)??i.data;return this.settings.general=s.general||{},this.settings.url=s.url||{},this.settings.calendar=s.calendar||{},this.settings.company=s.company||{},this.settings.customers=s.customers||{},this.settings.appointments=s.appointments||{},this.settings.payments=s.payments||{},this.settings.appearance=s.appearance||{},this.settings.business_hours=s.business_hours||[],this.settings.holidays=s.holidays||[],s}catch(i){throw this.settings.error=((a=(o=i.response)==null?void 0:o.data)==null?void 0:a.message)||i.message||"Failed to fetch settings",i}finally{this.settings.loading=!1}}}}),O={class:"booking-appearance-page"},z={class:"appearance-header"},R={class:"header-content-wrapper"},J={class:"header-text-content"},K={class:"header-subtitle"},Q={class:"appearance-container"},G={class:"editor-panel"},H={class:"panel-header"},W={class:"editor-content"},X={key:0,class:"loading-overlay"},Y={class:"settings-section"},Z={class:"section-title"},ee={class:"form-group"},te={class:"color-input-group"},se={class:"form-group"},oe={class:"color-input-group"},ae={class:"form-group"},ne={class:"color-input-group"},re={class:"form-group"},ie={class:"color-input-group"},le={class:"form-group"},ce={class:"color-input-group"},pe={class:"settings-section"},de={class:"section-title"},ue={class:"form-group"},ge={class:"checkbox-label"},he={key:0,class:"form-group"},fe={value:"top"},me={value:"bottom"},_e={class:"form-group"},ve={class:"checkbox-label"},be={class:"form-group"},ke={class:"checkbox-label"},ye={class:"settings-section"},xe={class:"section-title"},we={class:"form-group"},Se={class:"checkbox-label"},Ve={class:"form-group"},Be={class:"checkbox-label"},Ue={class:"form-group"},Le={class:"checkbox-label"},Fe={class:"form-group"},Te={class:"checkbox-label"},Ce={class:"form-group"},Ae={class:"checkbox-label"},Pe={class:"form-group"},Me={class:"settings-section"},$e={class:"section-title"},je={class:"form-group"},Ee=["placeholder"],Ie={class:"form-group"},Ne=["placeholder"],De={class:"form-group"},qe=["placeholder"],Oe={class:"settings-section"},ze={class:"section-title"},Re={class:"form-group"},Je=["placeholder"],Ke={class:"form-group"},Qe=["placeholder"],Ge={class:"form-actions"},He=["disabled"],We={class:"preview-panel"},Xe={class:"panel-header"},Ye={class:"preview-content"},Ze={__name:"BookingAppearance",setup(c){const o=P(),a=q(),i=j(),s=D(),{t}=$(),u=()=>{o.push("/bookings")},g=U(()=>n.value),n=B({primary_color:"#BBA07A",secondary_color:"#764ba2",text_color:"#1e293b",background_color:"#ffffff",button_color:"#BBA07A",show_progress_tracker:!0,progress_tracker_position:"top",align_buttons_left:!1,invert_datepicker_colors:!1,required_employee:!1,show_service_duration:!0,show_service_price:!0,show_category_info:!0,show_service_info:!0,show_staff_info:!0,service_info_text:"",staff_info_text:"",labels:{next:"",previous:"",save:""},custom_css:"",custom_js:""});L(async()=>{n.value.labels={next:t("booking.nextButtonPlaceholder"),previous:t("booking.previousButtonPlaceholder"),save:t("booking.saveButtonPlaceholder")};try{if(await a.fetchSettings("appearance"),a.settings.appearance&&Object.keys(a.settings.appearance).length>0){const _=a.settings.appearance;n.value={...n.value,..._,labels:_.labels||n.value.labels}}}catch(_){console.error("Failed to load appearance settings:",_)}});const b=async()=>{try{await a.saveSettings("appearance",n.value);const _=i.locale==="ar"?"✅ تم حفظ إعدادات المظهر بنجاح":"✅ Appearance settings saved successfully";s.success(_)}catch(_){console.error("Failed to save appearance settings:",_);const r=i.locale==="ar"?"❌ فشل حفظ الإعدادات: "+(_.message||"خطأ غير معروف"):"❌ Failed to save settings: "+(_.message||"Unknown error");s.error(r)}};return(_,r)=>(x(),y("div",O,[e("div",z,[r[26]||(r[26]=e("div",{class:"header-logo-bg"},[e("img",{src:"https://asmaaljarallah.com/wp-content/uploads/2021/09/logo_light.png",alt:"Asmaa Logo",class:"header-logo-image"})],-1)),e("div",R,[e("button",{class:"back-button",onClick:u},[S(p(F),{icon:"cil-arrow-left"}),e("span",null,d(p(t)("common.back")||"Back"),1)]),e("div",J,[e("h1",null,[r[25]||(r[25]=e("svg",{class:"header-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})],-1)),T(" "+d(p(t)("booking.appearanceTitle")),1)]),e("p",K,d(p(t)("booking.appearanceSubtitle")),1)])])]),e("div",Q,[e("div",G,[e("div",H,[e("h2",null,d(p(t)("booking.appearanceSettings")),1)]),e("div",W,[p(a).settings.loading?(x(),y("div",X,[r[27]||(r[27]=e("div",{class:"spinner"},null,-1)),e("p",null,d(p(t)("booking.loadingSettings")),1)])):V("",!0),e("div",{class:C(["settings-sections",{loading:p(a).settings.loading}])},[e("div",Y,[e("h3",Z,d(p(t)("booking.colorScheme")),1),e("div",ee,[e("label",null,d(p(t)("booking.primaryColor")),1),e("div",te,[h(e("input",{type:"color","onUpdate:modelValue":r[0]||(r[0]=l=>n.value.primary_color=l),class:"color-picker"},null,512),[[f,n.value.primary_color]]),h(e("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=l=>n.value.primary_color=l),class:"form-control color-text"},null,512),[[f,n.value.primary_color]])])]),e("div",se,[e("label",null,d(p(t)("booking.secondaryColor")),1),e("div",oe,[h(e("input",{type:"color","onUpdate:modelValue":r[2]||(r[2]=l=>n.value.secondary_color=l),class:"color-picker"},null,512),[[f,n.value.secondary_color]]),h(e("input",{type:"text","onUpdate:modelValue":r[3]||(r[3]=l=>n.value.secondary_color=l),class:"form-control color-text"},null,512),[[f,n.value.secondary_color]])])]),e("div",ae,[e("label",null,d(p(t)("booking.textColor")),1),e("div",ne,[h(e("input",{type:"color","onUpdate:modelValue":r[4]||(r[4]=l=>n.value.text_color=l),class:"color-picker"},null,512),[[f,n.value.text_color]]),h(e("input",{type:"text","onUpdate:modelValue":r[5]||(r[5]=l=>n.value.text_color=l),class:"form-control color-text"},null,512),[[f,n.value.text_color]])])]),e("div",re,[e("label",null,d(p(t)("booking.backgroundColor")),1),e("div",ie,[h(e("input",{type:"color","onUpdate:modelValue":r[6]||(r[6]=l=>n.value.background_color=l),class:"color-picker"},null,512),[[f,n.value.background_color]]),h(e("input",{type:"text","onUpdate:modelValue":r[7]||(r[7]=l=>n.value.background_color=l),class:"form-control color-text"},null,512),[[f,n.value.background_color]])])]),e("div",le,[e("label",null,d(p(t)("booking.buttonColor")),1),e("div",ce,[h(e("input",{type:"color","onUpdate:modelValue":r[8]||(r[8]=l=>n.value.button_color=l),class:"color-picker"},null,512),[[f,n.value.button_color]]),h(e("input",{type:"text","onUpdate:modelValue":r[9]||(r[9]=l=>n.value.button_color=l),class:"form-control color-text"},null,512),[[f,n.value.button_color]])])])]),e("div",pe,[e("h3",de,d(p(t)("booking.formOptions")),1),e("div",ue,[e("label",ge,[h(e("input",{type:"checkbox","onUpdate:modelValue":r[10]||(r[10]=l=>n.value.show_progress_tracker=l),class:"form-checkbox"},null,512),[[v,n.value.show_progress_tracker]]),e("span",null,d(p(t)("booking.showProgressTrackerLabel")),1)])]),n.value.show_progress_tracker?(x(),y("div",he,[e("label",null,d(p(t)("booking.progressTrackerPositionLabel")),1),h(e("select",{"onUpdate:modelValue":r[11]||(r[11]=l=>n.value.progress_tracker_position=l),class:"form-control"},[e("option",fe,d(p(t)("booking.positionTop")),1),e("option",me,d(p(t)("booking.positionBottom")),1)],512),[[A,n.value.progress_tracker_position]])])):V("",!0),e("div",_e,[e("label",ve,[h(e("input",{type:"checkbox","onUpdate:modelValue":r[12]||(r[12]=l=>n.value.align_buttons_left=l),class:"form-checkbox"},null,512),[[v,n.value.align_buttons_left]]),e("span",null,d(p(t)("booking.alignButtonsLeftLabel")),1)])]),e("div",be,[e("label",ke,[h(e("input",{type:"checkbox","onUpdate:modelValue":r[13]||(r[13]=l=>n.value.invert_datepicker_colors=l),class:"form-checkbox"},null,512),[[v,n.value.invert_datepicker_colors]]),e("span",null,d(p(t)("booking.invertDatepickerColorsLabel")),1)])])]),e("div",ye,[e("h3",xe,d(p(t)("booking.serviceStepLabel")),1),e("div",we,[e("label",Se,[h(e("input",{type:"checkbox","onUpdate:modelValue":r[14]||(r[14]=l=>n.value.show_category_info=l),class:"form-checkbox"},null,512),[[v,n.value.show_category_info]]),e("span",null,d(p(t)("booking.showCategoryInfoLabel")),1)])]),e("div",Ve,[e("label",Be,[h(e("input",{type:"checkbox","onUpdate:modelValue":r[15]||(r[15]=l=>n.value.show_service_info=l),class:"form-checkbox"},null,512),[[v,n.value.show_service_info]]),e("span",null,d(p(t)("booking.showServiceInfoLabel")),1)])]),e("div",Ue,[e("label",Le,[h(e("input",{type:"checkbox","onUpdate:modelValue":r[16]||(r[16]=l=>n.value.show_service_duration=l),class:"form-checkbox"},null,512),[[v,n.value.show_service_duration]]),e("span",null,d(p(t)("booking.showServiceDurationLabel")),1)])]),e("div",Fe,[e("label",Te,[h(e("input",{type:"checkbox","onUpdate:modelValue":r[17]||(r[17]=l=>n.value.show_service_price=l),class:"form-checkbox"},null,512),[[v,n.value.show_service_price]]),e("span",null,d(p(t)("booking.showServicePriceLabel")),1)])]),e("div",Ce,[e("label",Ae,[h(e("input",{type:"checkbox","onUpdate:modelValue":r[18]||(r[18]=l=>n.value.required_employee=l),class:"form-checkbox"},null,512),[[v,n.value.required_employee]]),e("span",null,d(p(t)("booking.makeEmployeeRequiredLabel")),1)])]),e("div",Pe,[e("label",null,d(p(t)("booking.customServiceInfoTextLabel")),1),h(e("textarea",{"onUpdate:modelValue":r[19]||(r[19]=l=>n.value.service_info_text=l),class:"form-control",rows:"3",placeholder:"{service_info}"},null,512),[[f,n.value.service_info_text]])])]),e("div",Me,[e("h3",$e,d(p(t)("booking.labelsTextLabel")),1),e("div",je,[e("label",null,d(p(t)("booking.nextButtonTextLabel")),1),h(e("input",{type:"text","onUpdate:modelValue":r[20]||(r[20]=l=>n.value.labels.next=l),class:"form-control",placeholder:p(t)("booking.nextButtonPlaceholder")},null,8,Ee),[[f,n.value.labels.next]])]),e("div",Ie,[e("label",null,d(p(t)("booking.previousButtonTextLabel")),1),h(e("input",{type:"text","onUpdate:modelValue":r[21]||(r[21]=l=>n.value.labels.previous=l),class:"form-control",placeholder:p(t)("booking.previousButtonPlaceholder")},null,8,Ne),[[f,n.value.labels.previous]])]),e("div",De,[e("label",null,d(p(t)("booking.saveButtonTextLabel")),1),h(e("input",{type:"text","onUpdate:modelValue":r[22]||(r[22]=l=>n.value.labels.save=l),class:"form-control",placeholder:p(t)("booking.saveButtonPlaceholder")},null,8,qe),[[f,n.value.labels.save]])])]),e("div",Oe,[e("h3",ze,d(p(t)("booking.advancedLabel")),1),e("div",Re,[e("label",null,d(p(t)("booking.customCSSLabel")),1),h(e("textarea",{"onUpdate:modelValue":r[23]||(r[23]=l=>n.value.custom_css=l),class:"form-control code-textarea",rows:"6",placeholder:p(t)("booking.customCSSPlaceholder")},null,8,Je),[[f,n.value.custom_css]])]),e("div",Ke,[e("label",null,d(p(t)("booking.customJSLabel")),1),h(e("textarea",{"onUpdate:modelValue":r[24]||(r[24]=l=>n.value.custom_js=l),class:"form-control code-textarea",rows:"6",placeholder:p(t)("booking.customJSPlaceholder")},null,8,Qe),[[f,n.value.custom_js]])])]),e("div",Ge,[e("button",{onClick:b,class:"btn btn-primary",disabled:p(a).settings.saving},d(p(a).settings.saving?p(t)("booking.savingSettings"):p(t)("booking.saveSettings")),9,He)])],2)])]),e("div",We,[e("div",Xe,[e("h2",null,d(p(t)("booking.livePreview")),1)]),e("div",Ye,[S(E,{settings:g.value},null,8,["settings"])])])])]))}},et=I(Ze,[["__scopeId","data-v-82609cd9"]]),it=Object.freeze(Object.defineProperty({__proto__:null,default:et},Symbol.toStringTag,{value:"Module"}));export{it as B,D as a,q as u};
