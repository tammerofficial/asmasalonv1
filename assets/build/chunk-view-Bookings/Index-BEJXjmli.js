import{f as g,e as R,j as Pe,m as Ee,c as _,o as u,b as t,d as o,t as l,u as e,w as i,Y as U,x as p,p as He,C as v,Z as Ke,R as P,V as E,h as re,F as N,g as T,_ as Oe,$ as z,a0 as H,l as Ge,P as m,s as K,z as We,a1 as Xe,a as j,X as O,a2 as y,a3 as C,a4 as L,a5 as G,a6 as W,a7 as X,a8 as Y,a9 as Ye}from"../chunk-vendor-vue-Dg0iJD_h.js";import{a as Ze}from"../chunk-component-Sidebar-C3FUOXM8.js";import{u as Je}from"./BookingAppearance-BueJCNuq.js";import{u as Qe,a as Ce}from"../chunk-component-NotificationsBell-B2dAMSJx.js";import{B as et}from"./BookingCalendar-DcxG7-xD.js";import{H as tt}from"../chunk-component-HelpSection-CAMARqlT.js";import{u as st}from"../chunk-view-AppleWallet/Simulator-FWAoI2CS.js";import{_ as ot}from"../chunk-component-Card-BEqwRdY0.js";import"../chunk-vendor-Ltsl4QyH.js";import"../chunk-vendor-pinia-AvH0NMyG.js";import"./BookingFormPreview-ChbU6Ero.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-PageHeader-CswlebSl.js";const lt={class:"booking-page p-4"},at={class:"pos-header-top d-flex justify-content-between align-items-center mb-4"},nt={class:"header-left d-flex align-items-center gap-3"},it={class:"mb-0 fw-bold text-primary"},dt={class:"header-right d-flex gap-3"},ct={class:"nano-stats-bar mb-4"},rt={class:"stat-card-nano"},ut={class:"stat-icon-bg services"},mt={class:"stat-info"},vt={class:"stat-value"},_t={class:"stat-label"},ft={class:"stat-card-nano"},pt={class:"stat-icon-bg staff"},bt={class:"stat-info"},gt={class:"stat-value"},ht={class:"stat-label"},kt={class:"stat-card-nano"},yt={class:"stat-icon-bg approved"},wt={class:"stat-info"},Ct={class:"stat-value text-success"},St={class:"stat-label"},xt={class:"stat-card-nano"},Vt={class:"stat-icon-bg pending"},Nt={class:"stat-info"},Tt={class:"stat-value text-warning"},Mt={class:"stat-label"},At={class:"booking-content-wrapper"},$t={class:"nano-panel"},Bt={class:"panel-header d-flex justify-content-between align-items-center mb-4"},Dt={class:"fw-bold"},Ft={key:0,class:"text-center p-5"},Ut={key:1,class:"nano-grid"},It=["onClick"],qt={class:"item-badge"},zt={class:"item-icon-circle"},jt={class:"item-title"},Lt={class:"item-price-tag"},Rt={class:"item-actions-hover"},Pt={class:"nano-panel"},Et={class:"panel-header d-flex justify-content-between align-items-center mb-4"},Ht={class:"fw-bold"},Kt={key:0,class:"text-center p-5"},Ot={key:1,class:"nano-grid staff-grid"},Gt={class:"staff-avatar-large"},Wt={class:"item-title mt-3"},Xt={class:"text-muted small"},Yt={class:"staff-badges mt-2"},Zt={class:"item-actions-hover"},Jt={class:"nano-panel"},Qt={class:"panel-header mb-4"},es={class:"d-flex justify-content-between align-items-center mb-3"},ts={class:"fw-bold"},ss={class:"view-switcher"},os={class:"nano-filters-bar p-3 bg-tertiary rounded-4 mb-4"},ls={class:"small fw-bold text-muted mb-1"},as={class:"small fw-bold text-muted mb-1"},ns={class:"small fw-bold text-muted mb-1"},is={value:""},ds={value:"pending"},cs={value:"confirmed"},rs={value:"completed"},us={value:"cancelled"},ms={key:0,class:"calendar-container"},vs={key:1,class:"appointments-list-view"},_s={key:0,class:"text-center p-5"},fs={key:1,class:"appointments-list d-flex flex-column gap-3"},ps={class:"appt-date-box"},bs={class:"appt-day"},gs={class:"appt-month"},hs={class:"appt-time"},ks={class:"appt-main-info flex-grow-1 ms-3"},ys={class:"appt-service fw-bold fs-5 text-primary"},ws={class:"appt-staff small text-muted"},Cs={key:0,class:"appt-customer small text-muted"},Ss={class:"appt-status-box px-3"},xs={class:"appt-actions d-flex gap-2"},Vs={class:"nano-panel"},Ns={class:"panel-header mb-4"},Ts={class:"fw-bold"},Ms={class:"nano-table-container"},As={class:"nano-table w-100"},$s={class:"text-start"},Bs={class:"text-end"},Ds={class:"text-start fw-bold"},Fs={class:"text-end text-success fw-bold"},Us={class:"nano-table-footer border-top mt-3 bg-light"},Is={colspan:"3",class:"text-start fw-bold p-3"},qs={class:"fw-bold p-3"},zs={class:"text-end text-success fw-bold p-3"},js={class:"nano-modal-details p-3"},Ls={class:"d-flex align-items-center gap-4 mb-4"},Rs={class:"item-icon-circle large bg-primary text-white"},Ps={class:"fw-bold mb-1"},Es={class:"row g-3"},Hs={class:"stat-card-nano mini p-3 border rounded-4 text-center"},Ks={class:"text-muted small"},Os={class:"fw-bold fs-5"},Gs={class:"stat-card-nano mini p-3 border rounded-4 text-center"},Ws={class:"text-muted small"},Xs={class:"fw-bold fs-5 text-success"},Ys={class:"stat-card-nano mini p-3 border rounded-4 text-center"},Zs={class:"text-muted small"},Js={class:"fw-bold fs-5 text-primary"},Qs={class:"p-3"},eo={class:"mb-3"},to={class:"form-label fw-bold"},so={class:"form-label fw-bold"},oo={class:"form-label fw-bold"},lo={class:"p-3"},ao={class:"mb-3"},no={class:"form-label fw-bold"},io={class:"mb-3"},co={class:"form-label fw-bold"},ro={class:"mb-3"},uo={class:"form-label fw-bold"},mo={class:"p-3"},vo={class:"form-label fw-bold"},_o={value:0,disabled:""},fo={key:0,value:0,disabled:""},po=["value"],bo={class:"form-label fw-bold"},go={value:"pending"},ho={value:"confirmed"},ko={value:"completed"},yo={value:"cancelled"},wo={class:"form-label fw-bold"},Co={value:0,disabled:""},So=["value"],xo={class:"form-label fw-bold"},Vo={value:0},No=["value"],To={class:"form-label fw-bold"},Mo={class:"form-label fw-bold"},Ao={class:"mb-3"},$o={class:"form-label fw-bold"},Bo={__name:"Index",setup(Do){const{t:n}=Qe();Ze();const r=Je(),ue=Ee(),Se=Ge(),k=st(),M=g("services"),I=g("calendar"),Z=g(!1),J=g(!1),Q=g(!1),ee=g(!1),V=g(null),$=g(null),B=g(null),D=g(null),w=g(!1),xe=R(()=>[{id:"services",label:n("booking.servicesTab"),count:r.services.items.length},{id:"staff",label:n("booking.staffTab"),count:r.staff.items.length},{id:"appointments",label:n("booking.appointmentsTab"),count:r.appointments.items.length},{id:"analytics",label:n("booking.analyticsTab")}]),Ve=d=>{switch(d){case"services":return"cil-spreadsheet";case"staff":return"cil-user";case"appointments":return"cil-calendar";case"analytics":return"cil-chart-line";default:return"cil-list"}},Ne=d=>{switch(d){case"pending":return"warning";case"confirmed":return"info";case"completed":return"success";case"cancelled":return"danger";default:return"secondary"}},A=g({date_from:"",date_to:"",status:""}),S=g({title:"",duration:60,price:0}),x=g({full_name:"",email:"",phone:""}),b=g({customer_id:0,staff_id:0,service_id:0,booking_date:"",booking_time:"",status:"pending",notes:""}),F=g([]),te=g(!1),se=g("");let oe=null;const me=async(d="")=>{var a;te.value=!0;try{const c=await Ce.get("/customers",{params:{page:1,per_page:50,search:d||void 0,status:"active"},noCache:!0}),s=((a=c.data)==null?void 0:a.data)??c.data??{};F.value=s.items||[]}catch(c){console.error("Failed to fetch customers:",c),F.value=[]}finally{te.value=!1}},Te=async d=>{var s;const a=Number(d||0);if(!(!a||(F.value||[]).some(f=>Number(f.id)===a)))try{const f=await Ce.get(`/customers/${a}`,{noCache:!0}),h=((s=f.data)==null?void 0:s.data)??f.data??null;h&&h.id&&(F.value=[h,...F.value||[]])}catch{}},Me=()=>{oe&&clearTimeout(oe),oe=setTimeout(()=>{me(se.value)},350)},ve=R(()=>{const d=r.appointments.items||[];let a=0,c=0,s=d.length;return d.forEach(h=>{h.status==="confirmed"||h.status==="approved"?a++:h.status==="pending"&&c++}),{approved:a,pending:c,total:s,revenue:0}}),_e=R(()=>{const d=r.appointments.items||[],a=new Map,c=new Set;return d.forEach(s=>{const f=`${s.staff_id||0}-${s.service_id||0}`;a.has(f)||a.set(f,{key:f,staffId:s.staff_id,serviceId:s.service_id,employeeName:ge(s.staff_id),serviceName:pe(s.service_id),total:0,approved:0,pending:0,rejected:0,cancelled:0,customersSet:new Set,newCustomers:0,revenue:0});const h=a.get(f);if(h.total++,s.status==="confirmed"||s.status==="approved"?h.approved++:s.status==="pending"?h.pending++:s.status==="rejected"?h.rejected++:s.status==="cancelled"&&h.cancelled++,s.customer_id){h.customersSet.add(s.customer_id);const we=String(s.customer_id);c.has(we)||(h.newCustomers++,c.add(we))}}),Array.from(a.values()).map(s=>({...s,customersTotal:s.customersSet.size}))}),fe=R(()=>_e.value.reduce((a,c)=>(a.total+=c.total,a.approved+=c.approved,a.pending+=c.pending,a.rejected+=c.rejected,a.cancelled+=c.cancelled,a.customersTotal+=c.customersTotal,a.newCustomers+=c.newCustomers,a.revenue+=c.revenue,a),{total:0,approved:0,pending:0,rejected:0,cancelled:0,customersTotal:0,newCustomers:0,revenue:0})),pe=d=>{const a=r.services.items.find(c=>Number(c.id)===Number(d));return a?a.title:"—"},Ae=d=>{const a=r.services.items.find(c=>Number(c.id)===Number(d));return a?a.price:0},be=d=>{const a=r.services.items.find(c=>Number(c.id)===Number(d));return a?a.duration:0},$e=d=>r.appointments.items.filter(a=>Number(a.service_id)===Number(d)).length,ge=d=>{const a=r.staff.items.find(c=>Number(c.id)===Number(d));return a?a.full_name:"—"},le=(d,a="full")=>{if(!d)return"—";const c=new Date(d);return isNaN(c.getTime())?d:a==="day"?c.getDate():a==="month"?c.toLocaleString("default",{month:"short"}):a==="time"?c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):c.toLocaleDateString()},q=d=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",minimumFractionDigits:3}).format(d||0),he=d=>{V.value=d,ee.value=!0},ae=()=>{ee.value=!1,V.value=null},Be=d=>{const a=r.services.items.find(c=>Number(c.id)===Number(d));a&&he(a)},ne=(d=null)=>{d?($.value=d,S.value={title:d.title,duration:d.duration,price:d.price}):($.value=null,S.value={title:"",duration:60,price:0}),Z.value=!0},ie=()=>{Z.value=!1,$.value=null},De=async()=>{w.value=!0;try{$.value?(await r.updateService($.value.id,S.value),k.success(n("booking.serviceUpdated")||"Service updated")):(await r.createService(S.value),k.success(n("booking.serviceAdded")||"Service added")),ie()}catch{k.error("Failed to save service")}finally{w.value=!1}},Fe=async d=>{if(confirm(n("common.confirmDelete")))try{await r.deleteService(d),k.success(n("booking.serviceDeleted"))}catch{k.error("Failed to delete service")}},ke=(d=null)=>{d?(B.value=d,x.value={full_name:d.full_name,email:d.email,phone:d.phone}):(B.value=null,x.value={full_name:"",email:"",phone:""}),J.value=!0},de=()=>{J.value=!1,B.value=null},Ue=async()=>{w.value=!0;try{B.value?(await r.updateStaff(B.value.id,x.value),k.success(n("booking.staffUpdated"))):(await r.createStaff(x.value),k.success(n("booking.staffAdded"))),de()}catch{k.error("Failed to save staff")}finally{w.value=!1}},Ie=async d=>{if(confirm(n("common.confirmDelete")))try{await r.deleteStaff(d),k.success(n("booking.staffDeleted"))}catch{k.error("Failed to delete staff")}},qe=()=>{ye()},ye=async(d=null)=>{if(me(),d){D.value=d;const a=new Date(d.start_date);b.value={customer_id:Number(d.customer_id),staff_id:Number(d.staff_id),service_id:Number(d.service_id),booking_date:a.toISOString().split("T")[0],booking_time:a.toTimeString().split(" ")[0].slice(0,5),status:d.status,notes:d.notes||""},await Te(d.customer_id)}else{D.value=null;const a=new Date;b.value={customer_id:0,staff_id:0,service_id:0,booking_date:a.toISOString().split("T")[0],booking_time:a.toTimeString().split(" ")[0].slice(0,5),status:"pending",notes:""}}Q.value=!0},ce=()=>{Q.value=!1,D.value=null},ze=async()=>{if(!b.value.customer_id||!b.value.service_id){k.error("Please select customer and service");return}w.value=!0;try{const d={...b.value,start_date:`${b.value.booking_date} ${b.value.booking_time}:00`};D.value?(await r.updateAppointment(D.value.id,d),k.success("Booking updated")):(await r.createAppointment(d),k.success("Booking added")),ce()}catch{k.error("Failed to save booking")}finally{w.value=!1}},je=async d=>{if(confirm(n("common.confirmDelete")))try{await r.deleteAppointment(d),k.success("Booking deleted")}catch{k.error("Failed to delete booking")}},Le=()=>{r.fetchAppointments(A.value)},Re=d=>{Se.push({path:"/pos",query:{customer_id:d.customer_id,booking_id:d.id,service_id:d.service_id,staff_id:d.staff_id}})};return Pe(()=>{r.prefetch(),ue.query.tab&&(M.value=ue.query.tab)}),(d,a)=>{const c=He("router-link");return u(),_("div",lt,[t("div",at,[t("div",nt,[t("h2",it,l(e(n)("booking.title")),1),o(e(U),{color:"gold",shape:"rounded-pill",class:"px-3 py-2 fw-bold text-dark"},{default:i(()=>[o(e(v),{icon:"cil-calendar",class:"me-1"}),m(" "+l(e(r).appointments.items.length)+" "+l(e(n)("booking.totalAppointments")),1)]),_:1})]),t("div",dt,[o(e(p),{color:"primary",class:"nano-btn",onClick:qe},{default:i(()=>[o(e(v),{icon:"cil-plus",class:"me-2"}),m(" "+l(e(n)("booking.addBooking")||e(n)("booking.addAppointment")),1)]),_:1}),o(c,{to:"/bookings/settings",class:"btn btn-secondary nano-btn-secondary"},{default:i(()=>[o(e(v),{icon:"cil-settings",class:"me-2"}),m(" "+l(e(n)("booking.settingsButton")),1)]),_:1}),o(c,{to:"/bookings/appearance",class:"btn btn-secondary nano-btn-secondary"},{default:i(()=>[o(e(v),{icon:"cil-paint-roller",class:"me-2"}),m(" "+l(e(n)("booking.appearanceButton")),1)]),_:1})])]),t("div",ct,[t("div",rt,[t("div",ut,[o(e(v),{icon:"cil-spreadsheet"})]),t("div",mt,[t("div",vt,l(e(r).services.items.length),1),t("div",_t,l(e(n)("booking.totalServices")),1)])]),t("div",ft,[t("div",pt,[o(e(v),{icon:"cil-user"})]),t("div",bt,[t("div",gt,l(e(r).staff.items.length),1),t("div",ht,l(e(n)("booking.totalStaff")),1)])]),t("div",kt,[t("div",yt,[o(e(v),{icon:"cil-check-circle"})]),t("div",wt,[t("div",Ct,l(ve.value.approved),1),t("div",St,l(e(n)("booking.approved")),1)])]),t("div",xt,[t("div",Vt,[o(e(v),{icon:"cil-clock"})]),t("div",Nt,[t("div",Tt,l(ve.value.pending),1),t("div",Mt,l(e(n)("booking.pending")),1)])])]),o(e(Ke),{variant:"pills",class:"nano-tabs mb-4"},{default:i(()=>[(u(!0),_(N,null,T(xe.value,s=>(u(),K(e(We),{key:s.id},{default:i(()=>[o(e(Xe),{active:M.value===s.id,onClick:f=>M.value=s.id,class:"nano-tab-link"},{default:i(()=>[o(e(v),{icon:Ve(s.id),class:"me-2"},null,8,["icon"]),m(" "+l(s.label)+" ",1),s.count!==void 0?(u(),K(e(U),{key:0,color:"primary",shape:"rounded-pill",class:"ms-2"},{default:i(()=>[m(l(s.count),1)]),_:2},1024)):j("",!0)]),_:2},1032,["active","onClick"])]),_:2},1024))),128))]),_:1}),t("div",At,[P(t("div",$t,[t("div",Bt,[t("h4",Dt,l(e(n)("booking.servicesTab")),1),o(e(p),{color:"primary",variant:"ghost",onClick:a[0]||(a[0]=s=>ne())},{default:i(()=>[o(e(v),{icon:"cil-plus",class:"me-1"}),m(" "+l(e(n)("booking.addService")),1)]),_:1})]),e(r).services.loading?(u(),_("div",Ft,[o(e(re),{color:"primary"})])):(u(),_("div",Ut,[(u(!0),_(N,null,T(e(r).services.items,s=>(u(),_("div",{key:s.id,class:"nano-item-card",onClick:f=>he(s)},[t("div",qt,l(s.duration)+" "+l(e(n)("booking.min")),1),t("div",zt,[o(e(v),{icon:"cil-spreadsheet"})]),t("h5",jt,l(s.title),1),t("div",Lt,l(q(s.price)),1),t("div",Rt,[o(e(p),{size:"sm",color:"info",variant:"ghost",onClick:O(f=>ne(s),["stop"])},{default:i(()=>[o(e(v),{icon:"cil-pencil"})]),_:1},8,["onClick"]),o(e(p),{size:"sm",color:"danger",variant:"ghost",onClick:O(f=>Fe(s.id),["stop"])},{default:i(()=>[o(e(v),{icon:"cil-trash"})]),_:1},8,["onClick"])])],8,It))),128))]))],512),[[E,M.value==="services"]]),P(t("div",Pt,[t("div",Et,[t("h4",Ht,l(e(n)("booking.staffTab")),1),o(e(p),{color:"primary",variant:"ghost",onClick:a[1]||(a[1]=s=>ke())},{default:i(()=>[o(e(v),{icon:"cil-plus",class:"me-1"}),m(" "+l(e(n)("booking.addStaff")),1)]),_:1})]),e(r).staff.loading?(u(),_("div",Kt,[o(e(re),{color:"primary"})])):(u(),_("div",Ot,[(u(!0),_(N,null,T(e(r).staff.items,s=>{var f;return u(),_("div",{key:s.id,class:"nano-item-card staff-card"},[t("div",Gt,l((f=s.full_name)==null?void 0:f.charAt(0)),1),t("h5",Wt,l(s.full_name),1),t("p",Xt,l(s.email),1),t("div",Yt,[o(e(U),{color:"success",shape:"rounded-pill"},{default:i(()=>[m(l(e(n)("workerCalls.available")||"متاح"),1)]),_:1})]),t("div",Zt,[o(e(p),{size:"sm",color:"info",variant:"ghost",onClick:O(h=>ke(s),["stop"])},{default:i(()=>[o(e(v),{icon:"cil-pencil"})]),_:1},8,["onClick"]),o(e(p),{size:"sm",color:"danger",variant:"ghost",onClick:O(h=>Ie(s.id),["stop"])},{default:i(()=>[o(e(v),{icon:"cil-trash"})]),_:1},8,["onClick"])])])}),128))]))],512),[[E,M.value==="staff"]]),P(t("div",Jt,[t("div",Qt,[t("div",es,[t("h4",ts,l(e(n)("booking.appointmentsTab")),1),t("div",ss,[o(e(Oe),null,{default:i(()=>[o(e(p),{color:I.value==="calendar"?"primary":"secondary",variant:"outline",onClick:a[2]||(a[2]=s=>I.value="calendar")},{default:i(()=>[o(e(v),{icon:"cil-calendar",class:"me-1"}),m(l(e(n)("booking.calendarView")),1)]),_:1},8,["color"]),o(e(p),{color:I.value==="list"?"primary":"secondary",variant:"outline",onClick:a[3]||(a[3]=s=>I.value="list")},{default:i(()=>[o(e(v),{icon:"cil-list",class:"me-1"}),m(l(e(n)("booking.listView")),1)]),_:1},8,["color"])]),_:1})])]),t("div",os,[o(e(z),{class:"g-3"},{default:i(()=>[o(e(y),{md:"3"},{default:i(()=>[t("label",ls,l(e(n)("common.from")||"من"),1),o(e(C),{type:"date",modelValue:A.value.date_from,"onUpdate:modelValue":a[4]||(a[4]=s=>A.value.date_from=s)},null,8,["modelValue"])]),_:1}),o(e(y),{md:"3"},{default:i(()=>[t("label",as,l(e(n)("common.to")||"إلى"),1),o(e(C),{type:"date",modelValue:A.value.date_to,"onUpdate:modelValue":a[5]||(a[5]=s=>A.value.date_to=s)},null,8,["modelValue"])]),_:1}),o(e(y),{md:"3"},{default:i(()=>[t("label",ns,l(e(n)("common.status")||"الحالة"),1),o(e(L),{modelValue:A.value.status,"onUpdate:modelValue":a[6]||(a[6]=s=>A.value.status=s)},{default:i(()=>[t("option",is,l(e(n)("common.allStatuses")||"كل الحالات"),1),t("option",ds,l(e(n)("booking.pending")),1),t("option",cs,l(e(n)("booking.confirmed")),1),t("option",rs,l(e(n)("booking.completed")),1),t("option",us,l(e(n)("booking.cancelled")),1)]),_:1},8,["modelValue"])]),_:1}),o(e(y),{md:"3",class:"d-flex align-items-end"},{default:i(()=>[o(e(p),{color:"primary",class:"w-100",onClick:Le},{default:i(()=>[o(e(v),{icon:"cil-filter",class:"me-1"}),m(l(e(n)("common.filter")||"تصفية"),1)]),_:1})]),_:1})]),_:1})])]),I.value==="calendar"?(u(),_("div",ms,[o(et)])):(u(),_("div",vs,[e(r).appointments.loading?(u(),_("div",_s,[o(e(re),{color:"primary"})])):(u(),_("div",fs,[(u(!0),_(N,null,T(e(r).appointments.items,s=>(u(),_("div",{key:s.id,class:"nano-appointment-card"},[t("div",ps,[t("div",bs,l(le(s.start_date,"day")),1),t("div",gs,l(le(s.start_date,"month")),1),t("div",hs,l(le(s.start_date,"time")),1)]),t("div",ks,[t("div",ys,l(pe(s.service_id)),1),t("div",ws,[o(e(v),{icon:"cil-user",class:"me-1"}),m(" "+l(e(n)("booking.with"))+": "+l(ge(s.staff_id)),1)]),s.customer_name?(u(),_("div",Cs,[o(e(v),{icon:"cil-people",class:"me-1"}),m(" "+l(s.customer_name),1)])):j("",!0)]),t("div",Ss,[o(e(U),{color:Ne(s.status),shape:"rounded-pill",class:"px-3 py-2"},{default:i(()=>[m(l(e(n)(`booking.${s.status}`)),1)]),_:2},1032,["color"])]),t("div",xs,[["completed","in_progress"].includes(s.status)?(u(),K(e(p),{key:0,color:"success",variant:"ghost",onClick:f=>Re(s),title:"Checkout"},{default:i(()=>[o(e(v),{icon:"cil-cart"})]),_:1},8,["onClick"])):j("",!0),o(e(p),{color:"info",variant:"ghost",onClick:f=>ye(s)},{default:i(()=>[o(e(v),{icon:"cil-pencil"})]),_:1},8,["onClick"]),o(e(p),{color:"danger",variant:"ghost",onClick:f=>je(s.id)},{default:i(()=>[o(e(v),{icon:"cil-trash"})]),_:1},8,["onClick"])])]))),128))]))]))],512),[[E,M.value==="appointments"]]),P(t("div",Vs,[t("div",Ns,[t("h4",Ts,l(e(n)("booking.analyticsTab")),1)]),t("div",Ms,[t("table",As,[t("thead",null,[t("tr",null,[t("th",$s,l(e(n)("booking.analyticsService")),1),t("th",null,l(e(n)("booking.analyticsDuration")),1),t("th",null,l(e(n)("booking.analyticsPrice")),1),t("th",null,l(e(n)("booking.analyticsAppointments")),1),t("th",Bs,l(e(n)("booking.analyticsRevenue")),1),t("th",null,l(e(n)("booking.analyticsAvgDuration")),1),t("th",null,l(e(n)("booking.analyticsActions")),1)])]),t("tbody",null,[(u(!0),_(N,null,T(_e.value,s=>(u(),_("tr",{key:s.key,class:"nano-table-row"},[t("td",Ds,l(s.serviceName),1),t("td",null,l(be(s.serviceId))+" "+l(e(n)("booking.min")),1),t("td",null,l(q(Ae(s.serviceId))),1),t("td",null,[o(e(U),{color:"primary",shape:"rounded-pill"},{default:i(()=>[m(l(s.total),1)]),_:2},1024)]),t("td",Fs,l(q(s.revenue)),1),t("td",null,l(s.total>0?(s.total*be(s.serviceId)/s.total).toFixed(0):0)+" "+l(e(n)("booking.min")),1),t("td",null,[o(e(p),{size:"sm",color:"primary",variant:"ghost",onClick:f=>Be(s.serviceId)},{default:i(()=>[o(e(v),{icon:"cil-external-link"})]),_:1},8,["onClick"])])]))),128)),t("tr",Us,[t("td",Is,l(e(n)("booking.analyticsTotal")),1),t("td",qs,l(fe.value.total),1),t("td",zs,l(q(fe.value.revenue)),1),a[22]||(a[22]=t("td",{colspan:"2",class:"p-3"},null,-1))])])])])],512),[[E,M.value==="analytics"]])]),o(e(H),{visible:ee.value,onClose:ae,size:"lg",alignment:"center"},{default:i(()=>[o(e(G),null,{default:i(()=>[o(e(W),null,{default:i(()=>[o(e(v),{icon:"cil-spreadsheet",class:"me-2"}),m(l(e(n)("booking.serviceDetails")),1)]),_:1})]),_:1}),V.value?(u(),K(e(X),{key:0},{default:i(()=>[t("div",js,[t("div",Ls,[t("div",Rs,[o(e(v),{icon:"cil-spreadsheet",size:"xl"})]),t("div",null,[t("h3",Ps,l(V.value.title),1),o(e(U),{color:"gold",shape:"rounded-pill",class:"px-3"},{default:i(()=>[m(l(V.value.category_id||"General"),1)]),_:1})])]),t("div",Es,[o(e(y),{md:"4"},{default:i(()=>[t("div",Hs,[t("label",Ks,l(e(n)("booking.duration")),1),t("div",Os,l(V.value.duration)+" "+l(e(n)("booking.minutes")),1)])]),_:1}),o(e(y),{md:"4"},{default:i(()=>[t("div",Gs,[t("label",Ws,l(e(n)("booking.price")),1),t("div",Xs,l(q(V.value.price)),1)])]),_:1}),o(e(y),{md:"4"},{default:i(()=>[t("div",Ys,[t("label",Zs,l(e(n)("booking.analyticsAppointments")),1),t("div",Js,l($e(V.value.id)),1)])]),_:1})])])]),_:1})):j("",!0),o(e(Y),null,{default:i(()=>[o(e(p),{color:"secondary",variant:"ghost",onClick:ae},{default:i(()=>[m(l(e(n)("booking.close")),1)]),_:1}),o(e(p),{color:"primary",class:"nano-btn",onClick:a[7]||(a[7]=()=>{ae(),ne(V.value)})},{default:i(()=>[o(e(v),{icon:"cil-pencil",class:"me-2"}),m(l(e(n)("booking.edit")),1)]),_:1})]),_:1})]),_:1},8,["visible"]),o(e(H),{visible:Z.value,onClose:ie,size:"lg",alignment:"center"},{default:i(()=>[o(e(G),null,{default:i(()=>[o(e(W),null,{default:i(()=>[m(l($.value?e(n)("booking.editService"):e(n)("booking.addService")),1)]),_:1})]),_:1}),o(e(X),null,{default:i(()=>[t("div",Qs,[t("div",eo,[t("label",to,l(e(n)("booking.serviceName"))+" *",1),o(e(C),{modelValue:S.value.title,"onUpdate:modelValue":a[8]||(a[8]=s=>S.value.title=s),required:""},null,8,["modelValue"])]),o(e(z),{class:"g-3"},{default:i(()=>[o(e(y),{md:"6"},{default:i(()=>[t("label",so,l(e(n)("booking.duration"))+" ("+l(e(n)("booking.minutes"))+") *",1),o(e(C),{modelValue:S.value.duration,"onUpdate:modelValue":a[9]||(a[9]=s=>S.value.duration=s),modelModifiers:{number:!0},type:"number",min:"1",required:""},null,8,["modelValue"])]),_:1}),o(e(y),{md:"6"},{default:i(()=>[t("label",oo,l(e(n)("booking.price"))+" *",1),o(e(C),{modelValue:S.value.price,"onUpdate:modelValue":a[10]||(a[10]=s=>S.value.price=s),modelModifiers:{number:!0},type:"number",step:"0.01",min:"0",required:""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),o(e(Y),null,{default:i(()=>[o(e(p),{color:"secondary",variant:"ghost",onClick:ie},{default:i(()=>[m(l(e(n)("booking.cancel")),1)]),_:1}),o(e(p),{color:"primary",class:"nano-btn",onClick:De,disabled:w.value},{default:i(()=>[m(l(w.value?e(n)("booking.saving"):e(n)("booking.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["visible"]),o(e(H),{visible:J.value,onClose:de,size:"lg",alignment:"center"},{default:i(()=>[o(e(G),null,{default:i(()=>[o(e(W),null,{default:i(()=>[m(l(B.value?e(n)("booking.editStaff"):e(n)("booking.addStaff")),1)]),_:1})]),_:1}),o(e(X),null,{default:i(()=>[t("div",lo,[t("div",ao,[t("label",no,l(e(n)("booking.fullName"))+" *",1),o(e(C),{modelValue:x.value.full_name,"onUpdate:modelValue":a[11]||(a[11]=s=>x.value.full_name=s),required:""},null,8,["modelValue"])]),t("div",io,[t("label",co,l(e(n)("booking.email"))+" *",1),o(e(C),{modelValue:x.value.email,"onUpdate:modelValue":a[12]||(a[12]=s=>x.value.email=s),type:"email",required:""},null,8,["modelValue"])]),t("div",ro,[t("label",uo,l(e(n)("booking.phone")),1),o(e(C),{modelValue:x.value.phone,"onUpdate:modelValue":a[13]||(a[13]=s=>x.value.phone=s),type:"tel"},null,8,["modelValue"])])])]),_:1}),o(e(Y),null,{default:i(()=>[o(e(p),{color:"secondary",variant:"ghost",onClick:de},{default:i(()=>[m(l(e(n)("booking.cancel")),1)]),_:1}),o(e(p),{color:"primary",class:"nano-btn",onClick:Ue,disabled:w.value},{default:i(()=>[m(l(w.value?e(n)("booking.saving"):e(n)("booking.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["visible"]),o(e(H),{visible:Q.value,onClose:ce,size:"lg",alignment:"center"},{default:i(()=>[o(e(G),null,{default:i(()=>[o(e(W),null,{default:i(()=>[m(l(D.value?e(n)("booking.editBooking")||"تعديل الحجز":e(n)("booking.addBooking")||"إضافة حجز"),1)]),_:1})]),_:1}),o(e(X),null,{default:i(()=>[t("div",mo,[o(e(z),{class:"g-3 mb-3"},{default:i(()=>[o(e(y),{md:"8"},{default:i(()=>[t("label",vo,l(e(n)("invoices.customer")||"Customer")+" *",1),o(e(C),{modelValue:se.value,"onUpdate:modelValue":a[14]||(a[14]=s=>se.value=s),type:"text",placeholder:e(n)("common.search")||"Search...",onInput:Me,class:"mb-2"},null,8,["modelValue","placeholder"]),o(e(L),{modelValue:b.value.customer_id,"onUpdate:modelValue":a[15]||(a[15]=s=>b.value.customer_id=s),modelModifiers:{number:!0},required:""},{default:i(()=>[t("option",_o,l(e(n)("common.select")||"Select..."),1),te.value?(u(),_("option",fo,l(e(n)("common.loading")||"جاري التحميل..."),1)):j("",!0),(u(!0),_(N,null,T(F.value,s=>(u(),_("option",{key:s.id,value:Number(s.id)},l(s.name||"—")+l(s.phone?` (${s.phone})`:""),9,po))),128))]),_:1},8,["modelValue"])]),_:1}),o(e(y),{md:"4"},{default:i(()=>[t("label",bo,l(e(n)("common.status")||"الحالة"),1),o(e(L),{modelValue:b.value.status,"onUpdate:modelValue":a[16]||(a[16]=s=>b.value.status=s)},{default:i(()=>[t("option",go,l(e(n)("booking.pending")),1),t("option",ho,l(e(n)("booking.confirmed")),1),t("option",ko,l(e(n)("booking.completed")),1),t("option",yo,l(e(n)("booking.cancelled")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(e(z),{class:"g-3 mb-3"},{default:i(()=>[o(e(y),{md:"6"},{default:i(()=>[t("label",wo,l(e(n)("booking.service")||"الخدمة")+" *",1),o(e(L),{modelValue:b.value.service_id,"onUpdate:modelValue":a[17]||(a[17]=s=>b.value.service_id=s),modelModifiers:{number:!0},required:""},{default:i(()=>[t("option",Co,l(e(n)("booking.selectService")||"اختر الخدمة..."),1),(u(!0),_(N,null,T(e(r).services.items,s=>(u(),_("option",{key:s.id,value:Number(s.id)},l(s.title),9,So))),128))]),_:1},8,["modelValue"])]),_:1}),o(e(y),{md:"6"},{default:i(()=>[t("label",xo,l(e(n)("booking.staff")||"الموظفة"),1),o(e(L),{modelValue:b.value.staff_id,"onUpdate:modelValue":a[18]||(a[18]=s=>b.value.staff_id=s),modelModifiers:{number:!0}},{default:i(()=>[t("option",Vo,l(e(n)("booking.any")||"أي موظفة"),1),(u(!0),_(N,null,T(e(r).staff.items,s=>(u(),_("option",{key:s.id,value:Number(s.id)},l(s.full_name),9,No))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(e(z),{class:"g-3 mb-3"},{default:i(()=>[o(e(y),{md:"6"},{default:i(()=>[t("label",To,l(e(n)("common.date")||"التاريخ")+" *",1),o(e(C),{modelValue:b.value.booking_date,"onUpdate:modelValue":a[19]||(a[19]=s=>b.value.booking_date=s),type:"date",required:""},null,8,["modelValue"])]),_:1}),o(e(y),{md:"6"},{default:i(()=>[t("label",Mo,l(e(n)("common.time")||"الوقت")+" *",1),o(e(C),{modelValue:b.value.booking_time,"onUpdate:modelValue":a[20]||(a[20]=s=>b.value.booking_time=s),type:"time",required:""},null,8,["modelValue"])]),_:1})]),_:1}),t("div",Ao,[t("label",$o,l(e(n)("common.notes")||"ملاحظات"),1),o(e(Ye),{modelValue:b.value.notes,"onUpdate:modelValue":a[21]||(a[21]=s=>b.value.notes=s),rows:"3",placeholder:e(n)("common.optionalNotes")||"ملاحظات اختيارية..."},null,8,["modelValue","placeholder"])])])]),_:1}),o(e(Y),null,{default:i(()=>[o(e(p),{color:"secondary",variant:"ghost",onClick:ce},{default:i(()=>[m(l(e(n)("booking.cancel")),1)]),_:1}),o(e(p),{color:"primary",class:"nano-btn",onClick:ze,disabled:w.value},{default:i(()=>[m(l(w.value?e(n)("booking.saving"):e(n)("booking.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["visible"]),o(tt,{"page-key":"booking"})])}}},Go=ot(Bo,[["__scopeId","data-v-1c10ed0c"]]);export{Go as default};
