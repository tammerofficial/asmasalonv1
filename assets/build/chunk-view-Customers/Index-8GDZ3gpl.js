import{f as _,j as W,c as g,o as b,b as t,d as s,t as o,u as e,w as n,Y as A,x as p,C as d,$ as D,h as L,a as X,F as Y,g as J,ae as O,a0 as Q,l as Z,P as w,n as B,a2 as f,aa as ee,ab as te,a3 as I,a4 as P,X as M,a5 as se,a6 as ae,a7 as oe,a8 as le}from"../chunk-vendor-vue-VAxhpvd9.js";import{u as ne,a as S}from"../chunk-component-NotificationsBell-CTLJWkW4.js";import{u as ie}from"../chunk-view-AppleWallet/Simulator-BwS6bEkK.js";import{E as ce}from"../chunk-component-EmptyState-DXFewvrN.js";import{H as de}from"../chunk-component-HelpSection-NeetTt3d.js";import{_ as re}from"../chunk-component-Card-DPM96EeB.js";import"../chunk-vendor-Ltsl4QyH.js";import"../chunk-vendor-pinia-CjQxP09R.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-PageHeader-CMYNL4hu.js";const ue={class:"customers-page p-4"},me={class:"pos-header-top d-flex justify-content-between align-items-center mb-4"},ve={class:"header-left d-flex align-items-center gap-3"},_e={class:"mb-0 fw-bold text-primary"},pe={class:"header-right d-flex gap-2"},fe={class:"nano-stats-bar mb-4"},he={class:"stat-icon-bg customers"},ge={class:"stat-info"},be={class:"stat-value"},Ce={class:"stat-label"},ye={class:"stat-card-nano"},we={class:"stat-icon-bg visits"},Ve={class:"stat-info"},xe={class:"stat-value text-info"},ke={class:"stat-label"},Se={class:"stat-card-nano"},$e={class:"stat-icon-bg spending"},Te={class:"stat-info"},Fe={class:"stat-value text-success"},Ie={class:"stat-label"},Pe={class:"stat-card-nano"},Me={class:"stat-icon-bg points"},Ne={class:"stat-info"},Ue={class:"stat-value text-warning"},De={class:"stat-label"},Be={class:"nano-filters-bar p-3 bg-secondary rounded-4 mb-4 shadow-sm border border-light"},ze={value:""},je={value:"active"},He={value:"inactive"},qe={value:""},Ee={value:"male"},Ge={value:"female"},Re={class:"nano-panel"},Ke={key:0,class:"text-center p-5"},We={key:1,class:"text-center p-5"},Ae={key:2},Le={class:"nano-grid"},Xe=["onClick"],Ye={class:"customer-avatar-main"},Je={class:"customer-main-info mt-3 text-center"},Oe={class:"fw-bold mb-1"},Qe={class:"text-muted small mb-3"},Ze={class:"customer-stats-row d-flex justify-content-between border-top pt-3"},et={class:"stat"},tt={class:"label"},st={class:"value text-warning fw-bold"},at={class:"stat"},ot={class:"label"},lt={class:"value text-success fw-bold"},nt={class:"customer-actions-hover mt-3"},it={key:0,class:"d-flex justify-content-center mt-5"},ct={class:"form-label fw-bold"},dt={class:"form-label fw-bold"},rt={class:"form-label fw-bold"},ut={class:"form-label fw-bold"},mt={value:"active"},vt={value:"inactive"},_t={__name:"Index",setup(pt){const{t:a}=ne(),V=ie(),N=Z(),x=_(!1),$=_(!1),T=_([]),h=_({total:0,active:0,inactive:0,totalVisits:0,totalSpending:0,totalPoints:0}),m=_({current_page:1,per_page:12,total:0,total_pages:0}),v=_({search:"",status:"",gender:""}),C=_(!1),F=_(null),r=_({name:"",phone:"",email:"",gender:"female",status:"active"}),u=async()=>{var c,i;x.value=!0;try{const l=await S.get("/customers",{params:{page:m.value.current_page,per_page:m.value.per_page,...v.value}}),k=((c=l.data)==null?void 0:c.data)||l.data;T.value=k.items||[],m.value=k.pagination||m.value;const y=await S.get("/customers/stats");h.value=((i=y.data)==null?void 0:i.data)||y.data||h.value}catch(l){console.error("Failed to load customers:",l)}finally{x.value=!1}},z=()=>{clearTimeout(window.searchTimer),window.searchTimer=setTimeout(()=>{m.value.current_page=1,u()},500)},j=()=>{v.value={search:"",status:"",gender:""},u()},H=c=>{m.value.current_page=c,u()},q=c=>{F.value=c,r.value={...c},C.value=!0},E=async()=>{$.value=!0;try{F.value?(await S.put(`/customers/${F.value.id}`,r.value),V.success(a("customers.updated"))):(await S.post("/customers",r.value),V.success(a("customers.added"))),C.value=!1,u()}catch{V.error(a("customers.failedToSave"))}finally{$.value=!1}},G=async c=>{if(confirm(a("customers.confirmDelete",{name:c.name})))try{await S.delete(`/customers/${c.id}`),V.success(a("customers.deleted")),u()}catch{V.error(a("customers.failedToDelete"))}},R=c=>{N.push(`/customers/${c.id}`)},K=c=>{N.push({path:"/pos",query:{customer_id:c.id,tab:"history"}})},U=c=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",notation:"compact",minimumFractionDigits:1}).format(c||0);return W(()=>{u()}),(c,i)=>(b(),g("div",ue,[t("div",me,[t("div",ve,[t("h2",_e,o(e(a)("customers.title")),1),s(e(A),{color:"gold",shape:"rounded-pill",class:"px-3 py-2 fw-bold text-dark"},{default:n(()=>[s(e(d),{icon:"cil-people",class:"me-1"}),w(" "+o(h.value.total||T.value.length)+" "+o(e(a)("customers.title")),1)]),_:1})]),t("div",pe,[s(e(p),{color:"primary",class:"nano-btn",onClick:i[0]||(i[0]=l=>C.value=!0)},{default:n(()=>[s(e(d),{icon:"cil-plus",class:"me-2"}),w(" "+o(e(a)("customers.addNew")),1)]),_:1}),s(e(p),{color:"secondary",variant:"ghost",onClick:u,disabled:x.value},{default:n(()=>[s(e(d),{icon:"cil-reload",class:B({spinning:x.value})},null,8,["class"])]),_:1},8,["disabled"])])]),t("div",fe,[t("div",{class:"stat-card-nano clickable",onClick:i[1]||(i[1]=l=>{v.value.status="active",u()})},[t("div",he,[s(e(d),{icon:"cil-people"})]),t("div",ge,[t("div",be,o(h.value.active||0),1),t("div",Ce,o(e(a)("status.active"))+" "+o(e(a)("customers.title")),1)])]),t("div",ye,[t("div",we,[s(e(d),{icon:"cil-calendar-check"})]),t("div",Ve,[t("div",xe,o(h.value.totalVisits||0),1),t("div",ke,o(e(a)("customers.totalVisits")),1)])]),t("div",Se,[t("div",$e,[s(e(d),{icon:"cil-money"})]),t("div",Te,[t("div",Fe,o(U(h.value.totalSpending||0)),1),t("div",Ie,o(e(a)("customers.totalSpending")),1)])]),t("div",Pe,[t("div",Me,[s(e(d),{icon:"cil-star"})]),t("div",Ne,[t("div",Ue,o(h.value.totalPoints||0),1),t("div",De,o(e(a)("customers.totalPoints")),1)])])]),t("div",Be,[s(e(D),{class:"g-3 align-items-center"},{default:n(()=>[s(e(f),{md:"4"},{default:n(()=>[s(e(ee),null,{default:n(()=>[s(e(te),{class:"bg-transparent border-0"},{default:n(()=>[s(e(d),{icon:"cil-magnifying-glass"})]),_:1}),s(e(I),{modelValue:v.value.search,"onUpdate:modelValue":i[2]||(i[2]=l=>v.value.search=l),placeholder:e(a)("customers.searchPlaceholder"),onInput:z,class:"border-0 bg-transparent"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),s(e(f),{md:"3"},{default:n(()=>[s(e(P),{modelValue:v.value.status,"onUpdate:modelValue":i[3]||(i[3]=l=>v.value.status=l),onChange:u,class:"rounded-3"},{default:n(()=>[t("option",ze,o(e(a)("customers.allStatuses")),1),t("option",je,o(e(a)("status.active")),1),t("option",He,o(e(a)("status.inactive")),1)]),_:1},8,["modelValue"])]),_:1}),s(e(f),{md:"3"},{default:n(()=>[s(e(P),{modelValue:v.value.gender,"onUpdate:modelValue":i[4]||(i[4]=l=>v.value.gender=l),onChange:u,class:"rounded-3"},{default:n(()=>[t("option",qe,o(e(a)("customers.allGenders")),1),t("option",Ee,o(e(a)("customers.male")),1),t("option",Ge,o(e(a)("customers.female")),1)]),_:1},8,["modelValue"])]),_:1}),s(e(f),{md:"2"},{default:n(()=>[s(e(p),{color:"primary",variant:"ghost",class:"w-100",onClick:j},{default:n(()=>[s(e(d),{icon:"cil-filter-x",class:"me-1"}),w(o(e(a)("common.reset")),1)]),_:1})]),_:1})]),_:1})]),t("div",Re,[x.value?(b(),g("div",Ke,[s(e(L),{color:"primary"})])):T.value.length===0?(b(),g("div",We,[s(ce,{title:e(a)("common.noData"),description:e(a)("customers.title")},null,8,["title","description"])])):(b(),g("div",Ae,[t("div",Le,[(b(!0),g(Y,null,J(T.value,l=>{var k;return b(),g("div",{key:l.id,class:"customer-nano-card",onClick:y=>R(l)},[t("div",{class:B(["customer-badge-status",l.status])},null,2),t("div",Ye,o((k=l.name)==null?void 0:k.charAt(0)),1),t("div",Je,[t("h5",Oe,o(l.name),1),t("p",Qe,o(l.phone||e(a)("common.noPhone")),1)]),t("div",Ze,[t("div",et,[t("span",tt,o(e(a)("loyalty.points")),1),t("span",st,o(l.points||0),1)]),t("div",at,[t("span",ot,o(e(a)("customers.wallet")),1),t("span",lt,o(U(l.wallet_balance||0)),1)])]),t("div",nt,[s(e(p),{size:"sm",color:"info",variant:"ghost",onClick:M(y=>q(l),["stop"])},{default:n(()=>[s(e(d),{icon:"cil-pencil"})]),_:1},8,["onClick"]),s(e(p),{size:"sm",color:"primary",variant:"ghost",onClick:M(y=>K(l),["stop"])},{default:n(()=>[s(e(d),{icon:"cil-history"})]),_:1},8,["onClick"]),s(e(p),{size:"sm",color:"danger",variant:"ghost",onClick:M(y=>G(l),["stop"])},{default:n(()=>[s(e(d),{icon:"cil-trash"})]),_:1},8,["onClick"])])],8,Xe)}),128))]),m.value.total_pages>1?(b(),g("div",it,[s(e(O),{pages:m.value.total_pages,"active-page":m.value.current_page,"onUpdate:activePage":H},null,8,["pages","active-page"])])):X("",!0)]))]),s(e(Q),{visible:C.value,onClose:i[10]||(i[10]=l=>C.value=!1),size:"lg",alignment:"center"},{default:n(()=>[s(e(se),null,{default:n(()=>[s(e(ae),null,{default:n(()=>[w(o(F.value?e(a)("customers.edit"):e(a)("customers.addNew")),1)]),_:1})]),_:1}),s(e(oe),{class:"p-4"},{default:n(()=>[s(e(D),{class:"g-3"},{default:n(()=>[s(e(f),{md:"6"},{default:n(()=>[t("label",ct,o(e(a)("customers.fullName"))+" *",1),s(e(I),{modelValue:r.value.name,"onUpdate:modelValue":i[5]||(i[5]=l=>r.value.name=l),required:""},null,8,["modelValue"])]),_:1}),s(e(f),{md:"6"},{default:n(()=>[t("label",dt,o(e(a)("customers.phone"))+" *",1),s(e(I),{modelValue:r.value.phone,"onUpdate:modelValue":i[6]||(i[6]=l=>r.value.phone=l),type:"tel",required:""},null,8,["modelValue"])]),_:1}),s(e(f),{md:"6"},{default:n(()=>[t("label",rt,o(e(a)("customers.email")),1),s(e(I),{modelValue:r.value.email,"onUpdate:modelValue":i[7]||(i[7]=l=>r.value.email=l),type:"email"},null,8,["modelValue"])]),_:1}),s(e(f),{md:"6"},{default:n(()=>[t("label",ut,o(e(a)("common.status")),1),s(e(P),{modelValue:r.value.status,"onUpdate:modelValue":i[8]||(i[8]=l=>r.value.status=l)},{default:n(()=>[t("option",mt,o(e(a)("status.active")),1),t("option",vt,o(e(a)("status.inactive")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(e(le),null,{default:n(()=>[s(e(p),{color:"secondary",variant:"ghost",onClick:i[9]||(i[9]=l=>C.value=!1)},{default:n(()=>[w(o(e(a)("common.cancel")),1)]),_:1}),s(e(p),{color:"primary",class:"nano-btn",onClick:E,disabled:$.value},{default:n(()=>[w(o($.value?e(a)("common.saving"):e(a)("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["visible"]),s(de,{"page-key":"customers"})]))}},St=re(_t,[["__scopeId","data-v-724aaff5"]]);export{St as default};
