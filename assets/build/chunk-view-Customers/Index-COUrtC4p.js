import{f as p,j as A,c as b,o as h,b as t,d as s,t as n,u as e,w as l,Y as K,x as _,C as r,$ as B,h as L,a as X,F as Y,g as J,ae as O,a0 as Q,l as Z,P as w,n as D,a2 as f,aa as ee,ab as te,a3 as I,a4 as P,X as N,a5 as se,a6 as ae,a7 as oe,a8 as le}from"../chunk-vendor-vue-BKzcbwC-.js";import{u as ne,a as $}from"../chunk-component-NotificationsBell-CyBx4swB.js";import{u as ie}from"../chunk-view-AppleWallet/Simulator-WLH8OaYC.js";import{E as de}from"../chunk-component-EmptyState-QeIH5i51.js";import{H as re}from"../chunk-component-HelpSection-B1vxldAY.js";import{_ as ce}from"../chunk-component-Card-D7ddNvJz.js";import"../chunk-vendor-Ltsl4QyH.js";import"../chunk-vendor-pinia-CsGkbfJ3.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-PageHeader-CI_3JpQM.js";const ue={class:"customers-page p-4"},me={class:"pos-header-top d-flex justify-content-between align-items-center mb-4"},ve={class:"header-left d-flex align-items-center gap-3"},pe={class:"mb-0 fw-bold text-primary"},_e={class:"header-right d-flex gap-2"},fe={class:"nano-stats-bar mb-4"},ge={class:"stat-icon-bg customers"},be={class:"stat-info"},he={class:"stat-value"},Ce={class:"stat-label"},ye={class:"stat-card-nano"},we={class:"stat-icon-bg visits"},Ve={class:"stat-info"},xe={class:"stat-value text-info"},ke={class:"stat-card-nano"},$e={class:"stat-icon-bg spending"},Fe={class:"stat-info"},Se={class:"stat-value text-success"},Te={class:"stat-card-nano"},Ie={class:"stat-icon-bg points"},Pe={class:"stat-info"},Ne={class:"stat-value text-warning"},Me={class:"nano-filters-bar p-3 bg-secondary rounded-4 mb-4 shadow-sm border border-light"},Ue={value:""},Be={value:"active"},De={value:"inactive"},ze={value:""},je={value:"male"},Ee={value:"female"},He={class:"nano-panel"},qe={key:0,class:"text-center p-5"},Ge={key:1,class:"text-center p-5"},Re={key:2},We={class:"nano-grid"},Ae=["onClick"],Ke={class:"customer-avatar-main"},Le={class:"customer-main-info mt-3 text-center"},Xe={class:"fw-bold mb-1"},Ye={class:"text-muted small mb-3"},Je={class:"customer-stats-row d-flex justify-content-between border-top pt-3"},Oe={class:"stat"},Qe={class:"value text-warning fw-bold"},Ze={class:"stat"},et={class:"value text-success fw-bold"},tt={class:"customer-actions-hover mt-3"},st={key:0,class:"d-flex justify-content-center mt-5"},at={__name:"Index",setup(ot){const{t:i}=ne(),V=ie(),M=Z(),x=p(!1),F=p(!1),S=p([]),g=p({total:0,active:0,inactive:0,totalVisits:0,totalSpending:0,totalPoints:0}),m=p({current_page:1,per_page:12,total:0,total_pages:0}),v=p({search:"",status:"",gender:""}),C=p(!1),T=p(null),c=p({name:"",phone:"",email:"",gender:"female",status:"active"}),u=async()=>{var d,a;x.value=!0;try{const o=await $.get("/customers",{params:{page:m.value.current_page,per_page:m.value.per_page,...v.value}}),k=((d=o.data)==null?void 0:d.data)||o.data;S.value=k.items||[],m.value=k.pagination||m.value;const y=await $.get("/customers/stats");g.value=((a=y.data)==null?void 0:a.data)||y.data||g.value}catch(o){console.error("Failed to load customers:",o)}finally{x.value=!1}},z=()=>{clearTimeout(window.searchTimer),window.searchTimer=setTimeout(()=>{m.value.current_page=1,u()},500)},j=()=>{v.value={search:"",status:"",gender:""},u()},E=d=>{m.value.current_page=d,u()},H=d=>{T.value=d,c.value={...d},C.value=!0},q=async()=>{F.value=!0;try{T.value?(await $.put(`/customers/${T.value.id}`,c.value),V.success("Customer updated")):(await $.post("/customers",c.value),V.success("Customer added")),C.value=!1,u()}catch{V.error("Failed to save customer")}finally{F.value=!1}},G=async d=>{if(confirm(`Delete customer ${d.name}?`))try{await $.delete(`/customers/${d.id}`),V.success("Customer deleted"),u()}catch{V.error("Failed to delete customer")}},R=d=>{M.push(`/customers/${d.id}`)},W=d=>{M.push({path:"/pos",query:{customer_id:d.id,tab:"history"}})},U=d=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",notation:"compact",minimumFractionDigits:1}).format(d||0);return A(()=>{u()}),(d,a)=>(h(),b("div",ue,[t("div",me,[t("div",ve,[t("h2",pe,n(e(i)("customers.title")),1),s(e(K),{color:"gold",shape:"rounded-pill",class:"px-3 py-2 fw-bold text-dark"},{default:l(()=>[s(e(r),{icon:"cil-people",class:"me-1"}),w(" "+n(g.value.total||S.value.length)+" "+n(e(i)("customers.title")),1)]),_:1})]),t("div",_e,[s(e(_),{color:"primary",class:"nano-btn",onClick:a[0]||(a[0]=o=>C.value=!0)},{default:l(()=>[s(e(r),{icon:"cil-plus",class:"me-2"}),w(" "+n(e(i)("customers.addNew")),1)]),_:1}),s(e(_),{color:"secondary",variant:"ghost",onClick:u,disabled:x.value},{default:l(()=>[s(e(r),{icon:"cil-reload",class:D({spinning:x.value})},null,8,["class"])]),_:1},8,["disabled"])])]),t("div",fe,[t("div",{class:"stat-card-nano clickable",onClick:a[1]||(a[1]=o=>{v.value.status="active",u()})},[t("div",ge,[s(e(r),{icon:"cil-people"})]),t("div",be,[t("div",he,n(g.value.active||0),1),t("div",Ce,n(e(i)("status.active"))+" "+n(e(i)("customers.title")),1)])]),t("div",ye,[t("div",we,[s(e(r),{icon:"cil-calendar-check"})]),t("div",Ve,[t("div",xe,n(g.value.totalVisits||0),1),a[11]||(a[11]=t("div",{class:"stat-label"},"Total Visits",-1))])]),t("div",ke,[t("div",$e,[s(e(r),{icon:"cil-money"})]),t("div",Fe,[t("div",Se,n(U(g.value.totalSpending||0)),1),a[12]||(a[12]=t("div",{class:"stat-label"},"Total Spending",-1))])]),t("div",Te,[t("div",Ie,[s(e(r),{icon:"cil-star"})]),t("div",Pe,[t("div",Ne,n(g.value.totalPoints||0),1),a[13]||(a[13]=t("div",{class:"stat-label"},"Total Points",-1))])])]),t("div",Me,[s(e(B),{class:"g-3 align-items-center"},{default:l(()=>[s(e(f),{md:"4"},{default:l(()=>[s(e(ee),null,{default:l(()=>[s(e(te),{class:"bg-transparent border-0"},{default:l(()=>[s(e(r),{icon:"cil-magnifying-glass"})]),_:1}),s(e(I),{modelValue:v.value.search,"onUpdate:modelValue":a[2]||(a[2]=o=>v.value.search=o),placeholder:e(i)("customers.searchPlaceholder"),onInput:z,class:"border-0 bg-transparent"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),s(e(f),{md:"3"},{default:l(()=>[s(e(P),{modelValue:v.value.status,"onUpdate:modelValue":a[3]||(a[3]=o=>v.value.status=o),onChange:u,class:"rounded-3"},{default:l(()=>[t("option",Ue,n(e(i)("customers.allStatuses")),1),t("option",Be,n(e(i)("status.active")),1),t("option",De,n(e(i)("status.inactive")),1)]),_:1},8,["modelValue"])]),_:1}),s(e(f),{md:"3"},{default:l(()=>[s(e(P),{modelValue:v.value.gender,"onUpdate:modelValue":a[4]||(a[4]=o=>v.value.gender=o),onChange:u,class:"rounded-3"},{default:l(()=>[t("option",ze,n(e(i)("customers.allGenders")),1),t("option",je,n(e(i)("customers.male")),1),t("option",Ee,n(e(i)("customers.female")),1)]),_:1},8,["modelValue"])]),_:1}),s(e(f),{md:"2"},{default:l(()=>[s(e(_),{color:"primary",variant:"ghost",class:"w-100",onClick:j},{default:l(()=>[s(e(r),{icon:"cil-filter-x",class:"me-1"}),w(n(e(i)("common.reset")),1)]),_:1})]),_:1})]),_:1})]),t("div",He,[x.value?(h(),b("div",qe,[s(e(L),{color:"primary"})])):S.value.length===0?(h(),b("div",Ge,[s(de,{title:e(i)("common.noData"),description:e(i)("customers.title")},null,8,["title","description"])])):(h(),b("div",Re,[t("div",We,[(h(!0),b(Y,null,J(S.value,o=>{var k;return h(),b("div",{key:o.id,class:"customer-nano-card",onClick:y=>R(o)},[t("div",{class:D(["customer-badge-status",o.status])},null,2),t("div",Ke,n((k=o.name)==null?void 0:k.charAt(0)),1),t("div",Le,[t("h5",Xe,n(o.name),1),t("p",Ye,n(o.phone||"No phone"),1)]),t("div",Je,[t("div",Oe,[a[14]||(a[14]=t("span",{class:"label"},"Points",-1)),t("span",Qe,n(o.points||0),1)]),t("div",Ze,[a[15]||(a[15]=t("span",{class:"label"},"Wallet",-1)),t("span",et,n(U(o.wallet_balance||0)),1)])]),t("div",tt,[s(e(_),{size:"sm",color:"info",variant:"ghost",onClick:N(y=>H(o),["stop"])},{default:l(()=>[s(e(r),{icon:"cil-pencil"})]),_:1},8,["onClick"]),s(e(_),{size:"sm",color:"primary",variant:"ghost",onClick:N(y=>W(o),["stop"])},{default:l(()=>[s(e(r),{icon:"cil-history"})]),_:1},8,["onClick"]),s(e(_),{size:"sm",color:"danger",variant:"ghost",onClick:N(y=>G(o),["stop"])},{default:l(()=>[s(e(r),{icon:"cil-trash"})]),_:1},8,["onClick"])])],8,Ae)}),128))]),m.value.total_pages>1?(h(),b("div",st,[s(e(O),{pages:m.value.total_pages,"active-page":m.value.current_page,"onUpdate:activePage":E},null,8,["pages","active-page"])])):X("",!0)]))]),s(e(Q),{visible:C.value,onClose:a[10]||(a[10]=o=>C.value=!1),size:"lg",alignment:"center"},{default:l(()=>[s(e(se),null,{default:l(()=>[s(e(ae),null,{default:l(()=>[w(n(T.value?e(i)("customers.edit"):e(i)("customers.addNew")),1)]),_:1})]),_:1}),s(e(oe),{class:"p-4"},{default:l(()=>[s(e(B),{class:"g-3"},{default:l(()=>[s(e(f),{md:"6"},{default:l(()=>[a[16]||(a[16]=t("label",{class:"form-label fw-bold"},"Name *",-1)),s(e(I),{modelValue:c.value.name,"onUpdate:modelValue":a[5]||(a[5]=o=>c.value.name=o),required:""},null,8,["modelValue"])]),_:1}),s(e(f),{md:"6"},{default:l(()=>[a[17]||(a[17]=t("label",{class:"form-label fw-bold"},"Phone *",-1)),s(e(I),{modelValue:c.value.phone,"onUpdate:modelValue":a[6]||(a[6]=o=>c.value.phone=o),type:"tel",required:""},null,8,["modelValue"])]),_:1}),s(e(f),{md:"6"},{default:l(()=>[a[18]||(a[18]=t("label",{class:"form-label fw-bold"},"Email",-1)),s(e(I),{modelValue:c.value.email,"onUpdate:modelValue":a[7]||(a[7]=o=>c.value.email=o),type:"email"},null,8,["modelValue"])]),_:1}),s(e(f),{md:"6"},{default:l(()=>[a[20]||(a[20]=t("label",{class:"form-label fw-bold"},"Status",-1)),s(e(P),{modelValue:c.value.status,"onUpdate:modelValue":a[8]||(a[8]=o=>c.value.status=o)},{default:l(()=>[...a[19]||(a[19]=[t("option",{value:"active"},"Active",-1),t("option",{value:"inactive"},"Inactive",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(e(le),null,{default:l(()=>[s(e(_),{color:"secondary",variant:"ghost",onClick:a[9]||(a[9]=o=>C.value=!1)},{default:l(()=>[w(n(e(i)("common.cancel")),1)]),_:1}),s(e(_),{color:"primary",class:"nano-btn",onClick:q,disabled:F.value},{default:l(()=>[w(n(F.value?e(i)("common.saving"):e(i)("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["visible"]),s(re,{"page-key":"customers"})]))}},_t=ce(at,[["__scopeId","data-v-6854dd8b"]]);export{_t as default};
