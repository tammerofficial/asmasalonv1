import{f as p,g as C,i as le,w as ce,c as _,o as u,d as n,b as i,p as l,u as e,h as de,v as y,O as g,C as c,t as r,q as k,ac as ue,ad as j,F as z,k as H,X as Q,n as J}from"./chunk-vendor-vue-DxcSX1Jd.js";import{u as ve,a as E,c as be}from"./chunk-component-NotificationsBell-eCwis6PW.js";import{C as me,a as ge,b as he,P as pe,c as _e,A as ke,p as fe,d as ye,i as Ce}from"./chunk-vendor-charts-CNHMDSF7.js";import{P as qe}from"./chunk-component-PageHeader-BsA6C9en.js";import{S as f}from"./chunk-component-StatCard-AHk13FwB.js";import{_ as we,C as L}from"./chunk-component-Card-BWbCGpFM.js";import{E as X}from"./chunk-component-EmptyState-B78c8qVh.js";import{L as x}from"./chunk-component-LoadingSpinner-PYO1Yq7-.js";import{a as $e}from"./chunk-view-Bookings/BookingAppearance-CtCwBfZ1.js";import{u as Se}from"./chunk-component-Sidebar-DOq58Wm8.js";import"./chunk-vendor-BwxB3d-x.js";import"./chunk-vendor-pinia-DRDRCEXO.js";import"./chunk-vendor-axios-B9ygI19o.js";import"./chunk-view-Bookings/BookingFormPreview-BJuYIHYB.js";const De={class:"asmaa-salon-dashboard"},Be={class:"stats-grid"},Ae={key:1,class:"charts-grid"},Le={class:"chart-panel"},Re={class:"chart-title"},Te={class:"chart-canvas"},We={class:"chart-panel"},Oe={class:"chart-title"},Ee={class:"chart-canvas chart-canvas-sm"},xe={class:"chart-panel"},Ne={class:"chart-title"},Ie={class:"chart-canvas chart-canvas-sm"},Pe={class:"content-grid"},Fe={key:2,class:"bookings-list-modern"},Ke=["onClick"],Me={class:"booking-number"},Ue={class:"booking-details-modern"},Ve={class:"booking-customer-name"},je={class:"booking-meta-modern"},ze={class:"booking-time-modern"},He={key:2,class:"queue-list-modern"},Qe={class:"queue-info-modern"},Je={class:"queue-customer-name"},Xe={class:"queue-service-modern"},Ge={class:"quick-actions-grid"},Ye={class:"quick-action-icon blue"},Ze={class:"quick-action-content"},ea={class:"quick-action-title"},aa={class:"quick-action-desc"},oa={class:"quick-action-icon green"},sa={class:"quick-action-content"},ta={class:"quick-action-title"},na={class:"quick-action-desc"},ia={class:"quick-action-icon purple"},ra={class:"quick-action-content"},la={class:"quick-action-title"},ca={class:"quick-action-desc"},da={class:"quick-action-icon pink"},ua={class:"quick-action-content"},va={class:"quick-action-title"},ba={class:"quick-action-desc"},ma={__name:"Dashboard",setup(ga){de();const{t:o}=ve(),R=$e(),N=p(!1),T=p(!1),W=p(!1),O=p(!1),b=p({customers:0,bookingsToday:0,monthlyRevenue:0,activeStaff:0,totalServices:0,pendingOrders:0,unpaidInvoices:0,queueWaiting:0}),q=p([]),w=p([]),h=p({sales_last_7_days:{labels:[],orders:[],revenue:[]},bookings_status_last_30_days:{pending:0,confirmed:0,completed:0,cancelled:0},invoices_status:{}}),$=p("charts-0"),G=s=>{if(!s&&s!==0)return"0 KWD";const a=parseFloat(s);return a>=1e3?`${(a/1e3).toFixed(1)}K KWD`:`${a.toFixed(0)} KWD`},Y=s=>({pending:o("bookings.pending"),confirmed:o("bookings.confirmed"),completed:o("bookings.completed"),cancelled:o("bookings.cancelled")})[s]||s,Z=s=>({pending:"warning",confirmed:"info",completed:"success",cancelled:"danger"})[s]||"info",ee=s=>{if(!s)return"-";const a=String(s);try{if(a.includes("T")||a.includes("-"))return new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});const t=a.length===5?`${a}:00`:a;return new Date(`1970-01-01T${t}`).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return a}},ae=()=>{const s={exported_at:new Date().toISOString(),stats:b.value,recent_bookings:q.value,queue:w.value},a=JSON.stringify(s,null,2),t=new Blob([a],{type:"application/json;charset=utf-8"}),v=URL.createObjectURL(t),m=document.createElement("a");m.href=v,m.download=`asmaa-salon-dashboard-${new Date().toISOString().slice(0,19).replace(/[:T]/g,"-")}.json`,document.body.appendChild(m),m.click(),m.remove(),URL.revokeObjectURL(v),R.success("✅ Exported dashboard snapshot")},oe=async()=>{N.value=!0;try{be(),await I(),await K(),await M(),R.success("✅ Dashboard refreshed")}catch(s){console.error("Error refreshing data:",s),R.error("❌ Failed to refresh dashboard")}finally{N.value=!1}},I=async()=>{var s;O.value=!0;try{const a=await E.get("/reports/dashboard",{noCache:!0}),t=((s=a.data)==null?void 0:s.data)||a.data||{};b.value={...b.value,...t||{}},t!=null&&t.charts&&(h.value={sales_last_7_days:t.charts.sales_last_7_days||h.value.sales_last_7_days,bookings_status_last_30_days:t.charts.bookings_status_last_30_days||h.value.bookings_status_last_30_days,invoices_status:t.charts.invoices_status||h.value.invoices_status},P())}catch(a){console.error("Error loading dashboard:",a)}finally{O.value=!1}},d=(s,a="")=>{try{return(getComputedStyle(document.documentElement).getPropertyValue(s)||"").trim()||a}catch{return a}},P=()=>{$.value=`charts-${Date.now()}`};me.register(ge,he,pe,_e,ke,fe,ye,Ce);const se=C(()=>{var A,U,V;const s=d("--asmaa-primary","#BBA07A"),a=d("--asmaa-primary-soft","rgba(187,160,122,0.14)"),t=((A=h.value.sales_last_7_days)==null?void 0:A.labels)||[],v=((U=h.value.sales_last_7_days)==null?void 0:U.revenue)||[],m=((V=h.value.sales_last_7_days)==null?void 0:V.orders)||[];return{labels:t,datasets:[{label:o("dashboard.revenue")||"Revenue (KWD)",data:v,borderColor:s,backgroundColor:a,fill:!0,tension:.35,pointRadius:3,pointHoverRadius:5},{label:o("dashboard.orders")||"Orders",data:m,borderColor:d("--asmaa-secondary","#475569"),backgroundColor:d("--asmaa-secondary-soft","rgba(71,85,105,0.14)"),fill:!1,tension:.35,pointRadius:3,pointHoverRadius:5}]}}),S=()=>d("--border-color","#e5e7eb"),D=()=>d("--text-secondary","#64748b"),B=()=>d("--text-primary","#111827"),te=C(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:D(),usePointStyle:!0,boxWidth:8}},tooltip:{backgroundColor:d("--bg-primary","#fff"),titleColor:B(),bodyColor:B(),borderColor:S(),borderWidth:1}},scales:{x:{ticks:{color:D()},grid:{color:S()}},y:{ticks:{color:D()},grid:{color:S()}}}})),F=C(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:D(),usePointStyle:!0,boxWidth:8}},tooltip:{backgroundColor:d("--bg-primary","#fff"),titleColor:B(),bodyColor:B(),borderColor:S(),borderWidth:1}}})),ne=C(()=>{const s=h.value.bookings_status_last_30_days||{};return{labels:[o("bookings.pending")||"Pending",o("bookings.confirmed")||"Confirmed",o("bookings.completed")||"Completed",o("bookings.cancelled")||"Cancelled"],datasets:[{data:[s.pending||0,s.confirmed||0,s.completed||0,s.cancelled||0],backgroundColor:[d("--asmaa-warning","#f59e0b"),d("--asmaa-primary","#BBA07A"),d("--asmaa-success","#22c55e"),d("--asmaa-danger","#ef4444")],borderColor:d("--bg-primary","#fff"),borderWidth:2}]}}),ie=C(()=>{const s=h.value.invoices_status||{},a=Object.keys(s).filter(Boolean),t=a.map(m=>Number(s[m]||0)),v=[d("--asmaa-primary","#BBA07A"),d("--asmaa-success","#22c55e"),d("--asmaa-warning","#f59e0b"),d("--asmaa-danger","#ef4444"),d("--asmaa-secondary","#475569")];return{labels:a.length?a:[o("common.noData")||"No data"],datasets:[{data:a.length?t:[1],backgroundColor:a.length?a.map((m,A)=>v[A%v.length]):[d("--asmaa-secondary-soft","rgba(71,85,105,0.14)")],borderColor:d("--bg-primary","#fff"),borderWidth:2}]}}),K=async()=>{var s;T.value=!0;try{const a=await E.get("/bookings",{params:{per_page:5,orderby:"date",order:"desc"}}),t=((s=a.data)==null?void 0:s.data)||a.data||{};q.value=t.items||[]}catch(a){console.error("Error loading recent bookings:",a)}finally{T.value=!1}},M=async()=>{var s;W.value=!0;try{const a=await E.get("/queue"),t=((s=a.data)==null?void 0:s.data)||a.data||{};w.value=t.items||[]}catch(a){console.error("Error loading queue:",a)}finally{W.value=!1}};le(()=>{I(),K(),M()});const re=Se();return ce(()=>re.theme,()=>P()),(s,a)=>(u(),_("div",De,[n(qe,{title:e(o)("dashboard.title"),subtitle:e(o)("dashboard.subtitle")},{icon:l(()=>[...a[15]||(a[15]=[i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[i("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),i("path",{d:"M3 9h18"}),i("path",{d:"M9 21V9"})],-1)])]),actions:l(()=>[n(e(y),{color:"secondary",variant:"outline",onClick:ae,class:"action-btn"},{default:l(()=>[n(e(c),{icon:"cil-cloud-download",class:"me-2"}),g(" "+r(e(o)("common.export")),1)]),_:1}),n(e(y),{color:"primary",onClick:oe,class:"action-btn refresh-btn"},{default:l(()=>[n(e(c),{icon:"cil-reload",class:"me-2"}),g(" "+r(e(o)("common.refresh")),1)]),_:1})]),_:1},8,["title","subtitle"]),i("div",Be,[n(f,{label:e(o)("dashboard.totalCustomers"),value:b.value.customers||0,badge:e(o)("common.active")+" "+e(o)("nav.customers"),"badge-variant":"success",color:"blue",clickable:!0,onClick:a[0]||(a[0]=t=>s.$router.push("/customers"))},{icon:l(()=>[n(e(c),{icon:"cil-people"})]),_:1},8,["label","value","badge"]),n(f,{label:e(o)("dashboard.todaysBookings"),value:b.value.bookingsToday||0,badge:"85%","badge-variant":"success",color:"green",clickable:!0,onClick:a[1]||(a[1]=t=>s.$router.push("/bookings"))},{icon:l(()=>[n(e(c),{icon:"cil-calendar"})]),_:1},8,["label","value"]),n(f,{label:e(o)("dashboard.monthlyRevenue"),value:G(b.value.monthlyRevenue||0),badge:e(o)("dashboard.monthlyRevenue"),"badge-variant":"info",color:"yellow"},{icon:l(()=>[n(e(c),{icon:"cil-money"})]),_:1},8,["label","value","badge"]),n(f,{label:e(o)("dashboard.activeStaff"),value:b.value.activeStaff||0,badge:e(o)("common.active"),"badge-variant":"success",color:"purple",clickable:!0,onClick:a[2]||(a[2]=t=>s.$router.push("/staff"))},{icon:l(()=>[n(e(c),{icon:"cil-user"})]),_:1},8,["label","value","badge"]),n(f,{label:`${e(o)("common.total")||"Total"} ${e(o)("nav.services")}`,value:b.value.totalServices||0,badge:e(o)("common.active"),"badge-variant":"info",color:"pink",clickable:!0,onClick:a[3]||(a[3]=t=>s.$router.push("/services"))},{icon:l(()=>[n(e(c),{icon:"cil-spreadsheet"})]),_:1},8,["label","value","badge"]),n(f,{label:e(o)("orders.pending")+" "+e(o)("nav.orders"),value:b.value.pendingOrders||0,badge:b.value.pendingOrders||"0 "+e(o)("orders.pending"),"badge-variant":"warning",color:"teal",clickable:!0,onClick:a[4]||(a[4]=t=>s.$router.push("/orders"))},{icon:l(()=>[n(e(c),{icon:"cil-cart"})]),_:1},8,["label","value","badge"]),n(f,{label:e(o)("invoices.unpaid")+" "+e(o)("nav.invoices"),value:b.value.unpaidInvoices||0,badge:e(o)("common.status"),"badge-variant":"warning",color:"indigo",clickable:!0,onClick:a[5]||(a[5]=t=>s.$router.push("/invoices"))},{icon:l(()=>[n(e(c),{icon:"cil-file"})]),_:1},8,["label","value","badge"]),n(f,{label:e(o)("queue.waiting"),value:b.value.queueWaiting||0,badge:e(o)("dashboard.currentWaiting"),"badge-variant":"info",color:"orange",clickable:!0,onClick:a[6]||(a[6]=t=>s.$router.push("/queue"))},{icon:l(()=>[n(e(c),{icon:"cil-list"})]),_:1},8,["label","value","badge"])]),n(L,{title:e(o)("dashboard.chartsTitle")||"Analytics",subtitle:e(o)("dashboard.chartsSubtitle")||"Sales & activity insights",icon:"cil-chart-line",class:"charts-card"},{default:l(()=>[O.value?(u(),k(x,{key:0,text:e(o)("common.loading")},null,8,["text"])):(u(),_("div",Ae,[i("div",Le,[i("div",Re,r(e(o)("dashboard.salesLast7Days")||"Sales (Last 7 Days)"),1),i("div",Te,[(u(),k(e(ue),{data:se.value,options:te.value,key:$.value},null,8,["data","options"]))])]),i("div",We,[i("div",Oe,r(e(o)("dashboard.bookingsStatus")||"Bookings Status (Last 30 Days)"),1),i("div",Ee,[(u(),k(e(j),{data:ne.value,options:F.value,key:$.value+"-b"},null,8,["data","options"]))])]),i("div",xe,[i("div",Ne,r(e(o)("dashboard.invoicesStatus")||"Invoices Status"),1),i("div",Ie,[(u(),k(e(j),{data:ie.value,options:F.value,key:$.value+"-i"},null,8,["data","options"]))])])]))]),_:1},8,["title","subtitle"]),i("div",Pe,[n(L,{title:e(o)("dashboard.recentBookings"),subtitle:e(o)("dashboard.recentActivity"),icon:"cil-calendar"},{actions:l(()=>[n(e(y),{color:"secondary",variant:"ghost",size:"sm",onClick:a[7]||(a[7]=t=>s.$router.push("/bookings"))},{default:l(()=>[g(r(e(o)("dashboard.viewAll"))+" ",1),n(e(c),{icon:"cil-arrow-right",class:"ms-1"})]),_:1})]),footer:l(()=>[n(e(y),{color:"secondary",variant:"ghost",onClick:a[9]||(a[9]=t=>s.$router.push("/bookings")),class:"w-100"},{default:l(()=>[g(r(e(o)("dashboard.viewAllOrders"))+" ",1),n(e(c),{icon:"cil-arrow-right",class:"ms-2"})]),_:1})]),default:l(()=>[T.value?(u(),k(x,{key:0,text:e(o)("common.loading")},null,8,["text"])):q.value.length?(u(),_("div",Fe,[(u(!0),_(z,null,H(q.value.slice(0,5),t=>(u(),_("div",{key:t.id,class:"booking-item-modern",onClick:v=>s.$router.push(`/bookings/${t.id}`)},[i("div",Me,"#"+r(t.id),1),i("div",Ue,[i("div",Ve,r(t.customer_name||"Customer #"+t.customer_id),1),i("div",je,[n(e(Q),{color:Z(t.status),class:"status-badge"},{default:l(()=>[g(r(Y(t.status)),1)]),_:2},1032,["color"]),i("span",ze,[n(e(c),{icon:"cil-clock",class:"me-1"}),g(" "+r(ee(t.booking_time)),1)])])]),n(e(c),{icon:"cil-chevron-right",class:"booking-arrow"})],8,Ke))),128))])):(u(),k(X,{key:1,title:e(o)("dashboard.noBookings"),description:e(o)("dashboard.noBookingsFound"),"icon-color":"gray"},{action:l(()=>[n(e(y),{color:"primary",onClick:a[8]||(a[8]=t=>s.$router.push("/bookings?action=create"))},{default:l(()=>[g(r(`${e(o)("common.add")} ${e(o)("nav.bookings")}`),1)]),_:1})]),_:1},8,["title","description"]))]),_:1},8,["title","subtitle"]),n(L,{title:e(o)("dashboard.queueStatus"),subtitle:e(o)("dashboard.currentWaiting"),icon:"cil-list"},{actions:l(()=>[n(e(y),{color:"secondary",variant:"ghost",size:"sm",onClick:a[10]||(a[10]=t=>s.$router.push("/queue"))},{default:l(()=>[g(r(e(o)("dashboard.viewAll"))+" ",1),n(e(c),{icon:"cil-arrow-right",class:"ms-1"})]),_:1})]),default:l(()=>[W.value?(u(),k(x,{key:0,text:e(o)("common.loading")},null,8,["text"])):w.value.length?(u(),_("div",He,[(u(!0),_(z,null,H(w.value.slice(0,5),(t,v)=>(u(),_("div",{key:t.id,class:J(["queue-item-modern",{"queue-item-next":v===0}])},[i("div",{class:J(["queue-position",{"queue-position-next":v===0}])},r(v+1),3),i("div",Qe,[i("div",Je,r(t.customer_name),1),i("div",Xe,[n(e(c),{icon:"cil-spreadsheet",class:"me-1"}),g(" "+r(t.service_name),1)])]),n(e(Q),{color:v===0?"success":"secondary",class:"queue-status-badge"},{default:l(()=>[g(r(v===0?e(o)("queue.next"):e(o)("queue.waiting")),1)]),_:2},1032,["color"])],2))),128))])):(u(),k(X,{key:1,title:e(o)("queue.noWaiting"),description:"","icon-color":"green"},{icon:l(()=>[n(e(c),{icon:"cil-check-circle",size:"3xl"})]),_:1},8,["title"]))]),_:1},8,["title","subtitle"])]),n(L,{title:e(o)("dashboard.quickActions"),icon:"cil-bolt"},{default:l(()=>[i("div",Ge,[i("button",{class:"quick-action-btn",onClick:a[11]||(a[11]=t=>s.$router.push("/customers?action=create"))},[i("div",Ye,[n(e(c),{icon:"cil-plus"})]),i("div",Ze,[i("div",ea,r(e(o)("common.add"))+" "+r(e(o)("nav.customers")),1),i("div",aa,r(e(o)("customers.addNew")),1)]),n(e(c),{icon:"cil-arrow-right",class:"quick-action-arrow"})]),i("button",{class:"quick-action-btn",onClick:a[12]||(a[12]=t=>s.$router.push("/bookings?action=create"))},[i("div",oa,[n(e(c),{icon:"cil-calendar"})]),i("div",sa,[i("div",ta,r(e(o)("common.add"))+" "+r(e(o)("nav.bookings")),1),i("div",na,r(e(o)("bookings.addNew")),1)]),n(e(c),{icon:"cil-arrow-right",class:"quick-action-arrow"})]),i("button",{class:"quick-action-btn",onClick:a[13]||(a[13]=t=>s.$router.push("/services?action=create"))},[i("div",ia,[n(e(c),{icon:"cil-spreadsheet"})]),i("div",ra,[i("div",la,r(e(o)("common.add"))+" "+r(e(o)("nav.services")),1),i("div",ca,r(e(o)("services.addNew")),1)]),n(e(c),{icon:"cil-arrow-right",class:"quick-action-arrow"})]),i("button",{class:"quick-action-btn",onClick:a[14]||(a[14]=t=>s.$router.push("/staff?action=create"))},[i("div",da,[n(e(c),{icon:"cil-user"})]),i("div",ua,[i("div",va,r(e(o)("common.add"))+" "+r(e(o)("nav.staff")),1),i("div",ba,r(e(o)("staff.addNew")),1)]),n(e(c),{icon:"cil-arrow-right",class:"quick-action-arrow"})])])]),_:1},8,["title"])]))}},La=we(ma,[["__scopeId","data-v-5bc8053f"]]);export{La as default};
