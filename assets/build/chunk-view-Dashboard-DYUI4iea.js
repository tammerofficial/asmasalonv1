import{f as _,g as $,i as le,w as ce,c as C,o as v,d as s,b as n,p as l,u as e,s as f,a as de,h as ue,x as q,P as h,C as c,t as r,ad as ve,ae as j,F as z,k as H,Y as Q,n as J}from"./chunk-vendor-vue-CVODRAc9.js";import{u as be,a as N,c as me}from"./chunk-component-NotificationsBell-BlaTfaiw.js";import{C as ge,a as he,b as pe,P as ke,c as _e,A as fe,p as ye,d as Ce,i as we}from"./chunk-vendor-charts-C66rl4lP.js";import{P as qe}from"./chunk-component-PageHeader-DIMefZ9l.js";import{S as y}from"./chunk-component-StatCard-CUh-yMQt.js";import{_ as $e,C as W}from"./chunk-component-Card-DAbGoLxt.js";import{E as Y}from"./chunk-component-EmptyState-B8o9iOHP.js";import{L as P}from"./chunk-component-LoadingSpinner-DYzABkFM.js";import{a as Se}from"./chunk-view-Bookings/BookingAppearance-Vn9NL_13.js";import{u as Be}from"./chunk-component-Sidebar-ChD_VDDH.js";import"./chunk-vendor-6xaPOP3o.js";import"./chunk-vendor-pinia-DSPKUyr1.js";import"./chunk-vendor-axios-B9ygI19o.js";import"./chunk-view-Bookings/BookingFormPreview-CiRU9DIL.js";const De={class:"asmaa-salon-dashboard"},Ae={class:"stats-grid"},Le={key:1,class:"charts-grid"},Re={class:"chart-panel"},We={class:"chart-title"},Te={class:"chart-canvas"},Ee={class:"chart-panel"},Oe={class:"chart-title"},xe={class:"chart-canvas chart-canvas-sm"},Ne={class:"chart-panel"},Pe={class:"chart-title"},Ie={class:"chart-canvas chart-canvas-sm"},Ve={class:"content-grid"},Fe={key:2,class:"bookings-list-modern"},Ke=["onClick"],Me={class:"booking-number"},Ue={class:"booking-details-modern"},je={class:"booking-customer-name"},ze={class:"booking-meta-modern"},He={class:"booking-time-modern"},Qe={key:2,class:"queue-list-modern"},Je={class:"queue-info-modern"},Ye={class:"queue-customer-name"},Ge={class:"queue-service-modern"},Xe={class:"quick-actions-grid"},Ze={class:"quick-action-icon blue"},eo={class:"quick-action-content"},oo={class:"quick-action-title"},ao={class:"quick-action-desc"},to={class:"quick-action-icon gold"},so={class:"quick-action-content"},no={class:"quick-action-title"},io={class:"quick-action-desc"},ro={class:"quick-action-icon brown"},lo={class:"quick-action-content"},co={class:"quick-action-title"},uo={class:"quick-action-desc"},vo={class:"quick-action-icon pink"},bo={class:"quick-action-content"},mo={class:"quick-action-title"},go={class:"quick-action-desc"},ho={__name:"Dashboard",setup(po){ue();const{t:a}=be(),T=Se(),I=_(!1),E=_(!1),O=_(!1),x=_(!1),b=_({customers:0,bookingsToday:0,monthlyRevenue:0,activeStaff:0,totalServices:0,pendingOrders:0,unpaidInvoices:0,queueWaiting:0}),S=_([]),B=_([]),p=_({sales_last_7_days:{labels:[],orders:[],revenue:[]},bookings_status_last_30_days:{pending:0,confirmed:0,completed:0,cancelled:0},invoices_status:{}}),D=_("charts-0"),G=t=>{if(!t&&t!==0)return"0 KWD";const o=parseFloat(t);return o>=1e3?`${(o/1e3).toFixed(1)}K KWD`:`${o.toFixed(0)} KWD`},X=t=>({pending:a("bookings.pending"),confirmed:a("bookings.confirmed"),completed:a("bookings.completed"),cancelled:a("bookings.cancelled")})[t]||t,Z=t=>({pending:"warning",confirmed:"info",completed:"success",cancelled:"danger"})[t]||"info",ee=t=>{if(!t)return"-";const o=String(t);try{if(o.includes("T")||o.includes("-"))return new Date(o).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});const d=o.length===5?`${o}:00`:o;return new Date(`1970-01-01T${d}`).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return o}},oe=()=>{const t={exported_at:new Date().toISOString(),stats:b.value,recent_bookings:S.value,queue:B.value},o=JSON.stringify(t,null,2),d=new Blob([o],{type:"application/json;charset=utf-8"}),g=URL.createObjectURL(d),m=document.createElement("a");m.href=g,m.download=`asmaa-salon-dashboard-${new Date().toISOString().slice(0,19).replace(/[:T]/g,"-")}.json`,document.body.appendChild(m),m.click(),m.remove(),URL.revokeObjectURL(g),T.success("✅ Exported dashboard snapshot")},ae=async()=>{I.value=!0;try{me(),await V(),await M(),await U(),T.success("✅ Dashboard refreshed")}catch(t){console.error("Error refreshing data:",t),T.error("❌ Failed to refresh dashboard")}finally{I.value=!1}},V=async()=>{var t;x.value=!0;try{const o=await N.get("/reports/dashboard",{noCache:!0}),d=((t=o.data)==null?void 0:t.data)||o.data||{};b.value={...b.value,...d||{}},d!=null&&d.charts&&(p.value={sales_last_7_days:d.charts.sales_last_7_days||p.value.sales_last_7_days,bookings_status_last_30_days:d.charts.bookings_status_last_30_days||p.value.bookings_status_last_30_days,invoices_status:d.charts.invoices_status||p.value.invoices_status},F())}catch(o){console.error("Error loading dashboard:",o)}finally{x.value=!1}},u=(t,o="")=>{try{return(getComputedStyle(document.documentElement).getPropertyValue(t)||"").trim()||o}catch{return o}},F=()=>{D.value=`charts-${Date.now()}`};ge.register(he,pe,ke,_e,fe,ye,Ce,we);const te=$(()=>{var w,i,k;const t=u("--asmaa-primary","#BBA07A"),o=u("--asmaa-primary-soft","rgba(187,160,122,0.14)"),d=((w=p.value.sales_last_7_days)==null?void 0:w.labels)||[],g=((i=p.value.sales_last_7_days)==null?void 0:i.revenue)||[],m=((k=p.value.sales_last_7_days)==null?void 0:k.orders)||[];return{labels:d,datasets:[{label:a("dashboard.revenue")||"Revenue (KWD)",data:g,borderColor:t,backgroundColor:o,fill:!0,tension:.35,pointRadius:3,pointHoverRadius:5},{label:a("dashboard.orders")||"Orders",data:m,borderColor:u("--asmaa-secondary","#475569"),backgroundColor:u("--asmaa-secondary-soft","rgba(71,85,105,0.14)"),fill:!1,tension:.35,pointRadius:3,pointHoverRadius:5}]}}),A=()=>u("--border-color","#e5e7eb"),L=()=>u("--text-secondary","#64748b"),R=()=>u("--text-primary","#111827"),se=$(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:L(),usePointStyle:!0,boxWidth:8}},tooltip:{backgroundColor:u("--bg-primary","#fff"),titleColor:R(),bodyColor:R(),borderColor:A(),borderWidth:1}},scales:{x:{ticks:{color:L()},grid:{color:A()}},y:{ticks:{color:L()},grid:{color:A()}}}})),K=$(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:L(),usePointStyle:!0,boxWidth:8}},tooltip:{backgroundColor:u("--bg-primary","#fff"),titleColor:R(),bodyColor:R(),borderColor:A(),borderWidth:1}}})),ne=$(()=>{const t=p.value.bookings_status_last_30_days||{};return{labels:[a("bookings.pending")||"Pending",a("bookings.confirmed")||"Confirmed",a("bookings.completed")||"Completed",a("bookings.cancelled")||"Cancelled"],datasets:[{data:[t.pending||0,t.confirmed||0,t.completed||0,t.cancelled||0],backgroundColor:[u("--asmaa-warning","#f59e0b"),u("--asmaa-primary","#BBA07A"),u("--asmaa-primary-700","#A68B5B"),u("--asmaa-danger","#ef4444")],borderColor:u("--bg-primary","#fff"),borderWidth:2}]}}),ie=$(()=>{const t=p.value.invoices_status||{},o=Object.keys(t).filter(Boolean),d=o.map(m=>Number(t[m]||0)),g=[u("--asmaa-primary","#BBA07A"),u("--asmaa-primary-700","#A68B5B"),u("--asmaa-warning","#f59e0b"),u("--asmaa-danger","#ef4444"),u("--asmaa-secondary","#475569")];return{labels:o.length?o:[a("common.noData")||"No data"],datasets:[{data:o.length?d:[1],backgroundColor:o.length?o.map((m,w)=>g[w%g.length]):[u("--asmaa-secondary-soft","rgba(71,85,105,0.14)")],borderColor:u("--bg-primary","#fff"),borderWidth:2}]}}),M=async()=>{var t;E.value=!0;try{const o=await N.get("/bookings",{params:{per_page:5,orderby:"date",order:"desc"}}),d=((t=o.data)==null?void 0:t.data)||o.data||{};S.value=d.items||[]}catch(o){console.error("Error loading recent bookings:",o)}finally{E.value=!1}},U=async()=>{var t;O.value=!0;try{const o=await N.get("/queue"),d=((t=o.data)==null?void 0:t.data)||o.data||{};B.value=d.items||[]}catch(o){console.error("Error loading queue:",o)}finally{O.value=!1}};le(()=>{V(),M(),U()});const re=Be();return ce(()=>re.theme,()=>F()),(t,o)=>{var d,g,m,w;return v(),C("div",De,[s(qe,{title:e(a)("dashboard.title"),subtitle:e(a)("dashboard.subtitle")},{icon:l(()=>[...o[16]||(o[16]=[n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),n("path",{d:"M3 9h18"}),n("path",{d:"M9 21V9"})],-1)])]),actions:l(()=>[s(e(q),{color:"secondary",variant:"outline",onClick:oe,class:"action-btn"},{default:l(()=>[s(e(c),{icon:"cil-cloud-download",class:"me-2"}),h(" "+r(e(a)("common.export")),1)]),_:1}),s(e(q),{color:"primary",onClick:ae,class:"action-btn refresh-btn"},{default:l(()=>[s(e(c),{icon:"cil-reload",class:"me-2"}),h(" "+r(e(a)("common.refresh")),1)]),_:1})]),_:1},8,["title","subtitle"]),n("div",Ae,[s(y,{label:e(a)("dashboard.totalCustomers"),value:b.value.customers||0,badge:e(a)("common.active")+" "+e(a)("nav.customers"),"badge-variant":"info",color:"blue",clickable:!0,onClick:o[0]||(o[0]=i=>t.$router.push("/customers"))},{icon:l(()=>[s(e(c),{icon:"cil-people"})]),_:1},8,["label","value","badge"]),s(y,{label:e(a)("dashboard.todaysBookings"),value:b.value.bookingsToday||0,badge:"85%","badge-variant":"info",color:"gold",clickable:!0,onClick:o[1]||(o[1]=i=>t.$router.push("/bookings"))},{icon:l(()=>[s(e(c),{icon:"cil-calendar"})]),_:1},8,["label","value"]),s(y,{label:e(a)("dashboard.monthlyRevenue"),value:G(b.value.monthlyRevenue||0),badge:e(a)("dashboard.monthlyRevenue"),"badge-variant":"info",color:"yellow"},{icon:l(()=>[s(e(c),{icon:"cil-money"})]),_:1},8,["label","value","badge"]),s(y,{label:e(a)("dashboard.activeStaff"),value:b.value.activeStaff||0,badge:e(a)("common.active"),"badge-variant":"info",color:"gold",clickable:!0,onClick:o[2]||(o[2]=i=>t.$router.push("/staff"))},{icon:l(()=>[s(e(c),{icon:"cil-user"})]),_:1},8,["label","value","badge"]),s(y,{label:`${e(a)("common.total")||"Total"} ${e(a)("nav.services")}`,value:b.value.totalServices||0,badge:e(a)("common.active"),"badge-variant":"info",color:"pink",clickable:!0,onClick:o[3]||(o[3]=i=>t.$router.push("/services"))},{icon:l(()=>[s(e(c),{icon:"cil-spreadsheet"})]),_:1},8,["label","value","badge"]),s(y,{label:e(a)("orders.pending")+" "+e(a)("nav.orders"),value:b.value.pendingOrders||0,badge:b.value.pendingOrders||"0 "+e(a)("orders.pending"),"badge-variant":"warning",color:"teal",clickable:!0,onClick:o[4]||(o[4]=i=>t.$router.push("/orders"))},{icon:l(()=>[s(e(c),{icon:"cil-cart"})]),_:1},8,["label","value","badge"]),s(y,{label:e(a)("invoices.unpaid")+" "+e(a)("nav.invoices"),value:b.value.unpaidInvoices||0,badge:e(a)("common.status"),"badge-variant":"warning",color:"gold",clickable:!0,onClick:o[5]||(o[5]=i=>t.$router.push("/invoices"))},{icon:l(()=>[s(e(c),{icon:"cil-file"})]),_:1},8,["label","value","badge"]),s(y,{label:e(a)("queue.waiting"),value:b.value.queueWaiting||0,badge:e(a)("dashboard.currentWaiting"),"badge-variant":"info",color:"orange",clickable:!0,onClick:o[6]||(o[6]=i=>t.$router.push("/queue"))},{icon:l(()=>[s(e(c),{icon:"cil-list"})]),_:1},8,["label","value","badge"]),(d=b.value.woocommerce)!=null&&d.active?(v(),f(y,{key:0,label:e(a)("settings.woocommerce.title")||"WooCommerce",value:(g=b.value.woocommerce)!=null&&g.enabled?e(a)("common.active"):e(a)("common.inactive"),badge:((m=b.value.woocommerce)==null?void 0:m.synced_orders)+" "+e(a)("nav.orders"),"badge-variant":(w=b.value.woocommerce)!=null&&w.enabled?"info":"secondary",color:"gold",clickable:!0,onClick:o[7]||(o[7]=i=>t.$router.push("/settings/woocommerce"))},{icon:l(()=>[s(e(c),{icon:"cil-cart"})]),_:1},8,["label","value","badge","badge-variant"])):de("",!0)]),s(W,{title:e(a)("dashboard.chartsTitle")||"Analytics",subtitle:e(a)("dashboard.chartsSubtitle")||"Sales & activity insights",icon:"cil-chart-line",class:"charts-card"},{default:l(()=>[x.value?(v(),f(P,{key:0,text:e(a)("common.loading")},null,8,["text"])):(v(),C("div",Le,[n("div",Re,[n("div",We,r(e(a)("dashboard.salesLast7Days")||"Sales (Last 7 Days)"),1),n("div",Te,[(v(),f(e(ve),{data:te.value,options:se.value,key:D.value},null,8,["data","options"]))])]),n("div",Ee,[n("div",Oe,r(e(a)("dashboard.bookingsStatus")||"Bookings Status (Last 30 Days)"),1),n("div",xe,[(v(),f(e(j),{data:ne.value,options:K.value,key:D.value+"-b"},null,8,["data","options"]))])]),n("div",Ne,[n("div",Pe,r(e(a)("dashboard.invoicesStatus")||"Invoices Status"),1),n("div",Ie,[(v(),f(e(j),{data:ie.value,options:K.value,key:D.value+"-i"},null,8,["data","options"]))])])]))]),_:1},8,["title","subtitle"]),n("div",Ve,[s(W,{title:e(a)("dashboard.recentBookings"),subtitle:e(a)("dashboard.recentActivity"),icon:"cil-calendar"},{actions:l(()=>[s(e(q),{color:"secondary",variant:"ghost",size:"sm",onClick:o[8]||(o[8]=i=>t.$router.push("/bookings"))},{default:l(()=>[h(r(e(a)("dashboard.viewAll"))+" ",1),s(e(c),{icon:"cil-arrow-right",class:"ms-1"})]),_:1})]),footer:l(()=>[s(e(q),{color:"secondary",variant:"ghost",onClick:o[10]||(o[10]=i=>t.$router.push("/bookings")),class:"w-100"},{default:l(()=>[h(r(e(a)("dashboard.viewAllOrders"))+" ",1),s(e(c),{icon:"cil-arrow-right",class:"ms-2"})]),_:1})]),default:l(()=>[E.value?(v(),f(P,{key:0,text:e(a)("common.loading")},null,8,["text"])):S.value.length?(v(),C("div",Fe,[(v(!0),C(z,null,H(S.value.slice(0,5),i=>(v(),C("div",{key:i.id,class:"booking-item-modern",onClick:k=>t.$router.push(`/bookings/${i.id}`)},[n("div",Me,"#"+r(i.id),1),n("div",Ue,[n("div",je,r(i.customer_name||"Customer #"+i.customer_id),1),n("div",ze,[s(e(Q),{color:Z(i.status),class:"status-badge"},{default:l(()=>[h(r(X(i.status)),1)]),_:2},1032,["color"]),n("span",He,[s(e(c),{icon:"cil-clock",class:"me-1"}),h(" "+r(ee(i.booking_time)),1)])])]),s(e(c),{icon:"cil-chevron-right",class:"booking-arrow"})],8,Ke))),128))])):(v(),f(Y,{key:1,title:e(a)("dashboard.noBookings"),description:e(a)("dashboard.noBookingsFound"),"icon-color":"gray"},{action:l(()=>[s(e(q),{color:"primary",onClick:o[9]||(o[9]=i=>t.$router.push("/bookings?action=create"))},{default:l(()=>[h(r(`${e(a)("common.add")} ${e(a)("nav.bookings")}`),1)]),_:1})]),_:1},8,["title","description"]))]),_:1},8,["title","subtitle"]),s(W,{title:e(a)("dashboard.queueStatus"),subtitle:e(a)("dashboard.currentWaiting"),icon:"cil-list"},{actions:l(()=>[s(e(q),{color:"secondary",variant:"ghost",size:"sm",onClick:o[11]||(o[11]=i=>t.$router.push("/queue"))},{default:l(()=>[h(r(e(a)("dashboard.viewAll"))+" ",1),s(e(c),{icon:"cil-arrow-right",class:"ms-1"})]),_:1})]),default:l(()=>[O.value?(v(),f(P,{key:0,text:e(a)("common.loading")},null,8,["text"])):B.value.length?(v(),C("div",Qe,[(v(!0),C(z,null,H(B.value.slice(0,5),(i,k)=>(v(),C("div",{key:i.id,class:J(["queue-item-modern",{"queue-item-next":k===0}])},[n("div",{class:J(["queue-position",{"queue-position-next":k===0}])},r(k+1),3),n("div",Je,[n("div",Ye,r(i.customer_name),1),n("div",Ge,[s(e(c),{icon:"cil-spreadsheet",class:"me-1"}),h(" "+r(i.service_name),1)])]),s(e(Q),{color:k===0?"warning":"secondary",class:"queue-status-badge"},{default:l(()=>[h(r(k===0?e(a)("queue.next"):e(a)("queue.waiting")),1)]),_:2},1032,["color"])],2))),128))])):(v(),f(Y,{key:1,title:e(a)("queue.noWaiting"),description:"","icon-color":"gold"},{icon:l(()=>[s(e(c),{icon:"cil-check-circle",size:"3xl"})]),_:1},8,["title"]))]),_:1},8,["title","subtitle"])]),s(W,{title:e(a)("dashboard.quickActions"),icon:"cil-bolt"},{default:l(()=>[n("div",Xe,[n("button",{class:"quick-action-btn",onClick:o[12]||(o[12]=i=>t.$router.push("/customers?action=create"))},[n("div",Ze,[s(e(c),{icon:"cil-plus"})]),n("div",eo,[n("div",oo,r(e(a)("common.add"))+" "+r(e(a)("nav.customers")),1),n("div",ao,r(e(a)("customers.addNew")),1)]),s(e(c),{icon:"cil-arrow-right",class:"quick-action-arrow"})]),n("button",{class:"quick-action-btn",onClick:o[13]||(o[13]=i=>t.$router.push("/bookings?action=create"))},[n("div",to,[s(e(c),{icon:"cil-calendar"})]),n("div",so,[n("div",no,r(e(a)("common.add"))+" "+r(e(a)("nav.bookings")),1),n("div",io,r(e(a)("bookings.addNew")),1)]),s(e(c),{icon:"cil-arrow-right",class:"quick-action-arrow"})]),n("button",{class:"quick-action-btn",onClick:o[14]||(o[14]=i=>t.$router.push("/services?action=create"))},[n("div",ro,[s(e(c),{icon:"cil-spreadsheet"})]),n("div",lo,[n("div",co,r(e(a)("common.add"))+" "+r(e(a)("nav.services")),1),n("div",uo,r(e(a)("services.addNew")),1)]),s(e(c),{icon:"cil-arrow-right",class:"quick-action-arrow"})]),n("button",{class:"quick-action-btn",onClick:o[15]||(o[15]=i=>t.$router.push("/staff?action=create"))},[n("div",vo,[s(e(c),{icon:"cil-user"})]),n("div",bo,[n("div",mo,r(e(a)("common.add"))+" "+r(e(a)("nav.staff")),1),n("div",go,r(e(a)("staff.addNew")),1)]),s(e(c),{icon:"cil-arrow-right",class:"quick-action-arrow"})])])]),_:1},8,["title"])])}}},Wo=$e(ho,[["__scopeId","data-v-12b93921"]]);export{Wo as default};
