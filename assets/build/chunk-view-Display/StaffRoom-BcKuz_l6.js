import{f as _,g as h,i as U,af as F,c,o as d,b as s,d as a,u as o,C as n,P as r,t as l,n as p,F as I,k as B,a as b}from"../chunk-vendor-vue-9XB69CcG.js";import{a as R}from"../chunk-component-NotificationsBell-PEptZHCy.js";import{_ as W}from"../chunk-component-Card-CPZTx4Dn.js";import"../chunk-vendor-6xaPOP3o.js";import"../chunk-vendor-charts-C66rl4lP.js";import"../chunk-vendor-pinia-BpPt1UDF.js";import"../chunk-vendor-axios-B9ygI19o.js";const z={class:"display-header"},O={class:"header-content"},j={class:"logo-section"},G={class:"logo-icon-wrapper"},H={class:"header-info"},J={class:"date-time-group"},K={class:"display-date"},Q={class:"display-time"},X=["disabled"],Y={class:"display-content"},Z={class:"display-section staff-grid-section"},$={class:"section-header"},ss={class:"section-title-wrapper"},ts={class:"section-icon-wrapper staff-icon"},es={class:"section-title"},is={class:"staff-count-badge"},as={key:0,class:"staff-grid-container"},os={class:"staff-avatar-large"},ns={class:"staff-info-display"},ls={class:"staff-name-large"},cs={class:"staff-role-display"},ds={key:0,class:"current-info"},rs={class:"current-customer"},us={key:0,class:"current-service"},vs={key:1,class:"idle-state"},_s={key:1,class:"empty-staff"},ps={class:"empty-icon-large"},ms={class:"display-section waiting-calls-section"},fs={class:"section-header"},gs={class:"section-title-wrapper"},ys={class:"section-icon-wrapper waiting-icon"},hs={class:"section-title"},bs={key:0,class:"waiting-count-badge"},ks={key:0,class:"waiting-calls-container"},ws={class:"call-number-badge"},Ss={class:"call-info"},Cs={class:"call-ticket-number"},xs={class:"call-customer-name"},Is={key:0,class:"call-service-name"},Bs={key:1,class:"call-staff-name"},Rs={key:1,class:"empty-waiting"},Ds={class:"empty-icon-medium"},Ns={class:"display-section bookings-section"},Ts={class:"section-header"},As={class:"section-title-wrapper"},Ms={class:"section-icon-wrapper bookings-icon"},Ps={key:0,class:"bookings-container"},Vs={class:"booking-time"},qs={class:"booking-info"},Es={class:"booking-customer"},Ls={class:"booking-service"},Us={class:"booking-staff"},Fs={class:"booking-status"},Ws={key:1,class:"empty-bookings"},zs={class:"empty-icon-medium"},Os={class:"display-footer"},js={class:"footer-stat"},Gs={class:"stat-icon-wrapper available-stat"},Hs={class:"stat-content"},Js={class:"stat-value"},Ks={class:"footer-stat"},Qs={class:"stat-icon-wrapper busy-stat"},Xs={class:"stat-content"},Ys={class:"stat-value"},Zs={class:"footer-stat"},$s={class:"stat-icon-wrapper waiting-stat"},st={class:"stat-content"},tt={class:"stat-value"},et={class:"footer-stat"},it={class:"stat-icon-wrapper bookings-stat"},at={class:"stat-content"},ot={class:"stat-value"},nt={__name:"StaffRoom",setup(lt){const k=_([]),y=_([]),m=_([]),v=_(!1),D=_(""),N=_(""),T=()=>{const i=new Date;D.value=i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),N.value=i.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},A=()=>new Date().toISOString().slice(0,10),M=async()=>{var i,t,e,u;v.value=!0;try{const[x,L]=await Promise.all([R.get("/staff",{params:{per_page:100}}),R.get("/worker-calls",{params:{per_page:200}})]);k.value=((t=(i=x.data)==null?void 0:i.data)==null?void 0:t.items)||[],y.value=((u=(e=L.data)==null?void 0:e.data)==null?void 0:u.items)||[]}catch(x){console.error("Error loading staff/calls",x),k.value=[],y.value=[]}finally{v.value=!1}},P=async()=>{var i,t;try{const e=await R.get("/bookings",{params:{booking_date:A(),per_page:50}});m.value=((t=(i=e.data)==null?void 0:i.data)==null?void 0:t.items)||[]}catch(e){console.error("Error loading bookings",e),m.value=[]}},w=async()=>{await Promise.all([M(),P()])},f=h(()=>k.value.map(i=>{const t=y.value.find(u=>u.staff_id===i.id&&["pending","customer_called","staff_called"].includes(u.status)),e=t&&t.queue_status&&t.queue_status!=="completed";return{id:i.id,name:i.name,position:i.position,busy:e,currentService:(t==null?void 0:t.service_name)||null,currentCustomer:(t==null?void 0:t.customer_name)||null,currentCall:t}})),g=h(()=>y.value.filter(i=>i.queue_status==="waiting"||i.status==="pending")),V=h(()=>f.value.filter(i=>!i.busy).length),q=h(()=>f.value.filter(i=>i.busy).length),E=i=>({pending:"pending",confirmed:"confirmed",completed:"completed",cancelled:"cancelled"})[i]||"pending";let S=null,C=null;return U(()=>{T(),S=setInterval(T,1e3),w(),C=setInterval(()=>{v.value||w()},1e4)}),F(()=>{S&&clearInterval(S),C&&clearInterval(C)}),(i,t)=>(d(),c("div",{class:p(["staff-room-display",{"is-loading":v.value}])},[s("div",z,[s("div",O,[s("div",j,[s("div",G,[a(o(n),{icon:"cil-people",class:"logo-icon"})]),t[0]||(t[0]=s("div",{class:"title-group"},[s("h1",{class:"display-title"},"Staff Room Display"),s("p",{class:"display-subtitle"},"Real-time Staff Call Management System")],-1))]),s("div",H,[s("div",J,[s("div",K,[a(o(n),{icon:"cil-calendar",class:"info-icon"}),r(" "+l(N.value),1)]),s("div",Q,[a(o(n),{icon:"cil-clock",class:"info-icon"}),r(" "+l(D.value),1)])]),s("button",{class:"refresh-btn",onClick:w,disabled:v.value},[a(o(n),{icon:"cil-reload",class:p({spinning:v.value})},null,8,["class"]),t[1]||(t[1]=s("span",null,"Refresh",-1))],8,X)])])]),s("div",Y,[s("div",Z,[s("div",$,[s("div",ss,[s("div",ts,[a(o(n),{icon:"cil-people",class:"section-icon"})]),s("h2",es,[t[2]||(t[2]=r(" Staff Status ",-1)),s("span",is,l(f.value.length),1)])])]),f.value.length?(d(),c("div",as,[(d(!0),c(I,null,B(f.value,e=>(d(),c("div",{key:e.id,class:p(["staff-card-display",{busy:e.busy,available:!e.busy}])},[t[5]||(t[5]=s("div",{class:"staff-card-glow"},null,-1)),s("div",os,[t[3]||(t[3]=s("div",{class:"avatar-ring"},null,-1)),a(o(n),{icon:e.busy?"cil-user":"cil-check-circle",class:"avatar-icon"},null,8,["icon"])]),s("div",ns,[s("div",ls,l(e.name),1),s("div",cs,l(e.position||"Staff"),1),s("div",{class:p(["staff-status-badge",{busy:e.busy,available:!e.busy}])},[a(o(n),{icon:e.busy?"cil-user":"cil-check-circle",class:"status-icon"},null,8,["icon"]),r(" "+l(e.busy?"Busy":"Available"),1)],2),e.currentCustomer?(d(),c("div",ds,[s("div",rs,[a(o(n),{icon:"cil-user",class:"info-icon-xs"}),s("span",null,l(e.currentCustomer),1)]),e.currentService?(d(),c("div",us,[a(o(n),{icon:"cil-spreadsheet",class:"info-icon-xs"}),s("span",null,l(e.currentService),1)])):b("",!0)])):(d(),c("div",vs,[a(o(n),{icon:"cil-pause",class:"idle-icon"}),t[4]||(t[4]=s("span",null,"Ready for next customer",-1))]))])],2))),128))])):(d(),c("div",_s,[s("div",ps,[a(o(n),{icon:"cil-people"})]),t[6]||(t[6]=s("p",{class:"empty-text"},"No staff available",-1)),t[7]||(t[7]=s("p",{class:"empty-subtext"},"Please add staff members",-1))]))]),s("div",ms,[s("div",fs,[s("div",gs,[s("div",ys,[a(o(n),{icon:"cil-bell",class:"section-icon"})]),s("h2",hs,[t[8]||(t[8]=r(" Waiting Calls ",-1)),g.value.length>0?(d(),c("span",bs,l(g.value.length),1)):b("",!0)])])]),g.value.length?(d(),c("div",ks,[(d(!0),c(I,null,B(g.value,(e,u)=>(d(),c("div",{key:e.id,class:p(["waiting-call-item",{urgent:u===0}])},[s("div",ws,l(u+1),1),s("div",Ss,[s("div",Cs,[a(o(n),{icon:"cil-ticket",class:"ticket-icon"}),r(" #"+l(e.ticket_number||e.ticket_id),1)]),s("div",xs,[a(o(n),{icon:"cil-user",class:"info-icon-xs"}),r(" "+l(e.customer_name||"Customer"),1)]),e.service_name?(d(),c("div",Is,[a(o(n),{icon:"cil-spreadsheet",class:"info-icon-xs"}),r(" "+l(e.service_name),1)])):b("",!0),e.staff_name?(d(),c("div",Bs,[a(o(n),{icon:"cil-user-female",class:"info-icon-xs"}),r(" Staff: "+l(e.staff_name),1)])):b("",!0)])],2))),128))])):(d(),c("div",Rs,[s("div",Ds,[a(o(n),{icon:"cil-check-circle"})]),t[9]||(t[9]=s("p",{class:"empty-text"},"No calls waiting",-1)),t[10]||(t[10]=s("p",{class:"empty-subtext"},"All staff are available",-1))]))]),s("div",Ns,[s("div",Ts,[s("div",As,[s("div",Ms,[a(o(n),{icon:"cil-calendar",class:"section-icon"})]),t[11]||(t[11]=s("h2",{class:"section-title"},"Today's Bookings",-1))])]),m.value.length?(d(),c("div",Ps,[(d(!0),c(I,null,B(m.value,e=>(d(),c("div",{key:e.id,class:"booking-item"},[s("div",Vs,[a(o(n),{icon:"cil-clock",class:"time-icon"}),r(" "+l(e.booking_time),1)]),s("div",qs,[s("div",Es,l(e.customer_name),1),s("div",Ls,l(e.service_name),1),s("div",Us,l(e.staff_name),1)]),s("div",Fs,[s("span",{class:p(["status-badge",E(e.status)])},l(e.status),3)])]))),128))])):(d(),c("div",Ws,[s("div",zs,[a(o(n),{icon:"cil-calendar"})]),t[12]||(t[12]=s("p",{class:"empty-text"},"No bookings today",-1)),t[13]||(t[13]=s("p",{class:"empty-subtext"},"Schedule is clear",-1))]))])]),s("div",Os,[s("div",js,[s("div",Gs,[a(o(n),{icon:"cil-check-circle"})]),s("div",Hs,[s("div",Js,l(V.value),1),t[14]||(t[14]=s("div",{class:"stat-label"},"Available",-1))])]),s("div",Ks,[s("div",Qs,[a(o(n),{icon:"cil-user"})]),s("div",Xs,[s("div",Ys,l(q.value),1),t[15]||(t[15]=s("div",{class:"stat-label"},"Busy",-1))])]),s("div",Zs,[s("div",$s,[a(o(n),{icon:"cil-bell"})]),s("div",st,[s("div",tt,l(g.value.length),1),t[16]||(t[16]=s("div",{class:"stat-label"},"Waiting Calls",-1))])]),s("div",et,[s("div",it,[a(o(n),{icon:"cil-calendar"})]),s("div",at,[s("div",ot,l(m.value.length),1),t[17]||(t[17]=s("div",{class:"stat-label"},"Today's Bookings",-1))])])])],2))}},mt=W(nt,[["__scopeId","data-v-8ccde710"]]);export{mt as default};
