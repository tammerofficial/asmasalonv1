import{f,j as K,c as v,o as h,b as t,d as a,t as e,u as s,w as c,Y as F,x as b,C as i,$ as U,h as W,a as A,F as R,g as G,ae as H,l as L,P as x,n as M,a2 as C,aa as E,ab as Y,a3 as q,a4 as J}from"../chunk-vendor-vue-Dg0iJD_h.js";import{u as O,a as S}from"../chunk-component-NotificationsBell-B2dAMSJx.js";import{u as Q}from"../chunk-view-AppleWallet/Simulator-FWAoI2CS.js";import{H as X}from"../chunk-component-HelpSection-CAMARqlT.js";import{_ as Z}from"../chunk-component-Card-BEqwRdY0.js";import"../chunk-vendor-Ltsl4QyH.js";import"../chunk-vendor-pinia-AvH0NMyG.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-PageHeader-CswlebSl.js";const tt={class:"invoices-page p-4"},st={class:"pos-header-top d-flex justify-content-between align-items-center mb-4"},et={class:"header-left d-flex align-items-center gap-3"},at={class:"mb-0 fw-bold text-primary"},ot={class:"header-right d-flex gap-2"},nt={class:"nano-stats-bar mb-4"},lt={class:"stat-icon-bg total"},ct={class:"stat-info"},it={class:"stat-value"},dt={class:"stat-label"},rt={class:"stat-icon-bg paid"},ut={class:"stat-info"},_t={class:"stat-value text-success"},pt={class:"stat-label"},mt={class:"stat-icon-bg unpaid"},vt={class:"stat-info"},ht={class:"stat-value text-warning"},gt={class:"stat-label"},ft={class:"stat-card-nano"},bt={class:"stat-icon-bg amount"},yt={class:"stat-info"},xt={class:"stat-value text-info"},Ct={class:"stat-label"},wt={class:"nano-filters-bar p-3 bg-secondary rounded-4 mb-4 shadow-sm border border-light"},kt={value:""},It={value:"draft"},Ft={value:"sent"},St={value:"paid"},Vt={value:"cancelled"},Tt={class:"nano-panel"},Dt={key:0,class:"text-center p-5"},Nt={key:1,class:"text-center p-5 text-muted opacity-50"},$t={key:2},Bt={class:"nano-table-container"},Pt={class:"nano-table w-100"},jt={class:"text-start"},zt={class:"text-end"},Kt={class:"text-start fw-bold"},Ut={class:"fw-bold"},Wt={class:"small text-muted"},At={class:"text-end fw-bold text-success"},Rt={class:"d-flex gap-2 justify-content-center"},Gt={key:0,class:"d-flex justify-content-center mt-5"},Ht={__name:"Index",setup(Lt){const{t:o}=O(),V=Q(),w=L(),g=f(!1),y=f([]),p=f({total:0,paid:0,unpaid:0,totalAmount:0}),r=f({current_page:1,per_page:15,total:0,total_pages:0}),u=f({search:"",status:""}),_=async()=>{var l,d;g.value=!0;try{const n=await S.get("/invoices",{params:{page:r.value.current_page,per_page:r.value.per_page,...u.value}}),m=((l=n.data)==null?void 0:l.data)||n.data;y.value=m.items||[],r.value=m.pagination||r.value;const I=await S.get("/invoices/stats");p.value=((d=I.data)==null?void 0:d.data)||I.data||p.value}catch(n){console.error("Failed to load invoices:",n)}finally{g.value=!1}},T=()=>{clearTimeout(window.iSearchTimer),window.searchTimer=setTimeout(_,500)},k=()=>{u.value={search:"",status:""},_()},D=l=>{r.value.current_page=l,_()},N=l=>{switch(l){case"paid":return"success";case"partial":return"info";case"sent":return"warning";case"overdue":return"danger";default:return"secondary"}},$=l=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",minimumFractionDigits:3}).format(l||0),B=l=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",notation:"compact",minimumFractionDigits:1}).format(l||0),P=l=>w.push(`/invoices/${l.id}`),j=l=>V.info(o("orders.sendingToPrinter")),z=()=>w.push("/pos");return K(()=>{_()}),(l,d)=>(h(),v("div",tt,[t("div",st,[t("div",et,[t("h2",at,e(s(o)("invoices.title")),1),a(s(F),{color:"gold",shape:"rounded-pill",class:"px-3 py-2 fw-bold text-dark"},{default:c(()=>[a(s(i),{icon:"cil-file",class:"me-1"}),x(" "+e(p.value.total||y.value.length)+" "+e(s(o)("invoices.totalInvoices")),1)]),_:1})]),t("div",ot,[a(s(b),{color:"primary",class:"nano-btn",onClick:z},{default:c(()=>[a(s(i),{icon:"cil-plus",class:"me-2"}),x(e(s(o)("invoices.addNew")),1)]),_:1}),a(s(b),{color:"secondary",variant:"ghost",onClick:_,disabled:g.value},{default:c(()=>[a(s(i),{icon:"cil-reload",class:M({spinning:g.value})},null,8,["class"])]),_:1},8,["disabled"])])]),t("div",nt,[t("div",{class:"stat-card-nano clickable",onClick:k},[t("div",lt,[a(s(i),{icon:"cil-file"})]),t("div",ct,[t("div",it,e(p.value.total||0),1),t("div",dt,e(s(o)("invoices.totalInvoices")),1)])]),t("div",{class:"stat-card-nano clickable",onClick:d[0]||(d[0]=n=>{u.value.status="paid",_()})},[t("div",rt,[a(s(i),{icon:"cil-check-circle"})]),t("div",ut,[t("div",_t,e(p.value.paid||0),1),t("div",pt,e(s(o)("status.paid")),1)])]),t("div",{class:"stat-card-nano clickable",onClick:d[1]||(d[1]=n=>{u.value.status="unpaid",_()})},[t("div",mt,[a(s(i),{icon:"cil-warning"})]),t("div",vt,[t("div",ht,e(p.value.unpaid||0),1),t("div",gt,e(s(o)("status.unpaid")),1)])]),t("div",ft,[t("div",bt,[a(s(i),{icon:"cil-money"})]),t("div",yt,[t("div",xt,e(B(p.value.totalAmount||0)),1),t("div",Ct,e(s(o)("common.totalAmount")),1)])])]),t("div",wt,[a(s(U),{class:"g-3 align-items-center"},{default:c(()=>[a(s(C),{md:"4"},{default:c(()=>[a(s(E),null,{default:c(()=>[a(s(Y),{class:"bg-transparent border-0"},{default:c(()=>[a(s(i),{icon:"cil-magnifying-glass"})]),_:1}),a(s(q),{modelValue:u.value.search,"onUpdate:modelValue":d[2]||(d[2]=n=>u.value.search=n),placeholder:s(o)("common.search"),onInput:T,class:"border-0 bg-transparent"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(s(C),{md:"3"},{default:c(()=>[a(s(J),{modelValue:u.value.status,"onUpdate:modelValue":d[3]||(d[3]=n=>u.value.status=n),onChange:_,class:"rounded-3"},{default:c(()=>[t("option",kt,e(s(o)("invoices.allStatuses")),1),t("option",It,e(s(o)("status.draft")),1),t("option",Ft,e(s(o)("status.sent")),1),t("option",St,e(s(o)("status.paid")),1),t("option",Vt,e(s(o)("status.cancelled")),1)]),_:1},8,["modelValue"])]),_:1}),a(s(C),{md:"3"},{default:c(()=>[a(s(b),{color:"primary",variant:"ghost",class:"w-100",onClick:k},{default:c(()=>[a(s(i),{icon:"cil-filter-x",class:"me-1"}),x(e(s(o)("common.reset")),1)]),_:1})]),_:1})]),_:1})]),t("div",Tt,[g.value?(h(),v("div",Dt,[a(s(W),{color:"primary"})])):y.value.length===0?(h(),v("div",Nt,[a(s(i),{icon:"cil-description",size:"xl",class:"mb-3"}),t("p",null,e(s(o)("invoices.noInvoices")),1)])):(h(),v("div",$t,[t("div",Bt,[t("table",Pt,[t("thead",null,[t("tr",null,[t("th",jt,e(s(o)("invoices.invoiceNumber")),1),t("th",null,e(s(o)("common.customer")),1),t("th",zt,e(s(o)("common.amount")),1),t("th",null,e(s(o)("common.status")),1),t("th",null,e(s(o)("common.dueDate")),1),t("th",null,e(s(o)("common.actions")),1)])]),t("tbody",null,[(h(!0),v(R,null,G(y.value,n=>(h(),v("tr",{key:n.id,class:"nano-table-row"},[t("td",Kt,"#"+e(n.id),1),t("td",null,[t("div",Ut,e(n.customer_name),1),t("div",Wt,e(n.customer_phone),1)]),t("td",At,e($(n.total_amount||0)),1),t("td",null,[a(s(F),{color:N(n.status),shape:"rounded-pill",class:"px-3"},{default:c(()=>{var m;return[x(e((m=n.status)==null?void 0:m.toUpperCase()),1)]}),_:2},1032,["color"])]),t("td",null,e(new Date(n.due_date).toLocaleDateString()),1),t("td",null,[t("div",Rt,[a(s(b),{size:"sm",color:"info",variant:"ghost",onClick:m=>P(n)},{default:c(()=>[a(s(i),{icon:"cil-external-link"})]),_:1},8,["onClick"]),a(s(b),{size:"sm",color:"primary",variant:"ghost",onClick:m=>j()},{default:c(()=>[a(s(i),{icon:"cil-print"})]),_:1},8,["onClick"])])])]))),128))])])]),r.value.total_pages>1?(h(),v("div",Gt,[a(s(H),{pages:r.value.total_pages,"active-page":r.value.current_page,"onUpdate:activePage":D},null,8,["pages","active-page"])])):A("",!0)]))]),a(X,{"page-key":"invoices"})]))}},ts=Z(Ht,[["__scopeId","data-v-29252a03"]]);export{ts as default};
