import{f,j,c as m,o as _,b as t,d as e,t as i,u as a,w as l,Y as S,x as h,C as c,$ as z,h as K,a as W,F as R,g as G,ae as H,l as L,P as y,n as M,a2 as x,aa as E,ab as Y,a3 as q,a4 as J}from"../chunk-vendor-vue-BKzcbwC-.js";import{u as O,a as T}from"../chunk-component-NotificationsBell-BXS18BTB.js";import{u as Q}from"../chunk-view-AppleWallet/Simulator-DWRUiMHd.js";import{H as X}from"../chunk-component-HelpSection-B1vxldAY.js";import{_ as Z}from"../chunk-component-Card-D7ddNvJz.js";import"../chunk-vendor-Ltsl4QyH.js";import"../chunk-vendor-pinia-CsGkbfJ3.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-PageHeader-CI_3JpQM.js";const tt={class:"invoices-page p-4"},at={class:"pos-header-top d-flex justify-content-between align-items-center mb-4"},et={class:"header-left d-flex align-items-center gap-3"},st={class:"mb-0 fw-bold text-primary"},ot={class:"header-right d-flex gap-2"},nt={class:"nano-stats-bar mb-4"},lt={class:"stat-icon-bg total"},it={class:"stat-info"},ct={class:"stat-value"},rt={class:"stat-icon-bg paid"},dt={class:"stat-info"},ut={class:"stat-value text-success"},pt={class:"stat-icon-bg unpaid"},vt={class:"stat-info"},mt={class:"stat-value text-warning"},_t={class:"stat-card-nano"},gt={class:"stat-icon-bg amount"},ft={class:"stat-info"},ht={class:"stat-value text-info"},bt={class:"nano-filters-bar p-3 bg-secondary rounded-4 mb-4 shadow-sm border border-light"},yt={class:"nano-panel"},Ct={key:0,class:"text-center p-5"},xt={key:1,class:"text-center p-5 text-muted opacity-50"},wt={key:2},kt={class:"nano-table-container"},It={class:"nano-table w-100"},St={class:"text-start fw-bold"},Tt={class:"fw-bold"},Dt={class:"small text-muted"},Ft={class:"text-end fw-bold text-success"},Vt={class:"d-flex gap-2 justify-content-center"},Nt={key:0,class:"d-flex justify-content-center mt-5"},At={__name:"Index",setup(Pt){const{t:C}=O(),D=Q(),w=L(),g=f(!1),b=f([]),p=f({total:0,paid:0,unpaid:0,totalAmount:0}),r=f({current_page:1,per_page:15,total:0,total_pages:0}),d=f({search:"",status:""}),u=async()=>{var n,s;g.value=!0;try{const o=await T.get("/invoices",{params:{page:r.value.current_page,per_page:r.value.per_page,...d.value}}),v=((n=o.data)==null?void 0:n.data)||o.data;b.value=v.items||[],r.value=v.pagination||r.value;const I=await T.get("/invoices/stats");p.value=((s=I.data)==null?void 0:s.data)||I.data||p.value}catch(o){console.error("Failed to load invoices:",o)}finally{g.value=!1}},F=()=>{clearTimeout(window.iSearchTimer),window.searchTimer=setTimeout(u,500)},k=()=>{d.value={search:"",status:""},u()},V=n=>{r.value.current_page=n,u()},N=n=>{switch(n){case"paid":return"success";case"partial":return"info";case"sent":return"warning";case"overdue":return"danger";default:return"secondary"}},A=n=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",minimumFractionDigits:3}).format(n||0),P=n=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",notation:"compact",minimumFractionDigits:1}).format(n||0),$=n=>w.push(`/invoices/${n.id}`),B=n=>D.info("Sending to printer..."),U=()=>w.push("/pos");return j(()=>{u()}),(n,s)=>(_(),m("div",tt,[t("div",at,[t("div",et,[t("h2",st,i(a(C)("invoices.title")),1),e(a(S),{color:"gold",shape:"rounded-pill",class:"px-3 py-2 fw-bold text-dark"},{default:l(()=>[e(a(c),{icon:"cil-file",class:"me-1"}),y(" "+i(p.value.total||b.value.length)+" Total Invoices ",1)]),_:1})]),t("div",ot,[e(a(h),{color:"primary",class:"nano-btn",onClick:U},{default:l(()=>[e(a(c),{icon:"cil-plus",class:"me-2"}),s[4]||(s[4]=y("New Invoice ",-1))]),_:1}),e(a(h),{color:"secondary",variant:"ghost",onClick:u,disabled:g.value},{default:l(()=>[e(a(c),{icon:"cil-reload",class:M({spinning:g.value})},null,8,["class"])]),_:1},8,["disabled"])])]),t("div",nt,[t("div",{class:"stat-card-nano clickable",onClick:k},[t("div",lt,[e(a(c),{icon:"cil-file"})]),t("div",it,[t("div",ct,i(p.value.total||0),1),s[5]||(s[5]=t("div",{class:"stat-label"},"Total Invoices",-1))])]),t("div",{class:"stat-card-nano clickable",onClick:s[0]||(s[0]=o=>{d.value.status="paid",u()})},[t("div",rt,[e(a(c),{icon:"cil-check-circle"})]),t("div",dt,[t("div",ut,i(p.value.paid||0),1),s[6]||(s[6]=t("div",{class:"stat-label"},"Paid",-1))])]),t("div",{class:"stat-card-nano clickable",onClick:s[1]||(s[1]=o=>{d.value.status="unpaid",u()})},[t("div",pt,[e(a(c),{icon:"cil-warning"})]),t("div",vt,[t("div",mt,i(p.value.unpaid||0),1),s[7]||(s[7]=t("div",{class:"stat-label"},"Unpaid",-1))])]),t("div",_t,[t("div",gt,[e(a(c),{icon:"cil-money"})]),t("div",ft,[t("div",ht,i(P(p.value.totalAmount||0)),1),s[8]||(s[8]=t("div",{class:"stat-label"},"Total Amount",-1))])])]),t("div",bt,[e(a(z),{class:"g-3 align-items-center"},{default:l(()=>[e(a(x),{md:"4"},{default:l(()=>[e(a(E),null,{default:l(()=>[e(a(Y),{class:"bg-transparent border-0"},{default:l(()=>[e(a(c),{icon:"cil-magnifying-glass"})]),_:1}),e(a(q),{modelValue:d.value.search,"onUpdate:modelValue":s[2]||(s[2]=o=>d.value.search=o),placeholder:a(C)("common.search"),onInput:F,class:"border-0 bg-transparent"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),e(a(x),{md:"3"},{default:l(()=>[e(a(J),{modelValue:d.value.status,"onUpdate:modelValue":s[3]||(s[3]=o=>d.value.status=o),onChange:u,class:"rounded-3"},{default:l(()=>[...s[9]||(s[9]=[t("option",{value:""},"All Statuses",-1),t("option",{value:"draft"},"Draft",-1),t("option",{value:"sent"},"Sent",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"cancelled"},"Cancelled",-1)])]),_:1},8,["modelValue"])]),_:1}),e(a(x),{md:"3"},{default:l(()=>[e(a(h),{color:"primary",variant:"ghost",class:"w-100",onClick:k},{default:l(()=>[e(a(c),{icon:"cil-filter-x",class:"me-1"}),y(i(a(C)("common.reset")),1)]),_:1})]),_:1})]),_:1})]),t("div",yt,[g.value?(_(),m("div",Ct,[e(a(K),{color:"primary"})])):b.value.length===0?(_(),m("div",xt,[e(a(c),{icon:"cil-description",size:"xl",class:"mb-3"}),s[10]||(s[10]=t("p",null,"No invoices found",-1))])):(_(),m("div",wt,[t("div",kt,[t("table",It,[s[11]||(s[11]=t("thead",null,[t("tr",null,[t("th",{class:"text-start"},"Invoice #"),t("th",null,"Customer"),t("th",{class:"text-end"},"Amount"),t("th",null,"Status"),t("th",null,"Due Date"),t("th",null,"Actions")])],-1)),t("tbody",null,[(_(!0),m(R,null,G(b.value,o=>(_(),m("tr",{key:o.id,class:"nano-table-row"},[t("td",St,"#"+i(o.id),1),t("td",null,[t("div",Tt,i(o.customer_name),1),t("div",Dt,i(o.customer_phone),1)]),t("td",Ft,i(A(o.total_amount||0)),1),t("td",null,[e(a(S),{color:N(o.status),shape:"rounded-pill",class:"px-3"},{default:l(()=>{var v;return[y(i((v=o.status)==null?void 0:v.toUpperCase()),1)]}),_:2},1032,["color"])]),t("td",null,i(new Date(o.due_date).toLocaleDateString()),1),t("td",null,[t("div",Vt,[e(a(h),{size:"sm",color:"info",variant:"ghost",onClick:v=>$(o)},{default:l(()=>[e(a(c),{icon:"cil-external-link"})]),_:1},8,["onClick"]),e(a(h),{size:"sm",color:"primary",variant:"ghost",onClick:v=>B()},{default:l(()=>[e(a(c),{icon:"cil-print"})]),_:1},8,["onClick"])])])]))),128))])])]),r.value.total_pages>1?(_(),m("div",Nt,[e(a(H),{pages:r.value.total_pages,"active-page":r.value.current_page,"onUpdate:activePage":V},null,8,["pages","active-page"])])):W("",!0)]))]),e(X,{"page-key":"invoices"})]))}},Ht=Z(At,[["__scopeId","data-v-ded7521b"]]);export{Ht as default};
