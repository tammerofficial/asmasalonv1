import{f as v,j as Y,c as u,o as d,b as s,d as t,t as a,u as e,w as i,Y as S,s as Z,a as k,x as h,C as c,Z as q,h as D,F as N,g as P,$ as J,l as O,P as m,z as $,a1 as B,a2 as M,aa as Q,ab as X,a3 as ee,a4 as se}from"../chunk-vendor-vue-VAxhpvd9.js";import{u as te,a as A}from"../chunk-component-NotificationsBell-CTLJWkW4.js";import"../chunk-view-AppleWallet/Simulator-BwS6bEkK.js";import{H as ae}from"../chunk-component-HelpSection-NeetTt3d.js";import{_ as le}from"../chunk-component-Card-DPM96EeB.js";import"../chunk-vendor-Ltsl4QyH.js";import"../chunk-vendor-pinia-CjQxP09R.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-PageHeader-CMYNL4hu.js";const oe={class:"memberships-page p-4"},ne={class:"pos-header-top d-flex justify-content-between align-items-center mb-4"},ie={class:"header-left d-flex align-items-center gap-3"},ce={class:"mb-0 fw-bold text-primary"},re={class:"header-right d-flex gap-2"},de={class:"nano-stats-bar mb-4"},me={class:"stat-icon-bg plans"},ue={class:"stat-info"},pe={class:"stat-value"},ve={class:"stat-label"},_e={class:"stat-icon-bg members"},he={class:"stat-info"},be={class:"stat-value text-info"},fe={class:"stat-label"},ge={class:"stat-card-nano"},ye={class:"stat-icon-bg revenue"},ke={class:"stat-info"},xe={class:"stat-label"},Ce={class:"stat-card-nano"},we={class:"stat-icon-bg expiring"},Se={class:"stat-info"},Me={class:"stat-label"},Te={class:"nano-panel"},Ie={key:0},Fe={key:0,class:"text-center p-5"},Ve={key:1,class:"nano-grid"},De=["onClick"],Ne={class:"plan-badge"},Pe={class:"plan-icon"},$e={class:"fw-bold mb-2"},Be={class:"plan-price text-primary h2 fw-bold mb-3"},Ae={class:"plan-features d-flex flex-column gap-2 mb-4"},Le={class:"feature-item"},We={class:"feature-item"},ze={key:0,class:"feature-item"},Re={key:1},Ue={class:"nano-filters-bar p-3 bg-tertiary rounded-4 mb-4"},je={value:""},Ge={value:"active"},He={value:"expired"},Ke={key:0,class:"text-center p-5"},Ee={key:1,class:"nano-table-container"},Ye={class:"nano-table w-100"},Ze={class:"text-start"},qe={class:"text-start fw-bold"},Je={__name:"Index",setup(Oe){const{t:o}=te(),L=O(),_=v("plans"),x=v(!1),C=v(!1),f=v([]),g=v([]),T=v(null),I=v({total:0,active:0}),F=v({total:0,active:0}),b=v({search:"",status:""}),W=v({current_page:1,total_pages:1}),z=async()=>{var p,n,l;x.value=!0;try{const r=await A.get("/memberships/plans");f.value=((n=(p=r.data)==null?void 0:p.data)==null?void 0:n.items)||((l=r.data)==null?void 0:l.items)||[],I.value={total:f.value.length,active:f.value.filter(w=>w.is_active).length}}catch(r){console.error("Failed to load plans:",r)}finally{x.value=!1}},y=async()=>{var p,n,l;C.value=!0;try{const r=await A.get("/memberships/members",{params:{...b.value,page:W.current_page}});g.value=((n=(p=r.data)==null?void 0:p.data)==null?void 0:n.items)||((l=r.data)==null?void 0:l.items)||[],F.value={total:g.value.length,active:g.value.filter(w=>w.status==="active").length}}catch(r){console.error("Failed to load members:",r)}finally{C.value=!1}},R=()=>{clearTimeout(window.mSearchTimer),window.searchTimer=setTimeout(y,500)},U=()=>{b.value={search:"",status:""},y()},j=p=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",minimumFractionDigits:3}).format(p||0),V=(p=null)=>{},G=()=>{},H=()=>L.push("/settings/memberships"),K=()=>{},E=p=>{T.value=p.id};return Y(()=>{z(),y()}),(p,n)=>(d(),u("div",oe,[s("div",ne,[s("div",ie,[s("h2",ce,a(e(o)("memberships.title")),1),t(e(S),{color:"gold",shape:"rounded-pill",class:"px-3 py-2 fw-bold text-dark"},{default:i(()=>[t(e(c),{icon:"cil-credit-card",class:"me-1"}),m(" "+a(e(o)("memberships.premiumAccess")),1)]),_:1})]),s("div",re,[T.value?(d(),Z(e(h),{key:0,color:"success",class:"nano-btn-success",onClick:K},{default:i(()=>[t(e(c),{icon:"cil-wallet",class:"me-2"}),m(a(e(o)("memberships.addToAppleWallet")),1)]),_:1})):k("",!0),t(e(h),{color:"primary",variant:"outline",class:"nano-btn-outline",onClick:G},{default:i(()=>[t(e(c),{icon:"cil-user-follow",class:"me-2"}),m(a(e(o)("memberships.assign")),1)]),_:1}),t(e(h),{color:"primary",class:"nano-btn",onClick:n[0]||(n[0]=l=>V())},{default:i(()=>[t(e(c),{icon:"cil-plus",class:"me-2"}),m(a(e(o)("memberships.newPlan")),1)]),_:1}),t(e(h),{color:"secondary",variant:"ghost",onClick:H},{default:i(()=>[t(e(c),{icon:"cil-settings"})]),_:1})])]),s("div",de,[s("div",{class:"stat-card-nano clickable",onClick:n[1]||(n[1]=l=>_.value="plans")},[s("div",me,[t(e(c),{icon:"cil-layers"})]),s("div",ue,[s("div",pe,a(I.value.total),1),s("div",ve,a(e(o)("memberships.activePlans")),1)])]),s("div",{class:"stat-card-nano clickable",onClick:n[2]||(n[2]=l=>_.value="members")},[s("div",_e,[t(e(c),{icon:"cil-people"})]),s("div",he,[s("div",be,a(F.value.total),1),s("div",fe,a(e(o)("memberships.totalMembers")),1)])]),s("div",ge,[s("div",ye,[t(e(c),{icon:"cil-money"})]),s("div",ke,[n[7]||(n[7]=s("div",{class:"stat-value text-success"},"1,250",-1)),s("div",xe,a(e(o)("memberships.membershipRevenue")),1)])]),s("div",Ce,[s("div",we,[t(e(c),{icon:"cil-clock"})]),s("div",Se,[n[8]||(n[8]=s("div",{class:"stat-value text-warning"},"12",-1)),s("div",Me,a(e(o)("memberships.expiringSoon")),1)])])]),t(e(q),{variant:"pills",class:"nano-tabs mb-4"},{default:i(()=>[t(e($),null,{default:i(()=>[t(e(B),{active:_.value==="plans",onClick:n[3]||(n[3]=l=>_.value="plans"),class:"nano-tab-link"},{default:i(()=>[t(e(c),{icon:"cil-layers",class:"me-2"}),m(a(e(o)("memberships.plansTab")),1)]),_:1},8,["active"])]),_:1}),t(e($),null,{default:i(()=>[t(e(B),{active:_.value==="members",onClick:n[4]||(n[4]=l=>_.value="members"),class:"nano-tab-link"},{default:i(()=>[t(e(c),{icon:"cil-people",class:"me-2"}),m(a(e(o)("memberships.membersTab")),1)]),_:1},8,["active"])]),_:1})]),_:1}),s("div",Te,[_.value==="plans"?(d(),u("div",Ie,[x.value?(d(),u("div",Fe,[t(e(D),{color:"primary"})])):(d(),u("div",Ve,[(d(!0),u(N,null,P(f.value,l=>(d(),u("div",{key:l.id,class:"membership-plan-card",onClick:r=>V(l)},[s("div",Ne,a(l.is_active?e(o)("status.active"):e(o)("status.inactive")),1),s("div",Pe,[t(e(c),{icon:"cil-gem",size:"xl"})]),s("h4",$e,a(l.name_ar||l.name),1),s("div",Be,a(j(l.price||0)),1),s("div",Ae,[s("div",Le,[t(e(c),{icon:"cil-check-circle",class:"text-success me-2"}),m(" "+a(l.duration_months)+" "+a(e(o)("common.months")),1)]),s("div",We,[t(e(c),{icon:"cil-check-circle",class:"text-success me-2"}),m(" "+a(l.discount_percent)+"% "+a(e(o)("memberships.offServices")),1)]),l.free_services_count>0?(d(),u("div",ze,[t(e(c),{icon:"cil-check-circle",class:"text-success me-2"}),m(" "+a(l.free_services_count)+" "+a(e(o)("memberships.freeServices")),1)])):k("",!0)]),t(e(h),{color:"primary",variant:"ghost",class:"w-100 mt-auto"},{default:i(()=>[m(a(e(o)("memberships.editPlan")),1)]),_:1})],8,De))),128))]))])):k("",!0),_.value==="members"?(d(),u("div",Re,[s("div",Ue,[t(e(J),{class:"g-3 align-items-center"},{default:i(()=>[t(e(M),{md:"6"},{default:i(()=>[t(e(Q),null,{default:i(()=>[t(e(X),{class:"bg-transparent border-0"},{default:i(()=>[t(e(c),{icon:"cil-magnifying-glass"})]),_:1}),t(e(ee),{modelValue:b.value.search,"onUpdate:modelValue":n[5]||(n[5]=l=>b.value.search=l),placeholder:e(o)("memberships.searchMembers"),onInput:R,class:"border-0 bg-transparent"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),t(e(M),{md:"3"},{default:i(()=>[t(e(se),{modelValue:b.value.status,"onUpdate:modelValue":n[6]||(n[6]=l=>b.value.status=l),onChange:y,class:"rounded-3"},{default:i(()=>[s("option",je,a(e(o)("memberships.allMembers")),1),s("option",Ge,a(e(o)("status.active")),1),s("option",He,a(e(o)("status.expired")),1)]),_:1},8,["modelValue"])]),_:1}),t(e(M),{md:"3"},{default:i(()=>[t(e(h),{color:"secondary",variant:"ghost",class:"w-100",onClick:U},{default:i(()=>[m(a(e(o)("common.reset")),1)]),_:1})]),_:1})]),_:1})]),C.value?(d(),u("div",Ke,[t(e(D),{color:"primary"})])):(d(),u("div",Ee,[s("table",Ye,[s("thead",null,[s("tr",null,[s("th",Ze,a(e(o)("common.customer")),1),s("th",null,a(e(o)("memberships.plan")),1),s("th",null,a(e(o)("common.startDate")),1),s("th",null,a(e(o)("common.expiryDate")),1),s("th",null,a(e(o)("common.status")),1),s("th",null,a(e(o)("common.actions")),1)])]),s("tbody",null,[(d(!0),u(N,null,P(g.value,l=>(d(),u("tr",{key:l.id,class:"nano-table-row"},[s("td",qe,a(l.customer_name),1),s("td",null,[t(e(S),{color:"primary",shape:"rounded-pill"},{default:i(()=>[m(a(l.plan_name),1)]),_:2},1024)]),s("td",null,a(new Date(l.start_date).toLocaleDateString()),1),s("td",null,a(new Date(l.expiry_date).toLocaleDateString()),1),s("td",null,[t(e(S),{color:l.status==="active"?"success":"danger"},{default:i(()=>{var r;return[m(a((r=l.status)==null?void 0:r.toUpperCase()),1)]}),_:2},1032,["color"])]),s("td",null,[t(e(h),{size:"sm",color:"info",variant:"ghost",onClick:r=>E(l)},{default:i(()=>[t(e(c),{icon:"cil-info"})]),_:1},8,["onClick"])])]))),128))])])]))])):k("",!0)]),t(ae,{"page-key":"memberships"})]))}},is=le(Je,[["__scopeId","data-v-e110e3a0"]]);export{is as default};
