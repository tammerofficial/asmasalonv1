import{f as v,g as ae,w as st,i as at,af as ot,c as d,o as r,d as i,b as l,p as c,u as e,s as w,a as h,Z as pe,Y as oe,P as p,C as y,t as n,x as S,F as U,k as $,n as Se,a0 as Z,ai as lt,z as Pe,al as qe,a2 as nt,a3 as it,a1 as N}from"../chunk-vendor-vue-CVODRAc9.js";import{u as rt,a as E,c as Ve}from"../chunk-component-NotificationsBell-BlaTfaiw.js";import{a as ct}from"../chunk-view-Bookings/BookingAppearance-Vn9NL_13.js";import{P as ut}from"../chunk-component-PageHeader-DIMefZ9l.js";import{_ as dt,C as A}from"../chunk-component-Card-DAbGoLxt.js";import{E as le}from"../chunk-component-EmptyState-B8o9iOHP.js";import{L as me}from"../chunk-component-LoadingSpinner-DYzABkFM.js";import{X as vt}from"../chunk-vendor-6xaPOP3o.js";import"../chunk-vendor-charts-C66rl4lP.js";import"../chunk-vendor-pinia-DSPKUyr1.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-Sidebar-ChD_VDDH.js";import"../chunk-view-Bookings/BookingFormPreview-CiRU9DIL.js";class pt extends vt{constructor(){super("asmaa_pos_offline"),this.version(1).stores({pending_orders:"client_side_id, created_at, sync_attempts",cart_sessions:"session_id, customer_id, created_at"})}}const F=new pt;function Ne(){return"pos_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}function Ie(){let b=sessionStorage.getItem("pos_cart_session_id");return b||(b=Ne(),sessionStorage.setItem("pos_cart_session_id",b)),b}async function Oe(b,o=null){o||(o=sessionStorage.getItem("pos_cart_session_id")||Ne());const m={client_side_id:o,order_data:b,created_at:new Date().toISOString(),sync_attempts:0,last_sync_attempt:null};return await F.pending_orders.put(m),o}async function mt(){return await F.pending_orders.orderBy("created_at").toArray()}async function _t(b){await F.pending_orders.delete(b)}async function ft(b,o){{const m=await F.pending_orders.get(b);m&&await F.pending_orders.update(b,{sync_attempts:(m.sync_attempts||0)+1,last_sync_attempt:new Date().toISOString()})}}async function yt(){return await F.pending_orders.count()}async function gt(b){var m,q,O;const o=await mt();if(o.length===0)return{synced:0,failed:0,results:[]};try{const _=await b.post("/pos/sync-pending",{orders:o.map(C=>({client_side_id:C.client_side_id,order_data:C.order_data}))}),P=((m=_.data)==null?void 0:m.results)||[],B=((q=_.data)==null?void 0:q.synced)||0,x=((O=_.data)==null?void 0:O.failed)||0;for(const C of P)C.success?await _t(C.client_side_id):await ft(C.client_side_id,!1);return{synced:B,failed:x,results:P}}catch(_){return console.error("Error syncing pending orders:",_),{synced:0,failed:o.length,results:[]}}}const ht={class:"pos-page"},bt={class:"pos-layout"},kt={class:"pos-column pos-column-1"},Ct={key:2,class:"active-customers-list"},wt=["onClick"],St={class:"customer-avatar"},Pt={class:"customer-info"},qt={class:"customer-name"},Vt={class:"customer-meta"},It={class:"customer-service"},Ot={key:0,class:"customer-staff"},Nt={key:1,class:"customer-time"},Et={value:""},xt=["value"],Lt={class:"pos-column pos-column-2"},Ut={key:2,class:"items-grid"},$t=["onClick"],Mt={class:"item-name"},Tt={class:"item-price"},Dt={key:0,class:"item-category"},At={key:2,class:"items-grid"},Ft=["onClick"],Bt={class:"item-name"},zt={class:"item-price"},Kt={key:0,class:"item-stock"},Qt={key:1,class:"item-sku"},Wt={class:"pos-column pos-column-3"},Rt={class:"cart-customer mb-3"},Gt={class:"form-label"},Ht={value:""},Xt=["value"],Yt={class:"cart-items"},Zt={key:1,class:"cart-items-list"},jt={class:"cart-item-info"},Jt={class:"cart-item-name"},es={key:0,class:"cart-item-meta"},ts={class:"cart-item-actions"},ss={class:"cart-item-quantity"},as={class:"quantity-value"},os={class:"cart-item-price"},ls={class:"cart-summary"},ns={class:"summary-row"},is={key:0,class:"summary-row"},rs={class:"text-success"},cs={class:"summary-row"},us={class:"summary-row total-row"},ds={class:"total-amount"},vs={class:"payment-method mb-3"},ps={class:"form-label"},ms={value:"cash"},_s={value:"card"},fs={value:"knet"},ys={class:"cart-actions"},gs={key:0},hs={class:"mb-3"},bs={class:"form-label"},ks={class:"mb-3"},Cs={class:"form-label"},ws={class:"mb-3"},Ss={class:"form-label"},Ps={value:""},qs=["value"],Vs={class:"mb-3"},Is={class:"form-label"},Os={key:0},Ns={class:"mb-3"},Es={class:"form-label"},xs={class:"mb-3"},Ls={class:"form-label"},Us={class:"mb-3"},$s={class:"form-label"},Ms={class:"mb-3"},Ts={class:"form-label"},Ds={value:""},As=["value"],Fs={class:"mb-3"},Bs={class:"form-label"},zs={key:0},Ks={class:"mb-3"},Qs={class:"mb-3"},Ws={class:"mb-3"},Rs={class:"mb-3"},Gs={__name:"Index",setup(b){const{t:o}=rt(),m=ct(),q=v("services"),O=v(""),_=v(null),P=v(0),B=v("cash"),x=v(!1),C=v(navigator.onLine),z=v(0),M=v(0),j=v([]),J=v([]),T=v([]),K=v([]),ee=v([]),L=v(null),ne=v(!1),ie=v(!1),re=v(!1),f=v([]),Q=v(!1),W=v(!1),te=v(!1),V=v(null),g=v(null),R=v(""),G=v(""),se=v(1),D=v(1),_e=ae(()=>{if(!O.value)return J.value;const a=O.value.toLowerCase();return J.value.filter(s=>(s.name_ar||s.name||"").toLowerCase().includes(a)||(s.category||"").toLowerCase().includes(a))}),fe=ae(()=>{if(!O.value)return j.value.filter(s=>(s.stock_quantity||0)>0);const a=O.value.toLowerCase();return j.value.filter(s=>((s.name_ar||s.name||"").toLowerCase().includes(a)||(s.sku||"").toLowerCase().includes(a)||(s.barcode||"").toLowerCase().includes(a))&&(s.stock_quantity||0)>0)}),ce=ae(()=>f.value.reduce((a,s)=>a+s.unit_price*s.quantity,0)),Ee=ae(()=>Math.max(0,ce.value-P.value-M.value)),I=a=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",minimumFractionDigits:3}).format(a||0),xe=a=>a?new Date(a).toLocaleString("en-US"):"-",Le=a=>a?new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",Ue=a=>a!=null&&a.booking_start_at?Le(a.booking_start_at):a!=null&&a.booking_time&&typeof a.booking_time=="string"?a.booking_time.slice(0,5):"",$e=()=>{},Me=a=>{if(_.value=a?Number(a):null,window.innerWidth<1200){const s=document.querySelector(".pos-column-3");s&&s.scrollIntoView({behavior:"smooth",block:"start"})}},ye=()=>{_.value&&K.value.find(a=>Number(a.id)===Number(_.value))},Te=a=>{V.value=a,R.value="",se.value=1,Q.value=!0},De=a=>{if((a.stock_quantity||0)<=0){m.error(o("pos.noProducts"));return}g.value=a,G.value="",D.value=1,W.value=!0},ge=()=>_.value?!0:(m.error(o("pos.selectCustomer")),!1),Ae=(a,s)=>{if(ge()){if(s!=null&&s.shiftKey){Te(a);return}f.value.push({type:"service",service_id:a.id,name:a.name_ar||a.name,quantity:1,unit_price:parseFloat(a.price||0),staff_id:null,staff_name:""})}},Fe=(a,s)=>{if(ge()){if((a.stock_quantity||0)<=0){m.error(o("pos.noProducts"));return}if(s!=null&&s.shiftKey){De(a);return}f.value.push({type:"product",product_id:a.id,name:a.name_ar||a.name,quantity:1,unit_price:parseFloat(a.selling_price||a.price||0),staff_id:null,staff_name:""})}},Be=()=>{if(!V.value)return;const a=T.value.find(t=>t.id==R.value),s=a?a.name:"";f.value.push({type:"service",service_id:V.value.id,name:V.value.name_ar||V.value.name+(s?` (${s})`:""),quantity:se.value,unit_price:parseFloat(V.value.price||0),staff_id:R.value||null,staff_name:s}),Q.value=!1},ze=()=>{if(!g.value)return;if(D.value>(g.value.stock_quantity||0)){m.error(o("pos.noProducts"));return}const a=T.value.find(t=>t.id==G.value),s=a?a.name:"";f.value.push({type:"product",product_id:g.value.id,name:g.value.name_ar||g.value.name+(s?` (${s})`:""),quantity:D.value,unit_price:parseFloat(g.value.selling_price||g.value.price||0),staff_id:G.value||null,staff_name:s}),W.value=!1},Ke=a=>{f.value[a].quantity++},Qe=a=>{f.value[a].quantity>1&&f.value[a].quantity--},We=a=>{f.value.splice(a,1)},Re=()=>{confirm(o("pos.clearCart")+"?")&&(f.value=[],P.value=0)},he=()=>{},Ge=async()=>{var s,t,u,X,we;if(f.value.length===0){m.error(o("pos.emptyCart"));return}const a=Ie();x.value=!0;try{const Y={customer_id:_.value?Number(_.value):null,items:f.value.map(k=>({service_id:k.service_id||null,product_id:k.product_id||null,staff_id:k.staff_id||null,quantity:k.quantity,unit_price:k.unit_price,name:k.name})),payment_method:B.value,discount:P.value||0,client_side_id:a};if(!C.value){await Oe(Y,a),m.warning(o("pos.orderSavedOffline")||"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø­Ù„ÙŠØ§Ù‹. Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø¹ÙˆØ¯Ø© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª."),await H(),f.value=[],P.value=0,x.value=!1;return}try{const k=await E.post("/pos/process",Y);if((s=k.data)!=null&&s.success){const ve=((t=k.data)==null?void 0:t.data)||{},et=ve.order_number||"N/A",tt=ve.invoice_number||ve.invoice_id||"N/A";m.success(`${o("pos.orderProcessed")} ${et} | Invoice: ${tt}`),sessionStorage.removeItem("pos_cart_session_id"),f.value=[],P.value=0,he(),Ve("/invoices"),Ve("/payments"),await ue(),await H()}else m.error(((u=k.data)==null?void 0:u.message)||o("pos.errorProcessing"))}catch(k){console.error("Error processing order:",k),!k.response||k.code==="ERR_NETWORK"?(await Oe(Y,a),m.warning(o("pos.orderSavedOffline")||"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø­Ù„ÙŠØ§Ù‹. Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø¹ÙˆØ¯Ø© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª."),await H(),f.value=[],P.value=0):m.error(((we=(X=k.response)==null?void 0:X.data)==null?void 0:we.message)||o("pos.errorProcessing"))}finally{x.value=!1}}catch(Y){console.error("Error in processOrder:",Y),m.error(o("pos.errorProcessing")||"Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨"),x.value=!1}},He=async()=>{var a,s,t;ne.value=!0;try{const u=await E.get("/products",{params:{per_page:1e3,is_active:1}});j.value=((s=(a=u.data)==null?void 0:a.data)==null?void 0:s.items)||((t=u.data)==null?void 0:t.items)||[]}catch(u){console.error("Error loading products:",u),j.value=[]}finally{ne.value=!1}},Xe=async()=>{var a,s,t;ie.value=!0;try{const u=await E.get("/services",{params:{per_page:1e3,is_active:1}});J.value=((s=(a=u.data)==null?void 0:a.data)==null?void 0:s.items)||((t=u.data)==null?void 0:t.items)||[]}catch(u){console.error("Error loading services:",u),J.value=[]}finally{ie.value=!1}},Ye=async()=>{var a,s,t;try{const u=await E.get("/staff",{params:{per_page:1e3,status:"active"}});T.value=((s=(a=u.data)==null?void 0:a.data)==null?void 0:s.items)||((t=u.data)==null?void 0:t.items)||[]}catch(u){console.error("Error loading staff:",u),T.value=[]}},Ze=async()=>{var a,s,t;try{const u=await E.get("/customers",{params:{per_page:1e3}});K.value=((s=(a=u.data)==null?void 0:a.data)==null?void 0:s.items)||((t=u.data)==null?void 0:t.items)||[]}catch(u){console.error("Error loading customers:",u),K.value=[]}},be=async()=>{var a;re.value=!0;try{const s=await E.get("/pos"),t=((a=s.data)==null?void 0:a.data)||s.data||{};ee.value=t.active_customers||[]}catch(s){console.error("Error loading active customers:",s),ee.value=[]}finally{re.value=!1}},je=async()=>{var a;try{const s=await E.get("/pos/session");L.value=((a=s.data)==null?void 0:a.data)||s.data||null}catch(s){console.error("Error loading session:",s),L.value=null}},ue=async()=>{await Promise.all([He(),Xe(),Ye(),Ze(),be(),je()]),m.success(o("pos.refresh")+" - "+o("common.refresh"))},H=async()=>{try{z.value=await yt()}catch(a){console.error("Error getting pending orders count:",a)}},de=async()=>{if(C.value)try{const a=await gt(E);a.synced>0&&(m.success(o("pos.ordersSynced",{count:a.synced})),await H())}catch(a){console.error("Error syncing pending orders:",a)}},Je=async()=>{var a,s;if(!_.value){M.value=0;return}try{const t=await E.get(`/pos/prepaid/${_.value}`);(a=t.data)!=null&&a.success&&(M.value=((s=t.data.data)==null?void 0:s.total_prepaid)||0)}catch(t){console.error("Error loading prepaid amount:",t),M.value=0}};st(_,()=>{_.value?Je():M.value=0});const ke=()=>{C.value=!0,de()},Ce=()=>{C.value=!1,m.warning(o("pos.offlineMode"))};return at(()=>{Ie(),H(),window.addEventListener("online",ke),window.addEventListener("offline",Ce),ue(),setInterval(()=>{C.value&&z.value>0&&de()},3e4),setInterval(()=>{be()},1e4)}),ot(()=>{window.removeEventListener("online",ke),window.removeEventListener("offline",Ce)}),(a,s)=>(r(),d("div",ht,[i(ut,{title:e(o)("pos.title"),subtitle:e(o)("pos.subtitle")},{icon:c(()=>[i(e(y),{icon:"cil-cart"})]),actions:c(()=>[C.value?h("",!0):(r(),w(e(oe),{key:0,color:"warning",class:"me-2 align-self-center"},{default:c(()=>[i(e(y),{icon:"cil-wifi-slash",class:"me-1"}),p(" "+n(e(o)("pos.offline")||"Offline"),1)]),_:1})),z.value>0?(r(),w(e(oe),{key:1,color:"info",class:"me-2 align-self-center"},{default:c(()=>[i(e(y),{icon:"cil-cloud-upload",class:"me-1"}),p(" "+n(z.value)+" "+n(e(o)("pos.pendingOrders")||"Pending"),1)]),_:1})):h("",!0),L.value?(r(),w(e(S),{key:2,color:"primary",variant:"outline",onClick:s[0]||(s[0]=t=>te.value=!0),class:"me-2"},{default:c(()=>[i(e(y),{icon:"cil-info",class:"me-2"}),p(" "+n(e(o)("pos.sessionInfo")),1)]),_:1})):h("",!0),i(e(S),{color:"primary",variant:"outline",onClick:ue,class:"me-2"},{default:c(()=>[i(e(y),{icon:"cil-reload",class:"me-2"}),p(" "+n(e(o)("pos.refresh")),1)]),_:1}),z.value>0&&C.value?(r(),w(e(S),{key:3,color:"success",variant:"outline",onClick:de,class:"me-2"},{default:c(()=>[i(e(y),{icon:"cil-sync",class:"me-2"}),p(" "+n(e(o)("pos.syncPending")||"Sync Pending"),1)]),_:1})):h("",!0)]),_:1},8,["title","subtitle"]),l("div",bt,[l("div",kt,[i(A,{title:e(o)("pos.activeCustomers"),icon:"cil-people",class:"h-100"},{footer:c(()=>[i(e(Z),{modelValue:_.value,"onUpdate:modelValue":s[1]||(s[1]=t=>_.value=t),modelModifiers:{number:!0},placeholder:e(o)("pos.selectCustomer"),onChange:ye},{default:c(()=>[l("option",Et,n(e(o)("pos.selectCustomer")),1),(r(!0),d(U,null,$(K.value,t=>(r(),d("option",{key:t.id,value:t.id},n(t.name_ar||t.name)+" - "+n(t.phone),9,xt))),128))]),_:1},8,["modelValue","placeholder"])]),default:c(()=>[re.value?(r(),w(me,{key:0,text:e(o)("common.loading")},null,8,["text"])):ee.value.length===0?(r(),w(le,{key:1,title:e(o)("pos.noActiveCustomers"),description:e(o)("pos.noActiveCustomersDesc"),"icon-color":"gray"},null,8,["title","description"])):(r(),d("div",Ct,[(r(!0),d(U,null,$(ee.value,t=>(r(),d("div",{key:t.id,class:Se(["active-customer-item",{selected:Number(_.value)===Number(t.id)}]),onClick:u=>Me(t.id)},[l("div",St,[i(e(y),{icon:"cil-user"})]),l("div",Pt,[l("div",qt,n(t.name),1),l("div",Vt,[i(e(oe),{color:"primary",class:"me-2"},{default:c(()=>[p(n(t.type==="queue"?t.ticket_number?`#${t.ticket_number}`:e(o)("queue.title"):e(o)("bookings.title")),1)]),_:2},1024),l("span",It,n(t.current_service||"N/A"),1)]),t.staff_name&&t.staff_name!=="Unassigned"?(r(),d("div",Ot,[i(e(y),{icon:"cil-user",class:"me-1"}),p(" "+n(t.staff_name),1)])):h("",!0),t.booking_start_at||t.booking_time?(r(),d("div",Nt,[i(e(y),{icon:"cil-clock",class:"me-1"}),p(" "+n(Ue(t)),1)])):h("",!0)])],10,wt))),128))]))]),_:1},8,["title"])]),l("div",Lt,[i(A,null,{default:c(()=>[i(e(lt),{variant:"tabs",role:"tablist"},{default:c(()=>[i(e(Pe),null,{default:c(()=>[i(e(qe),{active:q.value==="services",onClick:s[2]||(s[2]=t=>q.value="services"),role:"tab"},{default:c(()=>[i(e(y),{icon:"cil-spreadsheet",class:"me-2"}),p(" "+n(e(o)("pos.services")),1)]),_:1},8,["active"])]),_:1}),i(e(Pe),null,{default:c(()=>[i(e(qe),{active:q.value==="products",onClick:s[3]||(s[3]=t=>q.value="products"),role:"tab"},{default:c(()=>[i(e(y),{icon:"cil-basket",class:"me-2"}),p(" "+n(e(o)("pos.products")),1)]),_:1},8,["active"])]),_:1})]),_:1})]),_:1}),i(A,null,{default:c(()=>[i(e(nt),null,{default:c(()=>[i(e(it),null,{default:c(()=>[i(e(y),{icon:"cil-magnifying-glass"})]),_:1}),i(e(N),{modelValue:O.value,"onUpdate:modelValue":s[4]||(s[4]=t=>O.value=t),placeholder:q.value==="services"?e(o)("pos.searchService"):e(o)("pos.searchProduct"),onInput:$e},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),q.value==="services"?(r(),w(A,{key:0,title:e(o)("pos.services"),icon:"cil-spreadsheet"},{default:c(()=>[ie.value?(r(),w(me,{key:0,text:e(o)("common.loading")},null,8,["text"])):_e.value.length===0?(r(),w(le,{key:1,title:e(o)("pos.noServices"),description:e(o)("pos.noServices"),"icon-color":"gray"},null,8,["title","description"])):(r(),d("div",Ut,[(r(!0),d(U,null,$(_e.value,t=>(r(),d("div",{key:t.id,class:"item-card",onClick:u=>Ae(t,u)},[l("div",Mt,n(t.name_ar||t.name),1),l("div",Tt,n(I(t.price||0)),1),t.category?(r(),d("div",Dt,[i(e(y),{icon:"cil-tag",class:"me-1"}),p(" "+n(t.category),1)])):h("",!0)],8,$t))),128))]))]),_:1},8,["title"])):h("",!0),q.value==="products"?(r(),w(A,{key:1,title:e(o)("pos.products"),icon:"cil-basket"},{default:c(()=>[ne.value?(r(),w(me,{key:0,text:e(o)("common.loading")},null,8,["text"])):fe.value.length===0?(r(),w(le,{key:1,title:e(o)("pos.noProducts"),description:e(o)("pos.noProducts"),"icon-color":"gray"},null,8,["title","description"])):(r(),d("div",At,[(r(!0),d(U,null,$(fe.value,t=>(r(),d("div",{key:t.id,class:Se(["item-card",{"out-of-stock":(t.stock_quantity||0)<=0}]),onClick:u=>Fe(t,u)},[l("div",Bt,n(t.name_ar||t.name),1),l("div",zt,n(I(t.selling_price||t.price||0)),1),t.stock_quantity!==void 0?(r(),d("div",Kt,[i(e(oe),{color:"primary"},{default:c(()=>[p(n(e(o)("products.stock"))+": "+n(t.stock_quantity),1)]),_:2},1024)])):h("",!0),t.sku?(r(),d("div",Qt,[l("small",null,"SKU: "+n(t.sku),1)])):h("",!0)],10,Ft))),128))]))]),_:1},8,["title"])):h("",!0)]),l("div",Wt,[i(A,{title:e(o)("pos.cart"),icon:"cil-cart",class:"h-100"},{default:c(()=>[l("div",Rt,[l("label",Gt,n(e(o)("pos.customer")),1),i(e(Z),{modelValue:_.value,"onUpdate:modelValue":s[5]||(s[5]=t=>_.value=t),modelModifiers:{number:!0},onChange:ye},{default:c(()=>[l("option",Ht,n(e(o)("pos.walkInCustomer")),1),(r(!0),d(U,null,$(K.value,t=>(r(),d("option",{key:t.id,value:t.id},n(t.name_ar||t.name),9,Xt))),128))]),_:1},8,["modelValue"])]),l("div",Yt,[f.value.length===0?(r(),w(le,{key:0,title:e(o)("pos.emptyCart"),description:e(o)("pos.emptyCartDesc"),"icon-color":"gray"},null,8,["title","description"])):(r(),d("div",Zt,[(r(!0),d(U,null,$(f.value,(t,u)=>(r(),d("div",{key:u,class:"cart-item"},[l("div",jt,[l("div",Jt,n(t.name),1),t.staff_name?(r(),d("div",es,[i(e(y),{icon:"cil-user",class:"me-1"}),p(" "+n(t.staff_name),1)])):h("",!0)]),l("div",ts,[l("div",ss,[i(e(S),{color:"primary",size:"sm",variant:"outline",onClick:X=>Qe(u)},{default:c(()=>[i(e(y),{icon:"cil-minus"})]),_:1},8,["onClick"]),l("span",as,n(t.quantity),1),i(e(S),{color:"primary",size:"sm",variant:"outline",onClick:X=>Ke(u)},{default:c(()=>[i(e(y),{icon:"cil-plus"})]),_:1},8,["onClick"])]),l("div",os,n(I(t.unit_price*t.quantity)),1),i(e(S),{color:"primary",size:"sm",variant:"ghost",onClick:X=>We(u)},{default:c(()=>[i(e(y),{icon:"cil-trash"})]),_:1},8,["onClick"])])]))),128))]))]),l("div",ls,[l("div",ns,[l("span",null,n(e(o)("pos.subtotal"))+":",1),l("strong",null,n(I(ce.value)),1)]),M.value>0?(r(),d("div",is,[l("span",null,n(e(o)("pos.prepaid")||"Ø§Ù„Ù…Ø¯ÙÙˆØ¹ Ù…Ø³Ø¨Ù‚Ø§Ù‹")+":",1),l("strong",rs,"-"+n(I(M.value)),1)])):h("",!0),l("div",cs,[l("span",null,n(e(o)("pos.discount"))+":",1),i(e(N),{modelValue:P.value,"onUpdate:modelValue":s[6]||(s[6]=t=>P.value=t),modelModifiers:{number:!0},type:"number",step:"0.001",min:"0",max:ce.value,onInput:he,class:"discount-input"},null,8,["modelValue","max"])]),l("div",us,[l("span",null,n(e(o)("pos.total"))+":",1),l("strong",ds,n(I(Ee.value)),1)])]),l("div",vs,[l("label",ps,n(e(o)("pos.paymentMethod")),1),i(e(Z),{modelValue:B.value,"onUpdate:modelValue":s[7]||(s[7]=t=>B.value=t)},{default:c(()=>[l("option",ms,"ðŸ’µ "+n(e(o)("pos.cash")),1),l("option",_s,"ðŸ’³ "+n(e(o)("pos.card")),1),l("option",fs,"ðŸ§ "+n(e(o)("pos.knet")),1)]),_:1},8,["modelValue"])]),l("div",ys,[i(e(S),{color:"primary",variant:"outline",onClick:Re,class:"w-100 mb-2",disabled:f.value.length===0},{default:c(()=>[i(e(y),{icon:"cil-trash",class:"me-2"}),p(" "+n(e(o)("pos.clearCart")),1)]),_:1},8,["disabled"]),i(e(S),{color:"primary",onClick:Ge,class:"w-100",disabled:f.value.length===0||x.value},{default:c(()=>[i(e(y),{icon:"cil-check-circle",class:"me-2"}),p(" "+n(x.value?e(o)("pos.processing"):e(o)("pos.processOrder")),1)]),_:1},8,["disabled"])])]),_:1},8,["title"])])]),i(e(pe),{visible:Q.value,"onUpdate:visible":s[11]||(s[11]=t=>Q.value=t),title:e(o)("pos.addService"),size:"lg"},{body:c(()=>[V.value?(r(),d("div",gs,[l("div",hs,[l("label",bs,n(e(o)("pos.service")),1),i(e(N),{value:V.value.name_ar||V.value.name,disabled:""},null,8,["value"])]),l("div",ks,[l("label",Cs,n(e(o)("pos.price")),1),i(e(N),{value:I(V.value.price||0),disabled:""},null,8,["value"])]),l("div",ws,[l("label",Ss,n(e(o)("pos.staff")),1),i(e(Z),{modelValue:R.value,"onUpdate:modelValue":s[8]||(s[8]=t=>R.value=t)},{default:c(()=>[l("option",Ps,n(e(o)("pos.selectStaff")),1),(r(!0),d(U,null,$(T.value,t=>(r(),d("option",{key:t.id,value:t.id},n(t.name),9,qs))),128))]),_:1},8,["modelValue"])]),l("div",Vs,[l("label",Is,n(e(o)("pos.quantity")),1),i(e(N),{modelValue:se.value,"onUpdate:modelValue":s[9]||(s[9]=t=>se.value=t),modelModifiers:{number:!0},type:"number",min:"1"},null,8,["modelValue"])])])):h("",!0)]),footer:c(()=>[i(e(S),{color:"primary",variant:"outline",onClick:s[10]||(s[10]=t=>Q.value=!1)},{default:c(()=>[p(n(e(o)("pos.cancel")),1)]),_:1}),i(e(S),{color:"primary",onClick:Be},{default:c(()=>[p(n(e(o)("pos.addToCart")),1)]),_:1})]),_:1},8,["visible","title"]),i(e(pe),{visible:W.value,"onUpdate:visible":s[15]||(s[15]=t=>W.value=t),title:e(o)("pos.addProduct"),size:"lg"},{body:c(()=>[g.value?(r(),d("div",Os,[l("div",Ns,[l("label",Es,n(e(o)("products.title")),1),i(e(N),{value:g.value.name_ar||g.value.name,disabled:""},null,8,["value"])]),l("div",xs,[l("label",Ls,n(e(o)("pos.price")),1),i(e(N),{value:I(g.value.selling_price||g.value.price||0),disabled:""},null,8,["value"])]),l("div",Us,[l("label",$s,n(e(o)("pos.availableStock")),1),i(e(N),{value:g.value.stock_quantity||0,disabled:""},null,8,["value"])]),l("div",Ms,[l("label",Ts,n(e(o)("pos.staff")),1),i(e(Z),{modelValue:G.value,"onUpdate:modelValue":s[12]||(s[12]=t=>G.value=t)},{default:c(()=>[l("option",Ds,n(e(o)("pos.selectStaff")),1),(r(!0),d(U,null,$(T.value,t=>(r(),d("option",{key:t.id,value:t.id},n(t.name),9,As))),128))]),_:1},8,["modelValue"])]),l("div",Fs,[l("label",Bs,n(e(o)("pos.quantity")),1),i(e(N),{modelValue:D.value,"onUpdate:modelValue":s[13]||(s[13]=t=>D.value=t),modelModifiers:{number:!0},type:"number",min:"1",max:g.value.stock_quantity||999},null,8,["modelValue","max"])])])):h("",!0)]),footer:c(()=>{var t;return[i(e(S),{color:"primary",variant:"outline",onClick:s[14]||(s[14]=u=>W.value=!1)},{default:c(()=>[p(n(e(o)("pos.cancel")),1)]),_:1}),i(e(S),{color:"primary",onClick:ze,disabled:D.value>(((t=g.value)==null?void 0:t.stock_quantity)||0)},{default:c(()=>[p(n(e(o)("pos.addToCart")),1)]),_:1},8,["disabled"])]}),_:1},8,["visible","title"]),i(e(pe),{visible:te.value,"onUpdate:visible":s[17]||(s[17]=t=>te.value=t),title:e(o)("pos.sessionInfo")},{body:c(()=>[L.value?(r(),d("div",zs,[l("div",Ks,[l("strong",null,n(e(o)("pos.openedAt"))+":",1),p(" "+n(xe(L.value.opened_at)),1)]),l("div",Qs,[l("strong",null,n(e(o)("pos.openingCash"))+":",1),p(" "+n(I(L.value.opening_cash||0)),1)]),l("div",Ws,[l("strong",null,n(e(o)("pos.totalTransactions"))+":",1),p(" "+n(L.value.total_transactions||0),1)]),l("div",Rs,[l("strong",null,n(e(o)("pos.totalSales"))+":",1),p(" "+n(I(L.value.total_sales||0)),1)])])):h("",!0)]),footer:c(()=>[i(e(S),{color:"primary",onClick:s[16]||(s[16]=t=>te.value=!1)},{default:c(()=>[p(n(e(o)("pos.close")),1)]),_:1})]),_:1},8,["visible","title"])]))}},ia=dt(Gs,[["__scopeId","data-v-cccd1b0d"]]);export{ia as default};
