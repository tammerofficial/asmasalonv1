import{f as d,e as _e,j as De,c as m,o as c,b as s,d as a,s as $,a as w,t as l,u as e,w as i,Y as fe,x as V,a0 as ue,l as Fe,p as qe,P as v,C as y,Z as ke,F as T,g as j,n as Ie,aa as Le,ab as Re,a3 as de,z as ae,a1 as le,a4 as Ne,a5 as me,a6 as ve,a7 as pe,$ as ze,a2 as Pe,a8 as Ae,X as Ee}from"../chunk-vendor-vue-BKzcbwC-.js";import{a as N,u as Me,N as Oe}from"../chunk-component-NotificationsBell-CyBx4swB.js";import{u as Te}from"../chunk-view-AppleWallet/Simulator-WLH8OaYC.js";import{d as Be}from"../chunk-vendor-pinia-CsGkbfJ3.js";import"../chunk-component-PageHeader-CI_3JpQM.js";import{_ as Qe,C as we}from"../chunk-component-Card-D7ddNvJz.js";import{E as Ce}from"../chunk-component-EmptyState-QeIH5i51.js";import{L as Ue}from"../chunk-component-LoadingSpinner-C0iMeCmp.js";import{Q as We}from"./Components/QuickStatsBar-BDBFL9nM.js";import{C as Ge}from"./Components/CustomerQuickView-BOdudBr1.js";import{B as He}from"./Components/BookingCard-D8KOQ86n.js";import{Q as Ke}from"./Components/QueueTicketCard-CusYFdq3.js";import{P as Ye}from"./Components/PaymentMethodsGrid-xTZj9gC1.js";import{S as Xe}from"./Components/StaffStatusWidget-CLT044Vt.js";import{L as Ze}from"./Components/LiveAnalyticsDashboard-DFNqPose.js";import"../chunk-vendor-Ltsl4QyH.js";import"../chunk-vendor-axios-B9ygI19o.js";const je=Be("pos",()=>{const x=d([]),n=d([]),h=d([]),R=d([]),r=d([]),z=d([]),D=d([]),q=d([]),b=d([]),H=d([]),Q=d([]),K=d([]),f=d([]),Y=d(null),I=d([]),U=d(null),W=d(0),ne=d("cash"),G=d(0),C=d({products:!1,services:!1,staff:!1,customers:!1,activeCustomers:!1,session:!1,loyalty:!1,finance:!1}),P=_e(()=>I.value.reduce((p,S)=>p+S.unit_price*S.quantity,0)),ie=_e(()=>Math.max(0,P.value-W.value-G.value)),F=_e(()=>U.value?R.value.find(p=>Number(p.id)===Number(U.value))||z.value.find(p=>Number(p.id)===Number(U.value)):null);async function A(){var p,S,k,X,Z,J,ee,se,te,O,oe,re,be,u,o,_,B;C.value.products=!0,C.value.services=!0,C.value.staff=!0,C.value.customers=!0,C.value.activeCustomers=!0,C.value.session=!0;try{const[t,M,ce,xe,Se,Ve,$e]=await Promise.all([N.get("/products",{params:{per_page:1e3,is_active:1}}),N.get("/services",{params:{per_page:1e3,is_active:1}}),N.get("/staff",{params:{per_page:1e3,status:"active"}}),N.get("/customers",{params:{per_page:1e3}}),N.get("/memberships/plans",{params:{is_active:1}}),N.get("/pos"),N.get("/pos/session")]);x.value=((S=(p=t.data)==null?void 0:p.data)==null?void 0:S.items)||((k=t.data)==null?void 0:k.items)||[],n.value=((Z=(X=M.data)==null?void 0:X.data)==null?void 0:Z.items)||((J=M.data)==null?void 0:J.items)||[],h.value=((se=(ee=ce.data)==null?void 0:ee.data)==null?void 0:se.items)||((te=ce.data)==null?void 0:te.items)||[],R.value=((oe=(O=xe.data)==null?void 0:O.data)==null?void 0:oe.items)||((re=xe.data)==null?void 0:re.items)||[],r.value=((u=(be=Se.data)==null?void 0:be.data)==null?void 0:u.items)||((o=Se.data)==null?void 0:o.items)||[];const ge=((_=Ve.data)==null?void 0:_.data)||Ve.data||{};z.value=ge.active_customers||[],D.value=ge.bookings||[],q.value=ge.queue_tickets||[],Y.value=((B=$e.data)==null?void 0:B.data)||$e.data||null}catch(t){console.error("Error fetching POS data:",t)}finally{Object.keys(C.value).forEach(t=>C.value[t]=!1)}}async function g(p){var S;if(!p)return null;C.value.loyalty=!0;try{const k=await N.get(`/customers/${p}/loyalty`);return((S=k.data)==null?void 0:S.data)||k.data}catch(k){return console.error("Error fetching loyalty data:",k),null}finally{C.value.loyalty=!1}}async function E(p){var S,k,X,Z,J,ee,se,te;if(p){C.value.finance=!0;try{const[O,oe,re]=await Promise.all([N.get("/invoices",{params:{customer_id:p,limit:5}}),N.get("/payments",{params:{customer_id:p,limit:5}}),N.get(`/pos/prepaid/${p}`)]);H.value=((k=(S=O.data)==null?void 0:S.data)==null?void 0:k.items)||((X=O.data)==null?void 0:X.items)||[],Q.value=((J=(Z=oe.data)==null?void 0:Z.data)==null?void 0:J.items)||((ee=oe.data)==null?void 0:ee.items)||[],G.value=((te=(se=re.data)==null?void 0:se.data)==null?void 0:te.total_prepaid)||0}catch(O){console.error("Error fetching financial data:",O)}finally{C.value.finance=!1}}}function L(p){const S=I.value.findIndex(k=>k.type===p.type&&(p.type==="product"?k.product_id===p.product_id:k.service_id===p.service_id)&&k.staff_id===p.staff_id);S>-1?I.value[S].quantity+=p.quantity||1:I.value.push({...p,quantity:p.quantity||1})}function ye(p){I.value.splice(p,1)}function he(){I.value=[],W.value=0,G.value=0}return{products:x,services:n,staff:h,customers:R,activeCustomers:z,bookings:D,queueTickets:q,orders:b,invoices:H,payments:Q,commissions:K,workerCalls:f,openSession:Y,cart:I,selectedCustomerId:U,discount:W,paymentMethod:ne,prepaidAmount:G,loading:C,subtotal:P,total:ie,selectedCustomer:F,fetchAllData:A,fetchLoyaltyData:g,fetchCustomerFinancials:E,addToCart:L,removeFromCart:ye,clearCart:he}});function Je(){const x=je(),{t:n}=Me(),h=Te(),R=d(!1);async function r(q){x.selectedCustomerId=q.id||q.customer_id,await Promise.all([x.fetchLoyaltyData(x.selectedCustomerId),x.fetchCustomerFinancials(x.selectedCustomerId)]),h.success(n("pos.customerSelected")||"تم اختيار العميلة: "+(q.name||q.customer_name))}async function z(q){var b,H;if(x.cart.length===0)return h.error(n("pos.emptyCart")),!1;R.value=!0;try{const Q={customer_id:x.selectedCustomerId?Number(x.selectedCustomerId):null,items:x.cart.map(f=>({service_id:f.service_id||null,product_id:f.product_id||null,staff_id:f.staff_id||null,quantity:f.quantity,unit_price:f.unit_price,name:f.name})),payment_method:x.paymentMethod,discount:x.discount||0,client_side_id:q},K=await N.post("/pos/process",Q);return(b=K.data)!=null&&b.success?(h.success(n("pos.orderProcessed")||"تمت معالجة الطلب بنجاح"),x.clearCart(),await x.fetchAllData(),K.data.data):(h.error(((H=K.data)==null?void 0:H.message)||n("pos.errorProcessing")),!1)}catch(Q){return console.error("Error in checkout:",Q),h.error(n("pos.errorProcessing")||"خطأ في معالجة الطلب"),!1}finally{R.value=!1}}function D(q){return new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",minimumFractionDigits:3}).format(q||0)}return{isProcessing:R,selectActiveCustomer:r,processCheckout:z,formatCurrency:D}}const es={class:"pos-page"},ss={class:"pos-header-top d-flex justify-content-between align-items-center mb-3"},ts={class:"header-left d-flex align-items-center gap-3"},os={class:"mb-0 fw-bold text-primary"},as={class:"header-right d-flex align-items-center gap-3"},ls={class:"pos-layout"},ns={class:"pos-column pos-operations"},is={class:"d-flex justify-content-between align-items-center w-100"},rs={class:"fw-bold"},cs={class:"operation-section"},us={class:"section-title d-flex justify-content-between align-items-center"},ds={class:"operation-list"},ms=["onClick"],vs={class:"item-avatar"},ps={class:"item-info"},fs={class:"item-name"},_s={class:"item-meta"},ys={class:"ms-2"},hs={key:0,class:"empty-state-mini"},bs={class:"operation-section mt-3"},Cs={class:"section-title d-flex justify-content-between"},gs={class:"operation-list"},ks={class:"operation-section mt-3"},ws={class:"section-title d-flex justify-content-between"},xs={class:"operation-list"},Ss={class:"pos-column pos-catalog"},Vs={class:"catalog-header-actions w-100"},$s={class:"catalog-grid-wrapper"},qs={key:1,class:"catalog-grid"},Is=["onClick"],Ns={key:0,class:"item-category-badge"},Ps={class:"item-name"},As={class:"item-price"},Ms={key:1,class:"item-stock"},Ts={class:"quick-add"},js={class:"pos-column pos-checkout"},Ds={class:"fw-bold"},Fs={class:"checkout-customer-section"},Ls={key:1,class:"customer-selection-empty"},Rs={value:null},zs=["value"],Es={class:"cart-items-section"},Os={key:0,class:"empty-cart-display"},Bs={key:1,class:"cart-list"},Qs={class:"item-info"},Us={class:"item-name"},Ws={key:0,class:"item-staff"},Gs={class:"item-controls"},Hs={class:"quantity-picker"},Ks=["onClick"],Ys=["onClick"],Xs={class:"item-total"},Zs={class:"checkout-footer"},Js={class:"summary-details"},et={class:"summary-line"},st={key:0,class:"summary-line"},tt={class:"text-success"},ot={class:"summary-line discount-line"},at={class:"summary-line total-line"},lt={class:"total-amount"},nt={class:"payment-section mt-3"},it={class:"small fw-bold mb-2 text-muted uppercase"},rt={class:"checkout-actions"},ct={key:0,class:"history-list"},ut={class:"d-flex justify-content-between"},dt={class:"fw-bold"},mt={class:"text-primary fw-bold"},vt={class:"d-flex justify-content-between mt-1"},pt={class:"small text-muted"},ft={key:1,class:"history-list"},_t={class:"d-flex justify-content-between"},yt={class:"fw-bold"},ht={class:"text-primary fw-bold"},bt={class:"d-flex justify-content-between mt-1"},Ct={class:"small text-muted"},gt={key:2,class:"history-list"},kt={class:"d-flex justify-content-between"},wt={class:"fw-bold"},xt={class:"text-success fw-bold"},St={class:"d-flex justify-content-between mt-1"},Vt={class:"small text-muted"},$t={class:"item-preview-card"},qt={class:"item-name h4"},It={class:"item-price h3 text-primary"},Nt={class:"mb-3"},Pt={class:"form-label small fw-bold text-muted"},At={value:""},Mt=["value"],Tt={key:0,class:"mt-2 small text-success fw-bold"},jt={class:"mb-3"},Dt={class:"form-label small fw-bold text-muted"},Ft={class:"quantity-input-large"},Lt={class:"offers-section"},Rt={class:"section-title small fw-bold text-muted mb-2 uppercase"},zt={class:"empty-state-mini border rounded p-3 text-center"},Et={class:"mb-3"},Ot={class:"form-label"},Bt={class:"mb-3"},Qt={class:"form-label"},Ut={class:"mb-3"},Wt={class:"form-label"},Gt={class:"invoice-container p-4",id:"printable-invoice"},Ht={class:"invoice-header text-center mb-4"},Kt={class:"small"},Yt={class:"invoice-items mb-4"},Xt={class:"invoice-summary"},Zt={class:"d-flex justify-content-between"},Jt={key:0,class:"d-flex justify-content-between text-danger"},eo={class:"d-flex justify-content-between fw-bold h4 mt-2"},so={class:"invoice-footer text-center mt-5"},to={class:"settings-list"},oo={class:"setting-item d-flex justify-content-between align-items-center mb-3 p-2 border rounded"},ao={class:"fw-bold"},lo={class:"small text-muted"},no={class:"setting-item d-flex justify-content-between align-items-center mb-3 p-2 border rounded"},io={class:"fw-bold"},ro={class:"small text-muted"},co={__name:"Index",setup(x){const{t:n}=Me(),h=Te(),R=Fe(),r=je(),{isProcessing:z,selectActiveCustomer:D,processCheckout:q,formatCurrency:b,callNextInQueue:H,callSpecificTicket:Q,serveTicket:K}=Je(),f=d("services"),Y=d(""),I=d(!1),U=d(!1),W=d(!1),ne=d(!1),G=d(!1),C=d(!1),P=d(null),ie=d(!1),F=d({name:"",phone:"",email:""}),A=d("orders"),g=d(null),E=d(""),L=d(1),ye=_e(()=>{if(!E.value||!g.value)return 0;const u=r.staff.find(B=>Number(B.id)===Number(E.value));if(!u)return 0;const o=parseFloat(g.value.price||g.value.selling_price||0),_=parseFloat(u.commission_rate||10);return o*L.value*(_/100)}),he=_e(()=>{let u=[];if(f.value==="services"?u=r.services:f.value==="products"?u=r.products:f.value==="memberships"&&(u=r.memberships),!Y.value)return u;const o=Y.value.toLowerCase();return u.filter(_=>(_.name_ar||_.name||"").toLowerCase().includes(o)||(_.category||"").toLowerCase().includes(o)||(_.sku||"").toLowerCase().includes(o))}),p=u=>{if(f.value==="products"&&(u.stock_quantity||0)<=0){h.error(n("pos.outOfStock")||"المنتج غير متوفر في المخزون");return}g.value=u,E.value="",L.value=1,I.value=!0},S=()=>{const u=r.staff.find(B=>Number(B.id)===Number(E.value)),o=f.value==="services"?"service":f.value==="products"?"product":"membership",_={type:o,service_id:o==="service"?g.value.id:null,product_id:o==="product"?g.value.id:null,membership_id:o==="membership"?g.value.id:null,name:g.value.name_ar||g.value.name,quantity:L.value,unit_price:parseFloat(g.value.price||g.value.selling_price||0),staff_id:E.value||null,staff_name:u?u.name:""};r.addToCart(_),I.value=!1,h.success(n("pos.addedToCart")||"تمت الإضافة للسلة")},k=(u,o)=>{const _=r.cart[u];_.quantity+o>0&&(_.quantity+=o)},X=()=>{if(r.selectedCustomerId){const u=r.customers.find(o=>Number(o.id)===Number(r.selectedCustomerId));u&&D(u)}},Z=async()=>{const u="pos_"+Date.now(),o=await q(u);o&&(P.value=o,C.value=!0)},J=u=>{R.push(`/customers/${u}`)},ee=async u=>{var o;try{(o=(await api.post(`/loyalty/apple-wallet/send/${u}`)).data)!=null&&o.success&&h.success(n("loyalty.passSent")||"تم إرسال بطاقة المحفظة بنجاح")}catch(_){console.error("Error sending wallet pass:",_),h.error(n("loyalty.errorSendingPass")||"خطأ في إرسال بطاقة المحفظة")}},se=async()=>{var u;ie.value=!0;try{const o=await api.post("/customers",F.value);(u=o.data)!=null&&u.success&&(h.success(n("customers.added")||"تمت إضافة العميلة بنجاح"),await r.fetchAllData(),D(o.data.data),W.value=!1,F.value={name:"",phone:"",email:""})}catch(o){console.error("Error adding customer:",o),h.error(n("customers.errorAdding")||"خطأ في إضافة العميلة")}finally{ie.value=!1}},te=async()=>{await H()},O=async u=>{await Q(u.id)},oe=async u=>{await K(u.id),D({id:u.customer_id,name:u.customer_name,type:"queue",ticket_number:u.ticket_number})},re=async u=>{var o;if(u.status!=="available"){h.warning(n("workerCalls.staffNotAvailable")||"الموظفة مشغولة حالياً");return}try{(o=(await api.post("/worker-calls",{staff_id:u.id,customer_id:r.selectedCustomerId,reason:"POS Service Request"})).data)!=null&&o.success&&(h.success(n("workerCalls.callSent")||"تم إرسال النداء للموظفة: "+u.name),await r.fetchAllData())}catch(_){console.error("Error calling staff:",_),h.error(n("workerCalls.errorCalling")||"خطأ في إرسال النداء")}},be=async()=>{var u;if(confirm(n("pos.confirmCloseSession")||"هل أنت متأكد من إغلاق الجلسة؟"))try{(u=(await api.post(`/pos/session/${r.openSession.id}/close`)).data)!=null&&u.success&&(h.success(n("pos.sessionClosed")||"تم إغلاق الجلسة بنجاح"),ne.value=!1,await r.fetchAllData())}catch(o){console.error("Error closing session:",o),h.error(n("pos.errorClosingSession"))}};return De(()=>{r.fetchAllData()}),(u,o)=>{const _=qe("router-link"),B=qe("CFormSwitch");return c(),m("div",es,[s("div",ss,[s("div",ts,[s("h4",os,l(e(n)("pos.title")),1),e(r).openSession?(c(),$(e(fe),{key:0,color:"success",shape:"rounded-pill"},{default:i(()=>[v(l(e(n)("pos.sessionOpen")||"الجلسة مفتوحة")+" (#"+l(e(r).openSession.id)+") ",1)]),_:1})):w("",!0)]),s("div",as,[a(e(V),{color:"info",variant:"ghost",onClick:o[0]||(o[0]=t=>G.value=!0)},{default:i(()=>[a(e(y),{icon:"cil-chart-line"})]),_:1}),a(Oe),a(e(V),{color:"secondary",variant:"ghost",onClick:o[1]||(o[1]=t=>ne.value=!0)},{default:i(()=>[a(e(y),{icon:"cil-settings"})]),_:1})])]),a(We,{session:e(r).openSession,activeCustomersCount:e(r).activeCustomers.length},null,8,["session","activeCustomersCount"]),s("div",ls,[s("div",ns,[a(we,{class:"operations-card h-100"},{header:i(()=>[s("div",is,[s("span",rs,l(e(n)("pos.operations")||"العمليات"),1),a(e(V),{size:"sm",color:"primary",variant:"ghost",onClick:e(r).fetchAllData},{default:i(()=>[a(e(y),{icon:"cil-reload"})]),_:1},8,["onClick"])])]),default:i(()=>[a(e(ke),{variant:"pills",class:"flex-column operations-nav"},{default:i(()=>[s("div",cs,[s("div",us,[s("span",null,[a(e(y),{icon:"cil-people",class:"me-2"}),v(" "+l(e(n)("pos.activeCustomers")),1)]),a(e(V),{size:"sm",color:"success",variant:"ghost",onClick:o[2]||(o[2]=t=>W.value=!0)},{default:i(()=>[a(e(y),{icon:"cil-plus"})]),_:1})]),s("div",ds,[(c(!0),m(T,null,j(e(r).activeCustomers,t=>{var M;return c(),m("div",{key:t.id,class:Ie(["operation-item",{selected:Number(e(r).selectedCustomerId)===Number(t.id)}]),onClick:ce=>e(D)(t)},[s("div",vs,l(((M=t.name)==null?void 0:M.charAt(0))||"C"),1),s("div",ps,[s("div",fs,l(t.name),1),s("div",_s,[a(e(fe),{color:t.type==="queue"?"info":"primary",size:"sm"},{default:i(()=>[v(l(t.type==="queue"?"#"+t.ticket_number:e(n)("bookings.title")),1)]),_:2},1032,["color"]),s("span",ys,l(t.current_service||"N/A"),1)])])],10,ms)}),128)),e(r).activeCustomers.length===0?(c(),m("div",hs,l(e(n)("pos.noActiveCustomers")),1)):w("",!0)])]),s("div",bs,[s("div",Cs,[s("span",null,[a(e(y),{icon:"cil-calendar",class:"me-2"}),v(" "+l(e(n)("bookings.title")),1)]),a(_,{to:"/bookings",class:"text-primary text-decoration-none small"},{default:i(()=>[v(l(e(n)("common.viewAll")),1)]),_:1})]),s("div",gs,[(c(!0),m(T,null,j(e(r).bookings.slice(0,3),t=>(c(),$(He,{key:t.id,booking:t,onProcess:e(D)},null,8,["booking","onProcess"]))),128))])]),s("div",ks,[s("div",ws,[s("span",null,[a(e(y),{icon:"cil-list",class:"me-2"}),v(" "+l(e(n)("queue.title")),1)]),a(e(V),{size:"sm",color:"primary",variant:"ghost",onClick:te},{default:i(()=>[v(l(e(n)("queue.next")),1)]),_:1})]),s("div",xs,[(c(!0),m(T,null,j(e(r).queueTickets.filter(t=>t.status!=="completed").slice(0,3),t=>(c(),$(Ke,{key:t.id,ticket:t,onCall:O,onServe:oe},null,8,["ticket"]))),128))])]),a(Xe,{staff:e(r).staff,onCall:re},null,8,["staff"])]),_:1})]),_:1})]),s("div",Ss,[a(we,{class:"catalog-card h-100"},{header:i(()=>[s("div",Vs,[a(e(Le),null,{default:i(()=>[a(e(Re),null,{default:i(()=>[a(e(y),{icon:"cil-magnifying-glass"})]),_:1}),a(e(de),{modelValue:Y.value,"onUpdate:modelValue":o[3]||(o[3]=t=>Y.value=t),placeholder:e(n)("common.search")+"...",class:"border-start-0"},null,8,["modelValue","placeholder"])]),_:1}),a(e(ke),{variant:"pills",class:"catalog-tabs mt-3"},{default:i(()=>[a(e(ae),null,{default:i(()=>[a(e(le),{active:f.value==="services",onClick:o[4]||(o[4]=t=>f.value="services")},{default:i(()=>[a(e(y),{icon:"cil-spreadsheet",class:"me-2"}),v(l(e(n)("pos.services")),1)]),_:1},8,["active"])]),_:1}),a(e(ae),null,{default:i(()=>[a(e(le),{active:f.value==="products",onClick:o[5]||(o[5]=t=>f.value="products")},{default:i(()=>[a(e(y),{icon:"cil-basket",class:"me-2"}),v(l(e(n)("pos.products")),1)]),_:1},8,["active"])]),_:1}),a(e(ae),null,{default:i(()=>[a(e(le),{active:f.value==="memberships",onClick:o[6]||(o[6]=t=>f.value="memberships")},{default:i(()=>[a(e(y),{icon:"cil-gem",class:"me-2"}),v(l(e(n)("memberships.title")||"العضويات"),1)]),_:1},8,["active"])]),_:1}),a(e(ae),null,{default:i(()=>[a(e(le),{active:f.value==="favorites",onClick:o[7]||(o[7]=t=>f.value="favorites")},{default:i(()=>[a(e(y),{icon:"cil-star",class:"me-2"}),v(l(e(n)("common.favorites")||"المفضلة"),1)]),_:1},8,["active"])]),_:1})]),_:1})])]),default:i(()=>[s("div",$s,[e(r).loading.products||e(r).loading.services?(c(),$(Ue,{key:0})):(c(),m("div",qs,[(c(!0),m(T,null,j(he.value,t=>(c(),m("div",{key:t.id,class:Ie(["catalog-item-card",{"out-of-stock":f.value==="products"&&(t.stock_quantity||0)<=0}]),onClick:M=>p(t)},[t.category?(c(),m("div",Ns,l(t.category),1)):w("",!0),s("div",Ps,l(t.name_ar||t.name),1),s("div",As,l(e(b)(t.price||t.selling_price||0)),1),f.value==="products"?(c(),m("div",Ms,l(e(n)("products.stock"))+": "+l(t.stock_quantity||0),1)):w("",!0),s("div",Ts,[a(e(y),{icon:"cil-plus"})])],10,Is))),128))])),he.value.length?w("",!0):(c(),$(Ce,{key:2,title:e(n)("common.noResults"),icon:"cil-search"},null,8,["title"]))])]),_:1})]),s("div",js,[a(we,{class:"checkout-card h-100"},{header:i(()=>[s("div",Ds,l(e(n)("pos.cart")),1)]),default:i(()=>[s("div",Fs,[e(r).selectedCustomer?(c(),$(Ge,{key:0,customer:e(r).selectedCustomer,onViewProfile:J,onViewHistory:o[8]||(o[8]=t=>U.value=!0),onSendWalletPass:ee},null,8,["customer"])):(c(),m("div",Ls,[a(e(Ne),{modelValue:e(r).selectedCustomerId,"onUpdate:modelValue":o[9]||(o[9]=t=>e(r).selectedCustomerId=t),onChange:X},{default:i(()=>[s("option",Rs,l(e(n)("pos.walkInCustomer")),1),(c(!0),m(T,null,j(e(r).customers,t=>(c(),m("option",{key:t.id,value:t.id},l(t.name)+" - "+l(t.phone),9,zs))),128))]),_:1},8,["modelValue"])]))]),s("div",Es,[e(r).cart.length===0?(c(),m("div",Os,[a(e(y),{icon:"cil-cart",class:"mb-2",size:"xl"}),s("div",null,l(e(n)("pos.emptyCartDesc")),1)])):(c(),m("div",Bs,[(c(!0),m(T,null,j(e(r).cart,(t,M)=>(c(),m("div",{key:M,class:"cart-item"},[s("div",Qs,[s("div",Us,l(t.name),1),t.staff_name?(c(),m("div",Ws,[a(e(y),{icon:"cil-user",class:"me-1"}),v(l(t.staff_name),1)])):w("",!0)]),s("div",Gs,[s("div",Hs,[s("button",{onClick:ce=>k(M,-1)},"-",8,Ks),s("span",null,l(t.quantity),1),s("button",{onClick:ce=>k(M,1)},"+",8,Ys)]),s("div",Xs,l(e(b)(t.unit_price*t.quantity)),1),a(e(V),{size:"sm",color:"danger",variant:"ghost",onClick:ce=>e(r).removeFromCart(M)},{default:i(()=>[a(e(y),{icon:"cil-trash"})]),_:1},8,["onClick"])])]))),128))]))]),s("div",Zs,[s("div",Js,[s("div",et,[s("span",null,l(e(n)("pos.subtotal")),1),s("span",null,l(e(b)(e(r).subtotal)),1)]),e(r).prepaidAmount>0?(c(),m("div",st,[s("span",null,l(e(n)("pos.prepaid")),1),s("span",tt,"-"+l(e(b)(e(r).prepaidAmount)),1)])):w("",!0),s("div",ot,[s("span",null,l(e(n)("pos.discount")),1),a(e(de),{modelValue:e(r).discount,"onUpdate:modelValue":o[10]||(o[10]=t=>e(r).discount=t),modelModifiers:{number:!0},type:"number",step:"0.5",size:"sm",class:"summary-input"},null,8,["modelValue"])]),s("div",at,[s("span",null,l(e(n)("pos.total")),1),s("span",lt,l(e(b)(e(r).total)),1)])]),s("div",nt,[s("div",it,l(e(n)("pos.paymentMethod")),1),a(Ye,{modelValue:e(r).paymentMethod,"onUpdate:modelValue":o[11]||(o[11]=t=>e(r).paymentMethod=t)},null,8,["modelValue"])]),s("div",rt,[a(e(V),{color:"primary",class:"w-100 checkout-btn py-3",disabled:!e(r).cart.length||e(z),onClick:Z},{default:i(()=>[e(z)?(c(),$(e(y),{key:0,icon:"cil-reload",class:"spinning me-2"})):(c(),$(e(y),{key:1,icon:"cil-check-circle",class:"me-2"})),v(" "+l(e(z)?e(n)("pos.processing"):e(n)("pos.processOrder")),1)]),_:1},8,["disabled"]),a(e(V),{color:"secondary",variant:"ghost",class:"w-100 mt-2",onClick:e(r).clearCart},{default:i(()=>[v(l(e(n)("pos.clearCart")),1)]),_:1},8,["onClick"])])])]),_:1})])]),a(e(ue),{visible:G.value,onClose:o[12]||(o[12]=t=>G.value=!1),size:"lg",alignment:"center"},{default:i(()=>[a(e(me),null,{default:i(()=>[a(e(ve),null,{default:i(()=>[v(l(e(n)("analytics.title")||"التحليلات الحية"),1)]),_:1})]),_:1}),a(e(pe),null,{default:i(()=>[a(Ze,{session:e(r).openSession},null,8,["session"])]),_:1})]),_:1},8,["visible"]),a(e(ue),{visible:U.value,onClose:o[16]||(o[16]=t=>U.value=!1),size:"xl",alignment:"center"},{default:i(()=>[a(e(me),null,{default:i(()=>[a(e(ve),null,{default:i(()=>{var t;return[v(l(e(n)("common.history")||"السجل")+" - "+l((t=e(r).selectedCustomer)==null?void 0:t.name),1)]}),_:1})]),_:1}),a(e(pe),null,{default:i(()=>[a(e(ke),{variant:"tabs",class:"mb-3"},{default:i(()=>[a(e(ae),null,{default:i(()=>[a(e(le),{active:A.value==="orders",onClick:o[13]||(o[13]=t=>A.value="orders")},{default:i(()=>[v(l(e(n)("orders.title")),1)]),_:1},8,["active"])]),_:1}),a(e(ae),null,{default:i(()=>[a(e(le),{active:A.value==="invoices",onClick:o[14]||(o[14]=t=>A.value="invoices")},{default:i(()=>[v(l(e(n)("invoices.title")),1)]),_:1},8,["active"])]),_:1}),a(e(ae),null,{default:i(()=>[a(e(le),{active:A.value==="payments",onClick:o[15]||(o[15]=t=>A.value="payments")},{default:i(()=>[v(l(e(n)("payments.title")),1)]),_:1},8,["active"])]),_:1})]),_:1}),A.value==="orders"?(c(),m("div",ct,[(c(!0),m(T,null,j(e(r).orders,t=>(c(),m("div",{key:t.id,class:"history-item border rounded p-3 mb-2"},[s("div",ut,[s("span",dt,"#"+l(t.order_number),1),s("span",mt,l(e(b)(t.total)),1)]),s("div",vt,[s("span",pt,l(t.created_at),1),a(e(fe),{color:t.status==="completed"?"success":"warning"},{default:i(()=>[v(l(t.status),1)]),_:2},1032,["color"])])]))),128)),e(r).orders.length?w("",!0):(c(),$(Ce,{key:0,title:e(n)("orders.noOrders"),icon:"cil-cart"},null,8,["title"]))])):w("",!0),A.value==="invoices"?(c(),m("div",ft,[(c(!0),m(T,null,j(e(r).invoices,t=>(c(),m("div",{key:t.id,class:"history-item border rounded p-3 mb-2"},[s("div",_t,[s("span",yt,"#"+l(t.invoice_number),1),s("span",ht,l(e(b)(t.total_amount)),1)]),s("div",bt,[s("span",Ct,l(t.created_at),1),a(e(fe),{color:t.status==="paid"?"success":"danger"},{default:i(()=>[v(l(t.status),1)]),_:2},1032,["color"])])]))),128)),e(r).invoices.length?w("",!0):(c(),$(Ce,{key:0,title:e(n)("invoices.noInvoices"),icon:"cil-file"},null,8,["title"]))])):w("",!0),A.value==="payments"?(c(),m("div",gt,[(c(!0),m(T,null,j(e(r).payments,t=>(c(),m("div",{key:t.id,class:"history-item border rounded p-3 mb-2"},[s("div",kt,[s("span",wt,l(t.payment_method),1),s("span",xt,l(e(b)(t.amount)),1)]),s("div",St,[s("span",Vt,l(t.created_at),1),a(e(fe),{color:"info"},{default:i(()=>[v("#"+l(t.id),1)]),_:2},1024)])]))),128)),e(r).payments.length?w("",!0):(c(),$(Ce,{key:0,title:e(n)("payments.noPayments"),icon:"cil-money"},null,8,["title"]))])):w("",!0)]),_:1})]),_:1},8,["visible"]),a(e(ue),{visible:I.value,onClose:o[22]||(o[22]=t=>I.value=!1),size:"lg",alignment:"center"},{default:i(()=>[a(e(me),null,{default:i(()=>[a(e(ve),null,{default:i(()=>[v(l(f.value==="services"?e(n)("pos.addService"):e(n)("pos.addProduct")),1)]),_:1})]),_:1}),g.value?(c(),$(e(pe),{key:0},{default:i(()=>[a(e(ze),null,{default:i(()=>[a(e(Pe),{md:"6"},{default:i(()=>[s("div",$t,[s("div",qt,l(g.value.name_ar||g.value.name),1),s("div",It,l(e(b)(g.value.price||g.value.selling_price||0)),1),o[33]||(o[33]=s("hr",null,null,-1)),s("div",Nt,[s("label",Pt,l(e(n)("pos.staff")),1),a(e(Ne),{modelValue:E.value,"onUpdate:modelValue":o[17]||(o[17]=t=>E.value=t)},{default:i(()=>[s("option",At,l(e(n)("pos.selectStaff")),1),(c(!0),m(T,null,j(e(r).staff,t=>(c(),m("option",{key:t.id,value:t.id},l(t.name),9,Mt))),128))]),_:1},8,["modelValue"]),ye.value>0?(c(),m("div",Tt,[a(e(y),{icon:"cil-money",class:"me-1"}),v(" "+l(e(n)("commissions.estimated")||"العمولة المقدرة")+": "+l(e(b)(ye.value)),1)])):w("",!0)]),s("div",jt,[s("label",Dt,l(e(n)("pos.quantity")),1),s("div",Ft,[a(e(V),{color:"secondary",variant:"outline",onClick:o[18]||(o[18]=t=>L.value>1?L.value--:null)},{default:i(()=>[...o[31]||(o[31]=[v("-",-1)])]),_:1}),a(e(de),{modelValue:L.value,"onUpdate:modelValue":o[19]||(o[19]=t=>L.value=t),modelModifiers:{number:!0},type:"number",min:"1",class:"text-center"},null,8,["modelValue"]),a(e(V),{color:"secondary",variant:"outline",onClick:o[20]||(o[20]=t=>L.value++)},{default:i(()=>[...o[32]||(o[32]=[v("+",-1)])]),_:1})])])])]),_:1}),a(e(Pe),{md:"6"},{default:i(()=>[s("div",Lt,[s("div",Rt,l(e(n)("loyalty.offers")||"العروض المتاحة"),1),s("div",zt,l(e(n)("loyalty.noOffers")||"لا توجد عروض لهذه الخدمة حالياً"),1)])]),_:1})]),_:1})]),_:1})):w("",!0),a(e(Ae),null,{default:i(()=>[a(e(V),{color:"secondary",variant:"ghost",onClick:o[21]||(o[21]=t=>I.value=!1)},{default:i(()=>[v(l(e(n)("common.cancel")),1)]),_:1}),a(e(V),{color:"primary",onClick:S},{default:i(()=>[v(l(e(n)("pos.addToCart")),1)]),_:1})]),_:1})]),_:1},8,["visible"]),a(e(ue),{visible:W.value,onClose:o[26]||(o[26]=t=>W.value=!1),alignment:"center"},{default:i(()=>[a(e(me),null,{default:i(()=>[a(e(ve),null,{default:i(()=>[v(l(e(n)("customers.add")||"إضافة عميلة جديدة"),1)]),_:1})]),_:1}),a(e(pe),null,{default:i(()=>[s("form",{onSubmit:Ee(se,["prevent"])},[s("div",Et,[s("label",Ot,l(e(n)("customers.name")),1),a(e(de),{modelValue:F.value.name,"onUpdate:modelValue":o[23]||(o[23]=t=>F.value.name=t),required:""},null,8,["modelValue"])]),s("div",Bt,[s("label",Qt,l(e(n)("customers.phone")),1),a(e(de),{modelValue:F.value.phone,"onUpdate:modelValue":o[24]||(o[24]=t=>F.value.phone=t),required:""},null,8,["modelValue"])]),s("div",Ut,[s("label",Wt,l(e(n)("customers.email")),1),a(e(de),{modelValue:F.value.email,"onUpdate:modelValue":o[25]||(o[25]=t=>F.value.email=t),type:"email"},null,8,["modelValue"])]),a(e(V),{type:"submit",color:"primary",class:"w-100",disabled:ie.value},{default:i(()=>[ie.value?(c(),$(e(y),{key:0,icon:"cil-reload",class:"spinning me-2"})):w("",!0),v(" "+l(e(n)("common.save")),1)]),_:1},8,["disabled"])],32)]),_:1})]),_:1},8,["visible"]),a(e(ue),{visible:C.value,onClose:o[29]||(o[29]=t=>C.value=!1),size:"lg",alignment:"center"},{default:i(()=>[a(e(me),null,{default:i(()=>[a(e(ve),null,{default:i(()=>[v(l(e(n)("pos.invoicePreview")||"معاينة الفاتورة"),1)]),_:1})]),_:1}),P.value?(c(),$(e(pe),{key:0,class:"p-0"},{default:i(()=>[s("div",Gt,[s("div",Ht,[o[34]||(o[34]=s("h3",{class:"fw-bold"},"SALON ASMAA",-1)),s("div",null,l(e(n)("pos.receipt"))+" #"+l(P.value.order_number),1),s("div",Kt,l(new Date().toLocaleString()),1)]),o[35]||(o[35]=s("hr",null,null,-1)),s("div",Yt,[(c(!0),m(T,null,j(P.value.items,t=>(c(),m("div",{key:t.id,class:"d-flex justify-content-between mb-2"},[s("span",null,l(t.name)+" x "+l(t.quantity),1),s("span",null,l(e(b)(t.total)),1)]))),128))]),o[36]||(o[36]=s("hr",null,null,-1)),s("div",Xt,[s("div",Zt,[s("span",null,l(e(n)("pos.subtotal")),1),s("span",null,l(e(b)(P.value.subtotal)),1)]),P.value.discount>0?(c(),m("div",Jt,[s("span",null,l(e(n)("pos.discount")),1),s("span",null,"-"+l(e(b)(P.value.discount)),1)])):w("",!0),s("div",eo,[s("span",null,l(e(n)("pos.total")),1),s("span",null,l(e(b)(P.value.total)),1)])]),s("div",so,[s("p",null,l(e(n)("pos.thankYou")||"شكراً لزيارتكم"),1)])])]),_:1})):w("",!0),a(e(Ae),null,{default:i(()=>[a(e(V),{color:"secondary",onClick:o[27]||(o[27]=t=>C.value=!1)},{default:i(()=>[v(l(e(n)("common.close")),1)]),_:1}),a(e(V),{color:"primary",onClick:o[28]||(o[28]=t=>u.window.print())},{default:i(()=>[a(e(y),{icon:"cil-print",class:"me-2"}),v(" "+l(e(n)("common.print")),1)]),_:1})]),_:1})]),_:1},8,["visible"]),a(e(ue),{visible:ne.value,onClose:o[30]||(o[30]=t=>ne.value=!1),alignment:"center"},{default:i(()=>[a(e(me),null,{default:i(()=>[a(e(ve),null,{default:i(()=>[v(l(e(n)("settings.title")||"الإعدادات السريعة"),1)]),_:1})]),_:1}),a(e(pe),null,{default:i(()=>[s("div",to,[s("div",oo,[s("div",null,[s("div",ao,l(e(n)("pos.autoPrint")||"طباعة تلقائية"),1),s("div",lo,l(e(n)("pos.autoPrintDesc")||"طباعة الفاتورة فور إتمام الطلب"),1)]),a(B)]),s("div",no,[s("div",null,[s("div",io,l(e(n)("pos.soundNotifications")||"تنبيهات صوتية"),1),s("div",ro,l(e(n)("pos.soundNotificationsDesc")||"تفعيل الصوت عند استدعاء الطابور"),1)]),a(B,{checked:!0})]),o[37]||(o[37]=s("hr",null,null,-1)),a(e(V),{color:"danger",variant:"outline",class:"w-100",onClick:be},{default:i(()=>[a(e(y),{icon:"cil-lock-locked",class:"me-2"}),v(" "+l(e(n)("pos.closeSession")||"إغلاق الجلسة"),1)]),_:1})])]),_:1})]),_:1},8,["visible"])])}}},qo=Qe(co,[["__scopeId","data-v-d6a09a5d"]]);export{qo as default};
