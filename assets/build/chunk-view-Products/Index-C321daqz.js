import{f as k,g as le,i as oe,c as w,o as b,d as a,b as s,p as i,u as e,a5 as se,v as N,O as g,C as d,t as c,Y as B,Z as p,a0 as ie,a1 as ne,$ as y,_ as D,a3 as A,q as H,a2 as ce,F as re,k as ue,a as L,X as W,n as j,a4 as de,a6 as me,a7 as pe,a8 as ve,a9 as _e}from"../chunk-vendor-vue-DxcSX1Jd.js";import{u as ge,a as U}from"../chunk-component-NotificationsBell-eCwis6PW.js";import{P as fe}from"../chunk-component-PageHeader-BsA6C9en.js";import{S as M}from"../chunk-component-StatCard-AHk13FwB.js";import{_ as ke,C as z}from"../chunk-component-Card-BWbCGpFM.js";import{E as be}from"../chunk-component-EmptyState-B78c8qVh.js";import{L as ye}from"../chunk-component-LoadingSpinner-PYO1Yq7-.js";import{a as he}from"../chunk-view-Bookings/BookingAppearance-CtCwBfZ1.js";import"../chunk-vendor-BwxB3d-x.js";import"../chunk-vendor-charts-CNHMDSF7.js";import"../chunk-vendor-pinia-DRDRCEXO.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-Sidebar-DOq58Wm8.js";import"../chunk-view-Bookings/BookingFormPreview-BJuYIHYB.js";const Ce={class:"products-page"},Ve={class:"stats-grid"},we={value:""},Ne={value:""},xe={value:"1"},Se={value:"0"},Pe={key:2,class:"table-wrapper"},qe={class:"table-header-row"},Ue={class:"th-name"},Me={class:"th-sku"},$e={class:"th-purchase"},Fe={class:"th-price"},Ee={class:"th-stock"},De={class:"th-status"},Ie={class:"th-actions"},Te={class:"td-id"},Ke={class:"product-id-badge"},Be={class:"td-name"},Ae={class:"product-name-cell"},He={class:"product-name"},Le={key:0,class:"product-category"},We={class:"td-sku"},je={class:"sku-code"},ze={class:"td-purchase"},Ge={class:"unified-amount"},Oe={class:"td-price"},Re={class:"unified-amount"},Xe={class:"td-stock"},Ye={class:"td-status"},Ze={class:"td-actions"},Je={class:"actions-group"},Qe=["onClick","title"],et=["onClick","title"],tt=["onClick","title"],at={key:0,class:"d-flex justify-content-between align-items-center"},lt={class:"text-muted"},ot={value:""},st={__name:"Index",setup(it){const{t:l}=ge(),C=he(),f=k([]),$=k(!1),S=k(!1),V=k(!1),x=k(null),P=k(!1),m=k({search:"",category:"",is_active:"",low_stock:!1}),u=k({current_page:1,per_page:20,total:0,total_pages:0}),q=le(()=>{const n=f.value.length,t=f.value.filter(_=>_.is_active).length,o=f.value.filter(_=>_.stock_quantity<=(_.min_stock_level||5)).length,h=f.value.reduce((_,K)=>{const te=K.stock_quantity||0,ae=parseFloat(K.purchase_price)||0;return _+te*ae},0);return{total:n,active:t,lowStock:o,totalValue:h}}),F=n=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",minimumFractionDigits:3}).format(n||0),G=n=>{if(!n&&n!==0)return"0 KWD";const t=parseFloat(n);return t>=1e3?`${(t/1e3).toFixed(1)}K KWD`:`${t.toFixed(0)} KWD`},v=async()=>{var n;$.value=!0;try{const t={page:u.value.current_page,per_page:u.value.per_page,...m.value};m.value.low_stock&&(t.low_stock=1),Object.keys(t).forEach(_=>{(t[_]===""||t[_]===!1)&&delete t[_]});const o=await U.get("/products",{params:t,noCache:!0}),h=((n=o.data)==null?void 0:n.data)||o.data||{};f.value=h.items||[],u.value=h.pagination||u.value}catch(t){console.error("Error loading products:",t),C.error(l("common.errorLoading")),f.value=[],u.value={current_page:1,per_page:20,total:0,total_pages:0}}finally{$.value=!1}},O=n=>{u.value.current_page=n,v()};let I;const R=()=>{clearTimeout(I),I=setTimeout(()=>{u.value.current_page=1,v()},500)},X=()=>{m.value={search:"",category:"",is_active:"",low_stock:!1},u.value.current_page=1,v()},Y=()=>{console.log("Exporting products data..."),alert(l("common.export")+" - "+l("products.title"))},Z=n=>{console.log("View product:",n),alert(`Product: ${n.name_ar||n.name}
SKU: ${n.sku}
Stock: ${n.stock_quantity}
Price: ${F(n.selling_price||n.price)}`)},T=()=>{S.value=!0,V.value=!1,x.value=null,r.value={name:"",name_ar:"",sku:"",category:"",purchase_price:0,selling_price:0,stock_quantity:0,min_stock_level:5,is_active:!0}},J=n=>{V.value=!0,S.value=!1,x.value=n,r.value={name:n.name||"",name_ar:n.name_ar||"",sku:n.sku||"",category:n.category||"",purchase_price:Number(n.purchase_price||0),selling_price:Number(n.selling_price||n.price||0),stock_quantity:Number(n.stock_quantity||0),min_stock_level:Number(n.min_stock_level||5),is_active:!!n.is_active}},E=()=>{S.value=!1,V.value=!1,x.value=null,P.value=!1},r=k({name:"",name_ar:"",sku:"",category:"",purchase_price:0,selling_price:0,stock_quantity:0,min_stock_level:5,is_active:!0}),Q=async()=>{var n;if(!r.value.name||!r.value.sku){C.error("Name and SKU are required");return}P.value=!0;try{const t={...r.value,purchase_price:Number(r.value.purchase_price||0),selling_price:Number(r.value.selling_price||0),stock_quantity:Number(r.value.stock_quantity||0),min_stock_level:Number(r.value.min_stock_level||0),is_active:r.value.is_active?1:0};(n=x.value)!=null&&n.id?await U.put(`/products/${x.value.id}`,t):await U.post("/products",t),C.success(l("common.save")),E(),v()}catch(t){console.error("Save product error:",t),C.error(l("products.saveError")||l("common.errorLoading"))}finally{P.value=!1}},ee=async n=>{if(confirm(`${l("products.deleteConfirm")} ${n.name_ar||n.name}?`))try{await U.delete(`/products/${n.id}`),C.success(l("common.delete")),v()}catch(t){console.error("Error deleting product:",t),C.error(l("products.deleteError")||l("common.errorLoading"))}};return oe(()=>{v()}),(n,t)=>(b(),w("div",Ce,[a(fe,{title:e(l)("products.title"),subtitle:e(l)("products.subtitle")||e(l)("products.title")+" - "+e(l)("dashboard.subtitle")},{icon:i(()=>[a(e(d),{icon:"cil-basket"})]),actions:i(()=>[a(e(N),{color:"secondary",variant:"outline",onClick:Y,class:"me-2 export-btn"},{default:i(()=>[a(e(d),{icon:"cil-cloud-download",class:"me-2"}),g(" "+c(e(l)("common.export")),1)]),_:1}),a(e(N),{color:"primary",class:"btn-primary-custom",onClick:T},{default:i(()=>[a(e(d),{icon:"cil-plus",class:"me-2"}),g(" "+c(e(l)("products.addNew")),1)]),_:1})]),_:1},8,["title","subtitle"]),s("div",Ve,[a(M,{label:e(l)("products.title"),value:q.value.total||f.value.length,"badge-variant":"info",color:"gold",clickable:!0,onClick:t[0]||(t[0]=()=>{m.value.is_active="",m.value.low_stock=!1,u.value.current_page=1,v()})},{icon:i(()=>[a(e(d),{icon:"cil-basket"})]),_:1},8,["label","value"]),a(M,{label:e(l)("products.active"),value:q.value.active,"badge-variant":"success",color:"gold",clickable:!0,onClick:t[1]||(t[1]=()=>{m.value.is_active=1,u.value.current_page=1,v()})},{icon:i(()=>[a(e(d),{icon:"cil-check-circle"})]),_:1},8,["label","value"]),a(M,{label:e(l)("products.lowStock"),value:q.value.lowStock,"badge-variant":"warning",color:"gold",clickable:!0,onClick:t[2]||(t[2]=()=>{m.value.low_stock=!0,u.value.current_page=1,v()})},{icon:i(()=>[a(e(d),{icon:"cil-warning"})]),_:1},8,["label","value"]),a(M,{label:e(l)("products.totalValue"),value:G(q.value.totalValue),"badge-variant":"info",color:"gold"},{icon:i(()=>[a(e(d),{icon:"cil-dollar"})]),_:1},8,["label","value"])]),a(z,{title:e(l)("common.filter"),icon:"cil-filter",class:"filters-card"},{default:i(()=>[a(e(B),{class:"g-3"},{default:i(()=>[a(e(p),{md:4},{default:i(()=>[a(e(ie),{class:"search-input-group"},{default:i(()=>[a(e(ne),{class:"search-icon-wrapper"},{default:i(()=>[a(e(d),{icon:"cil-magnifying-glass"})]),_:1}),a(e(y),{modelValue:m.value.search,"onUpdate:modelValue":t[3]||(t[3]=o=>m.value.search=o),placeholder:e(l)("common.search"),onInput:R,class:"filter-input search-input"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(e(p),{md:3},{default:i(()=>[a(e(D),{modelValue:m.value.category,"onUpdate:modelValue":t[4]||(t[4]=o=>m.value.category=o),onChange:v,class:"filter-select"},{default:i(()=>[s("option",we,c(e(l)("products.category")),1),t[16]||(t[16]=s("option",{value:"Hair Care"},"Hair Care",-1)),t[17]||(t[17]=s("option",{value:"Skincare"},"Skincare",-1)),t[18]||(t[18]=s("option",{value:"Nails"},"Nails",-1)),t[19]||(t[19]=s("option",{value:"Accessories"},"Accessories",-1))]),_:1},8,["modelValue"])]),_:1}),a(e(p),{md:3},{default:i(()=>[a(e(D),{modelValue:m.value.is_active,"onUpdate:modelValue":t[5]||(t[5]=o=>m.value.is_active=o),onChange:v,class:"filter-select"},{default:i(()=>[s("option",Ne,c(e(l)("common.status")),1),s("option",xe,c(e(l)("products.active")),1),s("option",Se,c(e(l)("products.inactive")),1)]),_:1},8,["modelValue"])]),_:1}),a(e(p),{md:2},{default:i(()=>[a(e(N),{color:"secondary",variant:"outline",onClick:X,class:"w-100 reset-btn"},{default:i(()=>[a(e(d),{icon:"cil-reload",class:"me-1"}),g(" "+c(e(l)("common.reset")),1)]),_:1})]),_:1}),a(e(p),{md:12},{default:i(()=>[a(e(A),{modelValue:m.value.low_stock,"onUpdate:modelValue":t[6]||(t[6]=o=>m.value.low_stock=o),label:e(l)("products.lowStock"),onChange:v},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},8,["title"]),a(z,{title:e(l)("products.title"),icon:"cil-list"},{footer:i(()=>[u.value.total_pages>1?(b(),w("div",at,[s("div",lt,c(e(l)("common.view"))+" "+c((u.value.current_page-1)*u.value.per_page+1)+" "+c(e(l)("common.to"))+" "+c(Math.min(u.value.current_page*u.value.per_page,u.value.total))+" "+c(e(l)("common.of"))+" "+c(u.value.total),1),a(e(de),{pages:u.value.total_pages,"active-page":u.value.current_page,"onUpdate:activePage":O},null,8,["pages","active-page"])])):L("",!0)]),default:i(()=>[$.value?(b(),H(ye,{key:0,text:e(l)("common.loading")},null,8,["text"])):f.value.length===0?(b(),H(be,{key:1,title:e(l)("common.noData"),description:e(l)("products.title")+" - "+e(l)("common.noData"),"icon-color":"gray"},{action:i(()=>[a(e(N),{color:"primary",class:"btn-primary-custom",onClick:T},{default:i(()=>[g(c(e(l)("products.addNew")),1)]),_:1})]),_:1},8,["title","description"])):(b(),w("div",Pe,[a(e(ce),{hover:"",responsive:"",class:"table-modern products-table"},{default:i(()=>[s("thead",null,[s("tr",qe,[t[20]||(t[20]=s("th",{class:"th-id"},"#",-1)),s("th",Ue,c(e(l)("products.name")),1),s("th",Me,c(e(l)("products.sku")),1),s("th",$e,c(e(l)("products.purchasePrice")),1),s("th",Fe,c(e(l)("products.sellingPrice")),1),s("th",Ee,c(e(l)("products.stock")),1),s("th",De,c(e(l)("common.status")),1),s("th",Ie,c(e(l)("common.actions")),1)])]),s("tbody",null,[(b(!0),w(re,null,ue(f.value,o=>(b(),w("tr",{key:o.id,class:"table-row product-row"},[s("td",Te,[s("span",Ke,"#"+c(o.id),1)]),s("td",Be,[s("div",Ae,[s("strong",He,c(o.name_ar||o.name),1),o.category?(b(),w("small",Le,[a(e(d),{icon:"cil-tag",class:"tag-icon"}),g(" "+c(o.category),1)])):L("",!0)])]),s("td",We,[s("code",je,c(o.sku||"N/A"),1)]),s("td",ze,[s("strong",Ge,[a(e(d),{icon:"cil-dollar",class:"money-icon"}),g(" "+c(F(o.purchase_price||0)),1)])]),s("td",Oe,[s("strong",Re,[a(e(d),{icon:"cil-money",class:"money-icon"}),g(" "+c(F(o.selling_price||o.price||0)),1)])]),s("td",Xe,[a(e(W),{class:j(["unified-badge",(o.stock_quantity||0)<=(o.min_stock_level||5)?"stock-low":"stock-ok"])},{default:i(()=>[a(e(d),{icon:"cil-storage",class:"badge-icon"}),s("span",null,c(o.stock_quantity||0),1)]),_:2},1032,["class"])]),s("td",Ye,[a(e(W),{class:j(["unified-badge status-badge",o.is_active?"status-active":"status-inactive"])},{default:i(()=>[a(e(d),{icon:o.is_active?"cil-check-circle":"cil-x-circle",class:"badge-icon"},null,8,["icon"]),s("span",null,c(o.is_active?e(l)("products.active"):e(l)("products.inactive")),1)]),_:2},1032,["class"])]),s("td",Ze,[s("div",Je,[s("button",{class:"action-btn",onClick:h=>Z(o),title:e(l)("common.view")},[a(e(d),{icon:"cil-info"})],8,Qe),s("button",{class:"action-btn",onClick:h=>J(o),title:e(l)("common.edit")},[a(e(d),{icon:"cil-pencil"})],8,et),s("button",{class:"action-btn",onClick:h=>ee(o),title:e(l)("common.delete")},[a(e(d),{icon:"cil-trash"})],8,tt)])])]))),128))])]),_:1})]))]),_:1},8,["title"]),a(e(se),{visible:S.value||V.value,onClose:E,size:"lg"},{default:i(()=>[a(e(me),null,{default:i(()=>[a(e(pe),null,{default:i(()=>[a(e(d),{icon:V.value?"cil-pencil":"cil-plus",class:"me-2"},null,8,["icon"]),g(" "+c(V.value?e(l)("products.edit"):e(l)("products.addNew")),1)]),_:1})]),_:1}),a(e(ve),null,{default:i(()=>[a(e(B),{class:"g-3"},{default:i(()=>[a(e(p),{md:6},{default:i(()=>[a(e(y),{modelValue:r.value.name_ar,"onUpdate:modelValue":t[7]||(t[7]=o=>r.value.name_ar=o),label:"Arabic Name",class:"filter-input"},null,8,["modelValue"])]),_:1}),a(e(p),{md:6},{default:i(()=>[a(e(y),{modelValue:r.value.name,"onUpdate:modelValue":t[8]||(t[8]=o=>r.value.name=o),label:"Name",class:"filter-input"},null,8,["modelValue"])]),_:1}),a(e(p),{md:6},{default:i(()=>[a(e(y),{modelValue:r.value.sku,"onUpdate:modelValue":t[9]||(t[9]=o=>r.value.sku=o),label:e(l)("products.sku"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:6},{default:i(()=>[a(e(D),{modelValue:r.value.category,"onUpdate:modelValue":t[10]||(t[10]=o=>r.value.category=o),label:e(l)("products.category"),class:"filter-select"},{default:i(()=>[s("option",ot,c(e(l)("common.select")),1),t[21]||(t[21]=s("option",{value:"Hair Care"},"Hair Care",-1)),t[22]||(t[22]=s("option",{value:"Skincare"},"Skincare",-1)),t[23]||(t[23]=s("option",{value:"Nails"},"Nails",-1)),t[24]||(t[24]=s("option",{value:"Accessories"},"Accessories",-1))]),_:1},8,["modelValue","label"])]),_:1}),a(e(p),{md:4},{default:i(()=>[a(e(y),{modelValue:r.value.purchase_price,"onUpdate:modelValue":t[11]||(t[11]=o=>r.value.purchase_price=o),modelModifiers:{number:!0},type:"number",step:"0.001",min:"0",label:e(l)("products.purchasePrice"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:4},{default:i(()=>[a(e(y),{modelValue:r.value.selling_price,"onUpdate:modelValue":t[12]||(t[12]=o=>r.value.selling_price=o),modelModifiers:{number:!0},type:"number",step:"0.001",min:"0",label:e(l)("products.sellingPrice"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:4},{default:i(()=>[a(e(y),{modelValue:r.value.stock_quantity,"onUpdate:modelValue":t[13]||(t[13]=o=>r.value.stock_quantity=o),modelModifiers:{number:!0},type:"number",step:"1",min:"0",label:e(l)("products.stock"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:4},{default:i(()=>[a(e(y),{modelValue:r.value.min_stock_level,"onUpdate:modelValue":t[14]||(t[14]=o=>r.value.min_stock_level=o),modelModifiers:{number:!0},type:"number",step:"1",min:"0",label:e(l)("products.lowStock"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:8,class:"d-flex align-items-center"},{default:i(()=>[a(e(A),{modelValue:r.value.is_active,"onUpdate:modelValue":t[15]||(t[15]=o=>r.value.is_active=o),label:e(l)("products.active")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),a(e(_e),null,{default:i(()=>[a(e(N),{color:"secondary",onClick:E},{default:i(()=>[g(c(e(l)("common.cancel")),1)]),_:1}),a(e(N),{color:"primary",class:"btn-primary-custom",disabled:P.value,onClick:Q},{default:i(()=>[a(e(d),{icon:"cil-save",class:"me-2"}),g(" "+c(e(l)("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["visible"])]))}},ht=ke(st,[["__scopeId","data-v-196eda07"]]);export{ht as default};
