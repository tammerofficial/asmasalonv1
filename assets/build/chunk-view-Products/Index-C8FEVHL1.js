import{f as k,e as le,k as oe,c as w,o as b,d as a,b as s,w as i,u as e,Z as se,x as N,P as v,C as d,t as c,_ as A,$ as p,a2 as ie,a3 as ne,a1 as y,a0 as E,a5 as L,s as I,a4 as ce,F as re,g as ue,a as T,Y as H,n as j,a6 as de,a7 as me,a8 as pe,a9 as _e,aa as ve}from"../chunk-vendor-vue-DkCSGS5r.js";import{u as ge,a as q}from"../chunk-component-NotificationsBell-CdT4gVQ0.js";import{P as fe}from"../chunk-component-PageHeader-2UM0PeLN.js";import{S as M}from"../chunk-component-StatCard-CQbqZfDa.js";import{_ as ke,C as z}from"../chunk-component-Card-B6TBnHC7.js";import{E as be}from"../chunk-component-EmptyState-C_n04Mxq.js";import{L as ye}from"../chunk-component-LoadingSpinner-BDznbj6f.js";import{H as Ce}from"../chunk-component-HelpSection-DCIZko8t.js";import{u as he}from"../chunk-view-AppleWallet/Simulator-f79KHPiS.js";import"../chunk-vendor-6xaPOP3o.js";import"../chunk-vendor-charts-C66rl4lP.js";import"../chunk-vendor-pinia-BW6wRy0H.js";import"../chunk-vendor-axios-B9ygI19o.js";const Ve={class:"products-page"},we={class:"stats-grid"},Ne={value:""},xe={value:""},Se={value:"1"},Pe={value:"0"},Ue={key:2,class:"table-wrapper"},qe={class:"table-header-row"},Me={class:"th-name"},$e={class:"th-sku"},Fe={class:"th-purchase"},De={class:"th-price"},Ee={class:"th-stock"},Ie={class:"th-status"},Te={class:"th-actions"},He={class:"td-id"},Ke={class:"product-id-badge"},Be={class:"td-name"},We={class:"product-name-cell"},Ae={class:"d-flex align-items-center gap-2"},Le={class:"product-name"},je={key:0,class:"product-category"},ze={class:"td-sku"},Ge={class:"sku-code"},Oe={class:"td-purchase"},Re={class:"unified-amount"},Ye={class:"td-price"},Ze={class:"unified-amount"},Je={class:"td-stock"},Qe={class:"td-status"},Xe={class:"td-actions"},et={class:"actions-group"},tt=["onClick","title"],at=["onClick","title"],lt=["onClick","title"],ot={key:0,class:"d-flex justify-content-between align-items-center"},st={class:"text-muted"},it={value:""},nt={__name:"Index",setup(ct){const{t:l}=ge(),h=he(),f=k([]),$=k(!1),S=k(!1),V=k(!1),x=k(null),P=k(!1),m=k({search:"",category:"",is_active:"",low_stock:!1}),u=k({current_page:1,per_page:20,total:0,total_pages:0}),U=le(()=>{const n=f.value.length,t=f.value.filter(g=>g.is_active).length,o=f.value.filter(g=>g.stock_quantity<=(g.min_stock_level||5)).length,C=f.value.reduce((g,W)=>{const te=W.stock_quantity||0,ae=parseFloat(W.purchase_price)||0;return g+te*ae},0);return{total:n,active:t,lowStock:o,totalValue:C}}),F=n=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",minimumFractionDigits:3}).format(n||0),G=n=>{if(!n&&n!==0)return"0 KWD";const t=parseFloat(n);return t>=1e3?`${(t/1e3).toFixed(1)}K KWD`:`${t.toFixed(0)} KWD`},_=async()=>{var n;$.value=!0;try{const t={page:u.value.current_page,per_page:u.value.per_page,...m.value};m.value.low_stock&&(t.low_stock=1),Object.keys(t).forEach(g=>{(t[g]===""||t[g]===!1)&&delete t[g]});const o=await q.get("/products",{params:t,noCache:!0}),C=((n=o.data)==null?void 0:n.data)||o.data||{};f.value=C.items||[],u.value=C.pagination||u.value}catch(t){console.error("Error loading products:",t),h.error(l("common.errorLoading")),f.value=[],u.value={current_page:1,per_page:20,total:0,total_pages:0}}finally{$.value=!1}},O=n=>{u.value.current_page=n,_()};let K;const R=()=>{clearTimeout(K),K=setTimeout(()=>{u.value.current_page=1,_()},500)},Y=()=>{m.value={search:"",category:"",is_active:"",low_stock:!1},u.value.current_page=1,_()},Z=()=>{console.log("Exporting products data..."),alert(l("common.export")+" - "+l("products.title"))},J=n=>{console.log("View product:",n),alert(`Product: ${n.name_ar||n.name}
SKU: ${n.sku}
Stock: ${n.stock_quantity}
Price: ${F(n.selling_price||n.price)}`)},B=()=>{S.value=!0,V.value=!1,x.value=null,r.value={name:"",name_ar:"",sku:"",category:"",purchase_price:0,selling_price:0,stock_quantity:0,min_stock_level:5,is_active:!0}},Q=n=>{V.value=!0,S.value=!1,x.value=n,r.value={name:n.name||"",name_ar:n.name_ar||"",sku:n.sku||"",category:n.category||"",purchase_price:Number(n.purchase_price||0),selling_price:Number(n.selling_price||n.price||0),stock_quantity:Number(n.stock_quantity||0),min_stock_level:Number(n.min_stock_level||5),is_active:!!n.is_active}},D=()=>{S.value=!1,V.value=!1,x.value=null,P.value=!1},r=k({name:"",name_ar:"",sku:"",category:"",purchase_price:0,selling_price:0,stock_quantity:0,min_stock_level:5,is_active:!0}),X=async()=>{var n;if(!r.value.name||!r.value.sku){h.error("Name and SKU are required");return}P.value=!0;try{const t={...r.value,purchase_price:Number(r.value.purchase_price||0),selling_price:Number(r.value.selling_price||0),stock_quantity:Number(r.value.stock_quantity||0),min_stock_level:Number(r.value.min_stock_level||0),is_active:r.value.is_active?1:0};(n=x.value)!=null&&n.id?await q.put(`/products/${x.value.id}`,t):await q.post("/products",t),h.success(l("common.save")),D(),_()}catch(t){console.error("Save product error:",t),h.error(l("products.saveError")||l("common.errorLoading"))}finally{P.value=!1}},ee=async n=>{if(confirm(`${l("products.deleteConfirm")} ${n.name_ar||n.name}?`))try{await q.delete(`/products/${n.id}`),h.success(l("common.delete")),_()}catch(t){console.error("Error deleting product:",t),h.error(l("products.deleteError")||l("common.errorLoading"))}};return oe(()=>{_()}),(n,t)=>(b(),w("div",Ve,[a(fe,{title:e(l)("products.title"),subtitle:e(l)("products.subtitle")||e(l)("products.title")+" - "+e(l)("dashboard.subtitle")},{icon:i(()=>[a(e(d),{icon:"cil-basket"})]),actions:i(()=>[a(e(N),{color:"secondary",variant:"outline",onClick:Z,class:"me-2 export-btn"},{default:i(()=>[a(e(d),{icon:"cil-cloud-download",class:"me-2"}),v(" "+c(e(l)("common.export")),1)]),_:1}),a(e(N),{color:"primary",class:"btn-primary-custom",onClick:B},{default:i(()=>[a(e(d),{icon:"cil-plus",class:"me-2"}),v(" "+c(e(l)("products.addNew")),1)]),_:1})]),_:1},8,["title","subtitle"]),s("div",we,[a(M,{label:e(l)("products.title"),value:U.value.total||f.value.length,"badge-variant":"info",color:"gold",clickable:!0,onClick:t[0]||(t[0]=()=>{m.value.is_active="",m.value.low_stock=!1,u.value.current_page=1,_()})},{icon:i(()=>[a(e(d),{icon:"cil-basket"})]),_:1},8,["label","value"]),a(M,{label:e(l)("products.active"),value:U.value.active,"badge-variant":"success",color:"gold",clickable:!0,onClick:t[1]||(t[1]=()=>{m.value.is_active=1,u.value.current_page=1,_()})},{icon:i(()=>[a(e(d),{icon:"cil-check-circle"})]),_:1},8,["label","value"]),a(M,{label:e(l)("products.lowStock"),value:U.value.lowStock,"badge-variant":"warning",color:"gold",clickable:!0,onClick:t[2]||(t[2]=()=>{m.value.low_stock=!0,u.value.current_page=1,_()})},{icon:i(()=>[a(e(d),{icon:"cil-warning"})]),_:1},8,["label","value"]),a(M,{label:e(l)("products.totalValue"),value:G(U.value.totalValue),"badge-variant":"info",color:"gold"},{icon:i(()=>[a(e(d),{icon:"cil-dollar"})]),_:1},8,["label","value"])]),a(z,{title:e(l)("common.filter"),icon:"cil-filter",class:"filters-card"},{default:i(()=>[a(e(A),{class:"g-3"},{default:i(()=>[a(e(p),{md:4},{default:i(()=>[a(e(ie),{class:"search-input-group"},{default:i(()=>[a(e(ne),{class:"search-icon-wrapper"},{default:i(()=>[a(e(d),{icon:"cil-magnifying-glass"})]),_:1}),a(e(y),{modelValue:m.value.search,"onUpdate:modelValue":t[3]||(t[3]=o=>m.value.search=o),placeholder:e(l)("common.search"),onInput:R,class:"filter-input search-input"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),a(e(p),{md:3},{default:i(()=>[a(e(E),{modelValue:m.value.category,"onUpdate:modelValue":t[4]||(t[4]=o=>m.value.category=o),onChange:_,class:"filter-select"},{default:i(()=>[s("option",Ne,c(e(l)("products.category")),1),t[16]||(t[16]=s("option",{value:"Hair Care"},"Hair Care",-1)),t[17]||(t[17]=s("option",{value:"Skincare"},"Skincare",-1)),t[18]||(t[18]=s("option",{value:"Nails"},"Nails",-1)),t[19]||(t[19]=s("option",{value:"Accessories"},"Accessories",-1))]),_:1},8,["modelValue"])]),_:1}),a(e(p),{md:3},{default:i(()=>[a(e(E),{modelValue:m.value.is_active,"onUpdate:modelValue":t[5]||(t[5]=o=>m.value.is_active=o),onChange:_,class:"filter-select"},{default:i(()=>[s("option",xe,c(e(l)("common.status")),1),s("option",Se,c(e(l)("products.active")),1),s("option",Pe,c(e(l)("products.inactive")),1)]),_:1},8,["modelValue"])]),_:1}),a(e(p),{md:2},{default:i(()=>[a(e(N),{color:"secondary",variant:"outline",onClick:Y,class:"w-100 reset-btn"},{default:i(()=>[a(e(d),{icon:"cil-reload",class:"me-1"}),v(" "+c(e(l)("common.reset")),1)]),_:1})]),_:1}),a(e(p),{md:12},{default:i(()=>[a(e(L),{modelValue:m.value.low_stock,"onUpdate:modelValue":t[6]||(t[6]=o=>m.value.low_stock=o),label:e(l)("products.lowStock"),onChange:_},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},8,["title"]),a(z,{title:e(l)("products.title"),icon:"cil-list"},{footer:i(()=>[u.value.total_pages>1?(b(),w("div",ot,[s("div",st,c(e(l)("common.view"))+" "+c((u.value.current_page-1)*u.value.per_page+1)+" "+c(e(l)("common.to"))+" "+c(Math.min(u.value.current_page*u.value.per_page,u.value.total))+" "+c(e(l)("common.of"))+" "+c(u.value.total),1),a(e(de),{pages:u.value.total_pages,"active-page":u.value.current_page,"onUpdate:activePage":O},null,8,["pages","active-page"])])):T("",!0)]),default:i(()=>[$.value?(b(),I(ye,{key:0,text:e(l)("common.loading")},null,8,["text"])):f.value.length===0?(b(),I(be,{key:1,title:e(l)("common.noData"),description:e(l)("products.title")+" - "+e(l)("common.noData"),"icon-color":"gray"},{action:i(()=>[a(e(N),{color:"primary",class:"btn-primary-custom",onClick:B},{default:i(()=>[v(c(e(l)("products.addNew")),1)]),_:1})]),_:1},8,["title","description"])):(b(),w("div",Ue,[a(e(ce),{hover:"",responsive:"",class:"table-modern products-table"},{default:i(()=>[s("thead",null,[s("tr",qe,[t[20]||(t[20]=s("th",{class:"th-id"},"#",-1)),s("th",Me,c(e(l)("products.name")),1),s("th",$e,c(e(l)("products.sku")),1),s("th",Fe,c(e(l)("products.purchasePrice")),1),s("th",De,c(e(l)("products.sellingPrice")),1),s("th",Ee,c(e(l)("products.stock")),1),s("th",Ie,c(e(l)("common.status")),1),s("th",Te,c(e(l)("common.actions")),1)])]),s("tbody",null,[(b(!0),w(re,null,ue(f.value,o=>(b(),w("tr",{key:o.id,class:"table-row product-row"},[s("td",He,[s("span",Ke,"#"+c(o.id),1)]),s("td",Be,[s("div",We,[s("div",Ae,[s("strong",Le,c(o.name_ar||o.name),1),o.wc_product_id?(b(),I(e(H),{key:0,color:"success",class:"wc-sync-badge",title:"WooCommerce Product ID: "+o.wc_product_id},{default:i(()=>[a(e(d),{icon:"cil-cart",class:"me-1"}),t[21]||(t[21]=v(" WC ",-1))]),_:1},8,["title"])):T("",!0)]),o.category?(b(),w("small",je,[a(e(d),{icon:"cil-tag",class:"tag-icon"}),v(" "+c(o.category),1)])):T("",!0)])]),s("td",ze,[s("code",Ge,c(o.sku||"N/A"),1)]),s("td",Oe,[s("strong",Re,[a(e(d),{icon:"cil-dollar",class:"money-icon"}),v(" "+c(F(o.purchase_price||0)),1)])]),s("td",Ye,[s("strong",Ze,[a(e(d),{icon:"cil-money",class:"money-icon"}),v(" "+c(F(o.selling_price||o.price||0)),1)])]),s("td",Je,[a(e(H),{class:j(["unified-badge",(o.stock_quantity||0)<=(o.min_stock_level||5)?"stock-low":"stock-ok"])},{default:i(()=>[a(e(d),{icon:"cil-storage",class:"badge-icon"}),s("span",null,c(o.stock_quantity||0),1)]),_:2},1032,["class"])]),s("td",Qe,[a(e(H),{class:j(["unified-badge status-badge",o.is_active?"status-active":"status-inactive"])},{default:i(()=>[a(e(d),{icon:o.is_active?"cil-check-circle":"cil-x-circle",class:"badge-icon"},null,8,["icon"]),s("span",null,c(o.is_active?e(l)("products.active"):e(l)("products.inactive")),1)]),_:2},1032,["class"])]),s("td",Xe,[s("div",et,[s("button",{class:"action-btn",onClick:C=>J(o),title:e(l)("common.view")},[a(e(d),{icon:"cil-info"})],8,tt),s("button",{class:"action-btn",onClick:C=>Q(o),title:e(l)("common.edit")},[a(e(d),{icon:"cil-pencil"})],8,at),s("button",{class:"action-btn",onClick:C=>ee(o),title:e(l)("common.delete")},[a(e(d),{icon:"cil-trash"})],8,lt)])])]))),128))])]),_:1})]))]),_:1},8,["title"]),a(e(se),{visible:S.value||V.value,onClose:D,size:"lg"},{default:i(()=>[a(e(me),null,{default:i(()=>[a(e(pe),null,{default:i(()=>[a(e(d),{icon:V.value?"cil-pencil":"cil-plus",class:"me-2"},null,8,["icon"]),v(" "+c(V.value?e(l)("products.edit"):e(l)("products.addNew")),1)]),_:1})]),_:1}),a(e(_e),null,{default:i(()=>[a(e(A),{class:"g-3"},{default:i(()=>[a(e(p),{md:6},{default:i(()=>[a(e(y),{modelValue:r.value.name_ar,"onUpdate:modelValue":t[7]||(t[7]=o=>r.value.name_ar=o),label:"Arabic Name",class:"filter-input"},null,8,["modelValue"])]),_:1}),a(e(p),{md:6},{default:i(()=>[a(e(y),{modelValue:r.value.name,"onUpdate:modelValue":t[8]||(t[8]=o=>r.value.name=o),label:"Name",class:"filter-input"},null,8,["modelValue"])]),_:1}),a(e(p),{md:6},{default:i(()=>[a(e(y),{modelValue:r.value.sku,"onUpdate:modelValue":t[9]||(t[9]=o=>r.value.sku=o),label:e(l)("products.sku"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:6},{default:i(()=>[a(e(E),{modelValue:r.value.category,"onUpdate:modelValue":t[10]||(t[10]=o=>r.value.category=o),label:e(l)("products.category"),class:"filter-select"},{default:i(()=>[s("option",it,c(e(l)("common.select")),1),t[22]||(t[22]=s("option",{value:"Hair Care"},"Hair Care",-1)),t[23]||(t[23]=s("option",{value:"Skincare"},"Skincare",-1)),t[24]||(t[24]=s("option",{value:"Nails"},"Nails",-1)),t[25]||(t[25]=s("option",{value:"Accessories"},"Accessories",-1))]),_:1},8,["modelValue","label"])]),_:1}),a(e(p),{md:4},{default:i(()=>[a(e(y),{modelValue:r.value.purchase_price,"onUpdate:modelValue":t[11]||(t[11]=o=>r.value.purchase_price=o),modelModifiers:{number:!0},type:"number",step:"0.001",min:"0",label:e(l)("products.purchasePrice"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:4},{default:i(()=>[a(e(y),{modelValue:r.value.selling_price,"onUpdate:modelValue":t[12]||(t[12]=o=>r.value.selling_price=o),modelModifiers:{number:!0},type:"number",step:"0.001",min:"0",label:e(l)("products.sellingPrice"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:4},{default:i(()=>[a(e(y),{modelValue:r.value.stock_quantity,"onUpdate:modelValue":t[13]||(t[13]=o=>r.value.stock_quantity=o),modelModifiers:{number:!0},type:"number",step:"1",min:"0",label:e(l)("products.stock"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:4},{default:i(()=>[a(e(y),{modelValue:r.value.min_stock_level,"onUpdate:modelValue":t[14]||(t[14]=o=>r.value.min_stock_level=o),modelModifiers:{number:!0},type:"number",step:"1",min:"0",label:e(l)("products.lowStock"),class:"filter-input"},null,8,["modelValue","label"])]),_:1}),a(e(p),{md:8,class:"d-flex align-items-center"},{default:i(()=>[a(e(L),{modelValue:r.value.is_active,"onUpdate:modelValue":t[15]||(t[15]=o=>r.value.is_active=o),label:e(l)("products.active")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),a(e(ve),null,{default:i(()=>[a(e(N),{color:"secondary",onClick:D},{default:i(()=>[v(c(e(l)("common.cancel")),1)]),_:1}),a(e(N),{color:"primary",class:"btn-primary-custom",disabled:P.value,onClick:X},{default:i(()=>[a(e(d),{icon:"cil-save",class:"me-2"}),v(" "+c(e(l)("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["visible"]),a(Ce,{"page-key":"products"})]))}},ht=ke(nt,[["__scopeId","data-v-abe4c02e"]]);export{ht as default};
