import{f as o,j as R,c as g,o as f,b as a,a as x,t as I,F as E,g as M,R as N,S as $,m as B,n as S,d as V,u as P,C as D}from"./chunk-vendor-vue-VAxhpvd9.js";import{a as _}from"./chunk-component-NotificationsBell-CTLJWkW4.js";import{_ as F}from"./chunk-component-Card-DPM96EeB.js";import"./chunk-vendor-Ltsl4QyH.js";import"./chunk-vendor-pinia-CjQxP09R.js";import"./chunk-vendor-axios-B9ygI19o.js";const T={class:"rating-page"},j={class:"rating-container"},q={class:"rating-header"},z={class:"rating-subtitle"},L={class:"rating-stars"},U=["onClick","onMouseenter"],A={class:"rating-comment"},G={class:"rating-actions"},H=["disabled"],J={key:0,class:"rating-success"},K={__name:"Rating",setup(O){const p=B(),n=o(0),c=o(0),d=o(""),l=o(!1),b=o(!1),k=o("Staff"),i=o(null),v=o(null),y=o(null),w=async()=>{var t,e;const r=p.query.booking_id||p.params.booking_id;if(!r){console.error("No booking_id provided");return}v.value=parseInt(r);try{const s=await _.get(`/bookings/${v.value}`),m=((t=s.data)==null?void 0:t.data)||s.data;if(m&&(i.value=m.staff_id,y.value=m.customer_id,i.value))try{const u=await _.get(`/staff/${i.value}`),h=((e=u.data)==null?void 0:e.data)||u.data;h&&(k.value=h.name||"Staff")}catch(u){console.error("Error loading staff:",u)}}catch(s){console.error("Error loading booking:",s)}},C=async()=>{if(!n.value||!i.value){alert("Please select a rating");return}l.value=!0;try{await _.post("/ratings",{staff_id:i.value,customer_id:y.value,booking_id:v.value,rating:n.value,comment:d.value}),b.value=!0,setTimeout(()=>{window.close()},2e3)}catch(r){console.error("Error submitting rating:",r),alert("Error submitting rating. Please try again.")}finally{l.value=!1}};return R(()=>{w()}),(r,t)=>(f(),g("div",T,[a("div",j,[a("div",q,[t[2]||(t[2]=a("h1",{class:"rating-title"},"كيف كانت تجربتك؟",-1)),a("p",z,"قيّمي الموظفة "+I(k.value),1)]),a("div",L,[(f(),g(E,null,M(5,e=>a("button",{key:e,class:S(["star-btn",{active:n.value>=e,hover:c.value>=e}]),onClick:s=>n.value=e,onMouseenter:s=>c.value=e,onMouseleave:t[0]||(t[0]=s=>c.value=0)},[V(P(D),{icon:"cil-star"})],42,U)),64))]),a("div",A,[t[3]||(t[3]=a("label",{for:"comment"},"تعليق (اختياري):",-1)),N(a("textarea",{id:"comment","onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e),rows:"4",placeholder:"شاركينا رأيك...",class:"comment-input"},null,512),[[$,d.value]])]),a("div",G,[a("button",{class:"submit-btn",onClick:C,disabled:!n.value||l.value},I(l.value?"جاري الإرسال...":"إرسال التقييم"),9,H)]),b.value?(f(),g("div",J,[...t[4]||(t[4]=[a("p",null,"شكراً لك! تم إرسال تقييمك بنجاح.",-1)])])):x("",!0)])]))}},at=F(K,[["__scopeId","data-v-a1aaa3d6"]]);export{at as default};
