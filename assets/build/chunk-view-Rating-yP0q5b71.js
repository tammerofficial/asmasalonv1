import{f as o,i as x,c as f,o as g,b as e,a as C,t as w,F as E,k as M,R as $,S as B,l as N,n as S}from"./chunk-vendor-vue-9XB69CcG.js";import{a as _}from"./chunk-component-NotificationsBell-B08mqdYR.js";import{_ as P}from"./chunk-component-Card-CPZTx4Dn.js";import"./chunk-vendor-6xaPOP3o.js";import"./chunk-vendor-charts-C66rl4lP.js";import"./chunk-vendor-pinia-BpPt1UDF.js";import"./chunk-vendor-axios-B9ygI19o.js";const V={class:"rating-page"},D={class:"rating-container"},F={class:"rating-header"},T={class:"rating-subtitle"},q={class:"rating-stars"},z=["onClick","onMouseenter"],L={class:"rating-comment"},U={class:"rating-actions"},j=["disabled"],A={key:0,class:"rating-success"},G={__name:"Rating",setup(H){const p=N(),n=o(0),c=o(0),d=o(""),l=o(!1),b=o(!1),k=o("Staff"),i=o(null),v=o(null),y=o(null),I=async()=>{var t,a;const r=p.query.booking_id||p.params.booking_id;if(!r){console.error("No booking_id provided");return}v.value=parseInt(r);try{const s=await _.get(`/bookings/${v.value}`),m=((t=s.data)==null?void 0:t.data)||s.data;if(m&&(i.value=m.staff_id,y.value=m.customer_id,i.value))try{const u=await _.get(`/staff/${i.value}`),h=((a=u.data)==null?void 0:a.data)||u.data;h&&(k.value=h.name||"Staff")}catch(u){console.error("Error loading staff:",u)}}catch(s){console.error("Error loading booking:",s)}},R=async()=>{if(!n.value||!i.value){alert("Please select a rating");return}l.value=!0;try{await _.post("/ratings",{staff_id:i.value,customer_id:y.value,booking_id:v.value,rating:n.value,comment:d.value}),b.value=!0,setTimeout(()=>{window.close()},2e3)}catch(r){console.error("Error submitting rating:",r),alert("Error submitting rating. Please try again.")}finally{l.value=!1}};return x(()=>{I()}),(r,t)=>(g(),f("div",V,[e("div",D,[e("div",F,[t[2]||(t[2]=e("h1",{class:"rating-title"},"كيف كانت تجربتك؟",-1)),e("p",T,"قيّمي الموظفة "+w(k.value),1)]),e("div",q,[(g(),f(E,null,M(5,a=>e("button",{key:a,class:S(["star-btn",{active:n.value>=a,hover:c.value>=a}]),onClick:s=>n.value=a,onMouseenter:s=>c.value=a,onMouseleave:t[0]||(t[0]=s=>c.value=0)}," ⭐ ",42,z)),64))]),e("div",L,[t[3]||(t[3]=e("label",{for:"comment"},"تعليق (اختياري):",-1)),$(e("textarea",{id:"comment","onUpdate:modelValue":t[1]||(t[1]=a=>d.value=a),rows:"4",placeholder:"شاركينا رأيك...",class:"comment-input"},null,512),[[B,d.value]])]),e("div",U,[e("button",{class:"submit-btn",onClick:R,disabled:!n.value||l.value},w(l.value?"جاري الإرسال...":"إرسال التقييم"),9,j)]),b.value?(g(),f("div",A,[...t[4]||(t[4]=[e("p",null,"✅ شكراً لك! تم إرسال تقييمك بنجاح.",-1)])])):C("",!0)])]))}},Z=P(G,[["__scopeId","data-v-4bccbf80"]]);export{Z as default};
