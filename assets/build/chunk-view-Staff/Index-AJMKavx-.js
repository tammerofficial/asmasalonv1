import{f as m,j as W,c as _,o as p,b as a,d as s,t as i,u as t,w as o,Y as X,x as v,C as c,$ as U,h as Y,F as z,g as A,a0 as J,l as O,P as C,n as M,a2 as b,aa as Q,ab as Z,a3 as I,a4 as E,X as $,a5 as tt,a6 as at,a7 as st,a8 as et}from"../chunk-vendor-vue-BKzcbwC-.js";import{u as lt,a as V}from"../chunk-component-NotificationsBell-CyBx4swB.js";import{u as ot}from"../chunk-view-AppleWallet/Simulator-WLH8OaYC.js";import{E as it}from"../chunk-component-EmptyState-QeIH5i51.js";import{H as nt}from"../chunk-component-HelpSection-B1vxldAY.js";import{_ as dt}from"../chunk-component-Card-D7ddNvJz.js";import"../chunk-vendor-Ltsl4QyH.js";import"../chunk-vendor-pinia-CsGkbfJ3.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-PageHeader-CI_3JpQM.js";const ct={class:"staff-page p-4"},rt={class:"pos-header-top d-flex justify-content-between align-items-center mb-4"},ut={class:"header-left d-flex align-items-center gap-3"},mt={class:"mb-0 fw-bold text-primary"},vt={class:"header-right d-flex gap-2"},ft={class:"nano-stats-bar mb-4"},_t={class:"stat-card-nano"},pt={class:"stat-icon-bg staff"},bt={class:"stat-info"},gt={class:"stat-value"},ht={class:"stat-card-nano"},yt={class:"stat-icon-bg rating"},Ct={class:"stat-info"},wt={class:"stat-value text-warning"},xt={class:"stat-card-nano"},kt={class:"stat-icon-bg revenue"},Vt={class:"stat-info"},St={class:"stat-value text-success"},Ft={class:"stat-card-nano"},Rt={class:"stat-icon-bg calls"},It={class:"nano-filters-bar p-3 bg-secondary rounded-4 mb-4 shadow-sm border border-light"},Tt={value:""},Mt={value:"1"},$t={value:"0"},Nt={class:"nano-panel"},Bt={key:0,class:"text-center p-5"},Dt={key:1,class:"text-center p-5"},Ut={key:2,class:"nano-grid"},zt=["onClick"],At={class:"staff-avatar-main"},Et={class:"staff-main-info mt-3 text-center"},Ht={class:"fw-bold mb-1"},jt={class:"text-muted small mb-2"},qt={class:"rating-stars mb-3"},Gt={class:"small ms-1"},Kt={class:"staff-stats-row d-flex justify-content-between border-top pt-3"},Lt={class:"stat"},Pt={class:"value text-primary fw-bold"},Wt={class:"stat"},Xt={class:"value text-success fw-bold"},Yt={class:"staff-actions-hover mt-3"},Jt={__name:"Index",setup(Ot){const{t:n}=lt(),w=ot(),H=O(),x=m(!1),S=m(!1),F=m([]),g=m({total:0,active:0,averageRating:0,totalRatings:0,totalRevenue:0}),h=m({search:"",is_active:""}),y=m(!1),R=m(!1),T=m(null),r=m({name:"",position:"",commission_rate:10,is_active:1}),f=async()=>{var d,e,l,k;x.value=!0;try{const u=await V.get("/staff",{params:{...h.value}});F.value=((e=(d=u.data)==null?void 0:d.data)==null?void 0:e.items)||((l=u.data)==null?void 0:l.items)||[];const D=await V.get("/staff/stats");g.value=((k=D.data)==null?void 0:k.data)||D.data||g.value}catch(u){console.error("Failed to load staff:",u)}finally{x.value=!1}},j=()=>{clearTimeout(window.searchTimer),window.searchTimer=setTimeout(f,500)},q=()=>{h.value={search:"",is_active:""},f()},G=()=>{R.value=!1,T.value=null,r.value={name:"",position:"",commission_rate:10,is_active:1},y.value=!0},N=d=>{R.value=!0,T.value=d.id,r.value={...d},y.value=!0},K=async()=>{S.value=!0;try{R.value?(await V.put(`/staff/${T.value}`,r.value),w.success("Staff updated")):(await V.post("/staff",r.value),w.success("Staff added")),y.value=!1,f()}catch{w.error("Failed to save staff")}finally{S.value=!1}},L=async d=>{if(confirm(`Delete staff member ${d.name}?`))try{await V.delete(`/staff/${d.id}`),w.success("Staff deleted"),f()}catch{w.error("Failed to delete staff")}},P=d=>{H.push({path:"/reports",query:{staff_id:d.id,type:"commissions"}})},B=d=>new Intl.NumberFormat("en-KW",{style:"currency",currency:"KWD",notation:"compact",minimumFractionDigits:1}).format(d||0);return W(()=>{f()}),(d,e)=>(p(),_("div",ct,[a("div",rt,[a("div",ut,[a("h2",mt,i(t(n)("staff.title")),1),s(t(X),{color:"gold",shape:"rounded-pill",class:"px-3 py-2 fw-bold text-dark"},{default:o(()=>[s(t(c),{icon:"cil-user",class:"me-1"}),C(" "+i(g.value.total||F.value.length)+" "+i(t(n)("staff.title")),1)]),_:1})]),a("div",vt,[s(t(v),{color:"primary",class:"nano-btn",onClick:G},{default:o(()=>[s(t(c),{icon:"cil-plus",class:"me-2"}),C(" "+i(t(n)("staff.addNew")),1)]),_:1}),s(t(v),{color:"secondary",variant:"ghost",onClick:f,disabled:x.value},{default:o(()=>[s(t(c),{icon:"cil-reload",class:M({spinning:x.value})},null,8,["class"])]),_:1},8,["disabled"])])]),a("div",ft,[a("div",_t,[a("div",pt,[s(t(c),{icon:"cil-user"})]),a("div",bt,[a("div",gt,i(g.value.active||0),1),e[8]||(e[8]=a("div",{class:"stat-label"},"Active Staff",-1))])]),a("div",ht,[a("div",yt,[s(t(c),{icon:"cil-star"})]),a("div",Ct,[a("div",wt,i(Number(g.value.averageRating||0).toFixed(1)),1),e[9]||(e[9]=a("div",{class:"stat-label"},"Avg. Rating",-1))])]),a("div",xt,[a("div",kt,[s(t(c),{icon:"cil-money"})]),a("div",Vt,[a("div",St,i(B(g.value.totalRevenue||0)),1),e[10]||(e[10]=a("div",{class:"stat-label"},"Total Revenue",-1))])]),a("div",Ft,[a("div",Rt,[s(t(c),{icon:"cil-bell"})]),e[11]||(e[11]=a("div",{class:"stat-info"},[a("div",{class:"stat-value text-info"},"45"),a("div",{class:"stat-label"},"Today's Calls")],-1))])]),a("div",It,[s(t(U),{class:"g-3 align-items-center"},{default:o(()=>[s(t(b),{md:"6"},{default:o(()=>[s(t(Q),null,{default:o(()=>[s(t(Z),{class:"bg-transparent border-0"},{default:o(()=>[s(t(c),{icon:"cil-magnifying-glass"})]),_:1}),s(t(I),{modelValue:h.value.search,"onUpdate:modelValue":e[0]||(e[0]=l=>h.value.search=l),placeholder:t(n)("common.search"),onInput:j,class:"border-0 bg-transparent"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),s(t(b),{md:"3"},{default:o(()=>[s(t(E),{modelValue:h.value.is_active,"onUpdate:modelValue":e[1]||(e[1]=l=>h.value.is_active=l),onChange:f,class:"rounded-3"},{default:o(()=>[a("option",Tt,i(t(n)("common.status")),1),a("option",Mt,i(t(n)("status.active")),1),a("option",$t,i(t(n)("status.inactive")),1)]),_:1},8,["modelValue"])]),_:1}),s(t(b),{md:"3"},{default:o(()=>[s(t(v),{color:"primary",variant:"ghost",class:"w-100",onClick:q},{default:o(()=>[s(t(c),{icon:"cil-filter-x",class:"me-1"}),C(i(t(n)("common.reset")),1)]),_:1})]),_:1})]),_:1})]),a("div",Nt,[x.value?(p(),_("div",Bt,[s(t(Y),{color:"primary"})])):F.value.length===0?(p(),_("div",Dt,[s(it,{title:t(n)("common.noData"),description:t(n)("staff.title")},null,8,["title","description"])])):(p(),_("div",Ut,[(p(!0),_(z,null,A(F.value,l=>{var k;return p(),_("div",{key:l.id,class:"staff-nano-card",onClick:u=>N(l)},[a("div",{class:M(["staff-status-dot",l.is_active?"active":"inactive"])},null,2),a("div",At,i((k=l.name)==null?void 0:k.charAt(0)),1),a("div",Et,[a("h5",Ht,i(l.name),1),a("p",jt,i(l.position||"Stylist"),1),a("div",qt,[(p(),_(z,null,A(5,u=>s(t(c),{icon:"cil-star",key:u,class:M(u<=(l.average_rating||0)?"text-warning":"text-muted")},null,8,["class"])),64)),a("span",Gt,"("+i(l.total_ratings||0)+")",1)])]),a("div",Kt,[a("div",Lt,[e[12]||(e[12]=a("span",{class:"label"},"Comm. %",-1)),a("span",Pt,i(l.commission_rate)+"%",1)]),a("div",Wt,[e[13]||(e[13]=a("span",{class:"label"},"Revenue",-1)),a("span",Xt,i(B(l.total_revenue||0)),1)])]),a("div",Yt,[s(t(v),{size:"sm",color:"info",variant:"ghost",onClick:$(u=>N(l),["stop"])},{default:o(()=>[s(t(c),{icon:"cil-pencil"})]),_:1},8,["onClick"]),s(t(v),{size:"sm",color:"primary",variant:"ghost",onClick:$(u=>P(l),["stop"])},{default:o(()=>[s(t(c),{icon:"cil-history"})]),_:1},8,["onClick"]),s(t(v),{size:"sm",color:"danger",variant:"ghost",onClick:$(u=>L(l),["stop"])},{default:o(()=>[s(t(c),{icon:"cil-trash"})]),_:1},8,["onClick"])])],8,zt)}),128))]))]),s(t(J),{visible:y.value,onClose:e[7]||(e[7]=l=>y.value=!1),size:"lg",alignment:"center"},{default:o(()=>[s(t(tt),null,{default:o(()=>[s(t(at),null,{default:o(()=>[C(i(R.value?t(n)("staff.edit"):t(n)("staff.addNew")),1)]),_:1})]),_:1}),s(t(st),{class:"p-4"},{default:o(()=>[s(t(U),{class:"g-3"},{default:o(()=>[s(t(b),{md:"6"},{default:o(()=>[e[14]||(e[14]=a("label",{class:"form-label fw-bold"},"Name *",-1)),s(t(I),{modelValue:r.value.name,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.name=l),required:""},null,8,["modelValue"])]),_:1}),s(t(b),{md:"6"},{default:o(()=>[e[15]||(e[15]=a("label",{class:"form-label fw-bold"},"Position",-1)),s(t(I),{modelValue:r.value.position,"onUpdate:modelValue":e[3]||(e[3]=l=>r.value.position=l)},null,8,["modelValue"])]),_:1}),s(t(b),{md:"6"},{default:o(()=>[e[16]||(e[16]=a("label",{class:"form-label fw-bold"},"Commission Rate (%)",-1)),s(t(I),{modelValue:r.value.commission_rate,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value.commission_rate=l),modelModifiers:{number:!0},type:"number",min:"0",max:"100"},null,8,["modelValue"])]),_:1}),s(t(b),{md:"6"},{default:o(()=>[e[18]||(e[18]=a("label",{class:"form-label fw-bold"},"Status",-1)),s(t(E),{modelValue:r.value.is_active,"onUpdate:modelValue":e[5]||(e[5]=l=>r.value.is_active=l)},{default:o(()=>[...e[17]||(e[17]=[a("option",{value:1},"Active",-1),a("option",{value:0},"Inactive",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(t(et),null,{default:o(()=>[s(t(v),{color:"secondary",variant:"ghost",onClick:e[6]||(e[6]=l=>y.value=!1)},{default:o(()=>[C(i(t(n)("common.cancel")),1)]),_:1}),s(t(v),{color:"primary",class:"nano-btn",onClick:K,disabled:S.value},{default:o(()=>[C(i(S.value?t(n)("common.saving"):t(n)("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["visible"]),s(nt,{"page-key":"staff"})]))}},da=dt(Jt,[["__scopeId","data-v-a9a07863"]]);export{da as default};
