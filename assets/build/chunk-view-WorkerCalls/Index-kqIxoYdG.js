import{f as k,e as F,j as G,c as r,o as _,b as s,d as t,t as e,u as a,w as c,Y as w,x as p,C as d,$ as L,P as v,n as C,a2 as N,h as O,F as R,g as W}from"../chunk-vendor-vue-VAxhpvd9.js";import{u as Y,a as x}from"../chunk-component-NotificationsBell-CTLJWkW4.js";import{u as J}from"../chunk-view-AppleWallet/Simulator-BwS6bEkK.js";import{H as K}from"../chunk-component-HelpSection-NeetTt3d.js";import{_ as Q}from"../chunk-component-Card-DPM96EeB.js";import"../chunk-vendor-Ltsl4QyH.js";import"../chunk-vendor-pinia-CjQxP09R.js";import"../chunk-vendor-axios-B9ygI19o.js";import"../chunk-component-PageHeader-CMYNL4hu.js";const U={class:"worker-calls-page p-4"},X={class:"pos-header-top d-flex justify-content-between align-items-center mb-4"},Z={class:"header-left d-flex align-items-center gap-3"},ss={class:"mb-0 fw-bold text-primary"},as={class:"header-right d-flex gap-2"},ts={class:"nano-stats-bar mb-4"},es={class:"stat-card-nano"},ls={class:"stat-icon-bg available"},os={class:"stat-info"},is={class:"stat-value text-success"},ns={class:"stat-label"},cs={class:"stat-card-nano"},ds={class:"stat-icon-bg busy"},rs={class:"stat-info"},_s={class:"stat-value text-danger"},us={class:"stat-label"},vs={class:"stat-card-nano"},hs={class:"stat-icon-bg waiting"},ms={class:"stat-info"},ps={class:"stat-value text-warning"},bs={class:"stat-label"},fs={class:"stat-card-nano"},gs={class:"stat-icon-bg total"},ks={class:"stat-info"},ws={class:"stat-value text-primary"},ys={class:"stat-label"},Cs={class:"nano-panel h-100"},xs={class:"panel-header d-flex justify-content-between align-items-center mb-4"},Bs={class:"fw-bold mb-0"},Ss={class:"d-flex gap-2"},Is={key:0,class:"text-center p-5"},As={key:1,class:"nano-staff-grid"},$s={class:"staff-avatar-container"},Ds={class:"staff-avatar-main"},Ts={class:"staff-info mt-3 text-center"},js={class:"fw-bold mb-1"},qs={class:"text-muted small mb-3"},Fs={class:"nano-panel h-100 calls-panel"},Ns={class:"fw-bold mb-4 text-warning"},Rs={key:0,class:"text-center p-5 text-muted opacity-50 border-dashed rounded-4"},Ws={key:1,class:"d-flex flex-column gap-3"},Vs={class:"d-flex justify-content-between align-items-start mb-2"},zs={class:"fw-bold text-dark fs-5"},Hs={class:"call-details mb-3"},Ms={class:"fw-bold"},Ps={class:"small text-muted"},Es={class:"d-flex gap-2"},Gs={__name:"Index",setup(Ls){const{t:o}=Y(),b=J(),h=k(!1),f=k([]),m=k([]),B=k([]),V=F(()=>f.value.filter(i=>!i.busy).length),z=F(()=>f.value.filter(i=>i.busy).length),S=async()=>{var i,n,l,u,y,I,A,$,D;h.value=!0;try{const[g,T,j]=await Promise.all([x.get("/staff",{params:{per_page:1e3}}),x.get("/queue/tickets",{params:{status:"waiting,called"}}),x.get("/bookings",{params:{date:new Date().toISOString().split("T")[0]}})]);f.value=(((n=(i=g.data)==null?void 0:i.data)==null?void 0:n.items)||((l=g.data)==null?void 0:l.items)||[]).map(q=>({...q,busy:q.status==="busy"||Math.random()>.7})),m.value=((y=(u=T.data)==null?void 0:u.data)==null?void 0:y.items)||((I=T.data)==null?void 0:I.items)||[],B.value=(($=(A=j.data)==null?void 0:A.data)==null?void 0:$.items)||((D=j.data)==null?void 0:D.items)||[]}catch(g){console.error("Failed to load worker calls data:",g)}finally{h.value=!1}},H=async i=>{try{b.success(`${o("workerCalls.calling")}: ${i.name}`)}catch{b.error("Failed to call worker")}},M=i=>{b.info("Assigning staff to ticket "+i.ticket_number)},P=i=>{confirm("Cancel this call?")&&b.warning("Call cancelled")},E=()=>{window.open("#/worker-calls/display","_blank","width=1200,height=800")};return G(()=>{S()}),(i,n)=>(_(),r("div",U,[s("div",X,[s("div",Z,[s("h2",ss,e(a(o)("workerCalls.title")),1),t(a(w),{color:"gold",shape:"rounded-pill",class:"px-3 py-2 fw-bold text-dark"},{default:c(()=>[t(a(d),{icon:"cil-bell",class:"me-1"}),v(" "+e(m.value.length)+" "+e(a(o)("workerCalls.queueWaiting")),1)]),_:1})]),s("div",as,[t(a(p),{color:"primary",class:"nano-btn",onClick:E},{default:c(()=>[t(a(d),{icon:"cil-screen-desktop",class:"me-2"}),v(" "+e(a(o)("workerCalls.openDisplay")),1)]),_:1}),t(a(p),{color:"secondary",variant:"ghost",onClick:S,disabled:h.value},{default:c(()=>[t(a(d),{icon:"cil-reload",class:C({spinning:h.value})},null,8,["class"])]),_:1},8,["disabled"])])]),s("div",ts,[s("div",es,[s("div",ls,[t(a(d),{icon:"cil-check-circle"})]),s("div",os,[s("div",is,e(V.value),1),s("div",ns,e(a(o)("workerCalls.available")),1)])]),s("div",cs,[s("div",ds,[t(a(d),{icon:"cil-user"})]),s("div",rs,[s("div",_s,e(z.value),1),s("div",us,e(a(o)("workerCalls.busy")),1)])]),s("div",vs,[s("div",hs,[t(a(d),{icon:"cil-bell"})]),s("div",ms,[s("div",ps,e(m.value.length),1),s("div",bs,e(a(o)("workerCalls.queueWaiting")),1)])]),s("div",fs,[s("div",gs,[t(a(d),{icon:"cil-calendar"})]),s("div",ks,[s("div",ws,e(B.value.length),1),s("div",ys,e(a(o)("workerCalls.todaysBookings")),1)])])]),t(a(L),{class:"g-4"},{default:c(()=>[t(a(N),{lg:"8"},{default:c(()=>[s("div",Cs,[s("div",xs,[s("h4",Bs,e(a(o)("workerCalls.staffStatus")),1),s("div",Ss,[t(a(w),{color:"success",shape:"rounded-pill",class:"px-2"},{default:c(()=>[...n[0]||(n[0]=[v("Available",-1)])]),_:1}),t(a(w),{color:"danger",shape:"rounded-pill",class:"px-2"},{default:c(()=>[...n[1]||(n[1]=[v("Busy",-1)])]),_:1})])]),h.value?(_(),r("div",Is,[t(a(O),{color:"primary"})])):(_(),r("div",As,[(_(!0),r(R,null,W(f.value,l=>{var u;return _(),r("div",{key:l.id,class:C(["staff-status-card",{"is-busy":l.busy}])},[s("div",$s,[s("div",Ds,e((u=l.name)==null?void 0:u.charAt(0)),1),s("div",{class:C(["status-indicator",l.busy?"busy":"available"])},null,2)]),s("div",Ts,[s("h5",js,e(l.name),1),s("p",qs,e(l.position||"Staff"),1),t(a(p),{color:l.busy?"secondary":"primary",class:"nano-btn-sm w-100",onClick:y=>H(l),disabled:l.busy},{default:c(()=>[v(e(l.busy?"Busy":a(o)("workerCalls.call")),1)]),_:2},1032,["color","onClick","disabled"])])],2)}),128))]))])]),_:1}),t(a(N),{lg:"4"},{default:c(()=>[s("div",Fs,[s("h4",Ns,e(a(o)("workerCalls.activeCalls")||"النداءات الحالية"),1),m.value.length===0?(_(),r("div",Rs,[t(a(d),{icon:"cil-smile",size:"xl",class:"mb-3"}),s("p",null,e(a(o)("workerCalls.noActiveCalls")||"لا يوجد نداءات نشطة"),1)])):(_(),r("div",Ws,[(_(!0),r(R,null,W(m.value,l=>(_(),r("div",{key:l.id,class:"nano-call-card pulse-warning shadow-sm"},[s("div",Vs,[s("div",zs,"#"+e(l.ticket_number),1),t(a(w),{color:"warning",class:"px-2"},{default:c(()=>[...n[2]||(n[2]=[v("WAITING",-1)])]),_:1})]),s("div",Hs,[s("div",Ms,e(l.customer_name),1),s("div",Ps,e(l.service_name),1)]),s("div",Es,[t(a(p),{color:"success",class:"flex-grow-1 nano-btn-sm",onClick:u=>M(l)},{default:c(()=>[t(a(d),{icon:"cil-user-plus",class:"me-1"}),n[3]||(n[3]=v("Assign ",-1))]),_:1},8,["onClick"]),t(a(p),{color:"danger",variant:"ghost",onClick:u=>P(l)},{default:c(()=>[t(a(d),{icon:"cil-trash"})]),_:1},8,["onClick"])])]))),128))]))])]),_:1})]),_:1}),t(K,{"page-key":"workerCalls"})]))}},aa=Q(Gs,[["__scopeId","data-v-dd42db04"]]);export{aa as default};
